{
  delayTestFinish(5000);
  addHistoryListenerImpl(new ValueChangeHandler<String>(){
    @Override public void onValueChange(    ValueChangeEvent<String> event){
      String historyToken=event.getValue();
      if (historyToken == null) {
        fail("historyToken should not be null");
      }
      if (historyToken.equals("foobar")) {
        History.newItem("");
      }
 else {
        assertEquals("",historyToken);
        finishTest();
      }
    }
  }
);
  History.newItem("foobar");
}
