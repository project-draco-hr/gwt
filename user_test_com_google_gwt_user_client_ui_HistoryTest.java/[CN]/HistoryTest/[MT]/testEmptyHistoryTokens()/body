{
  delayTestFinish(5000);
  History.addHistoryListener(new HistoryListener(){
    public void onHistoryChanged(    String historyToken){
      if (historyToken == null) {
        fail("historyToken should not be null");
      }
      if (historyToken.equals("foobar")) {
        History.newItem("");
      }
 else {
        assertEquals(0,historyToken.length());
        finishTest();
        History.removeHistoryListener(this);
      }
    }
  }
);
  History.newItem("foobar");
}
