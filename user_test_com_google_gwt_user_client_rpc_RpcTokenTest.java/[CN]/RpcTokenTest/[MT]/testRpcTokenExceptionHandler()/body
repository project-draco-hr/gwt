{
  RpcTokenTestServiceAsync service=getAsyncService();
  ((ServiceDefTarget)service).setServiceEntryPoint(GWT.getModuleBaseURL() + "rpctokentest?throw=true");
  ((HasRpcToken)service).setRpcTokenExceptionHandler(new RpcTokenExceptionHandler(){
    @Override public void onRpcTokenException(    RpcTokenException exception){
      assertNotNull(exception);
      finishTest();
    }
  }
);
  delayTestFinishForRpc();
  service.getRpcTokenFromRequest(new AsyncCallback<RpcToken>(){
    @Override public void onFailure(    Throwable caught){
      TestSetValidator.rethrowException(caught);
    }
    @Override public void onSuccess(    RpcToken rpcToken){
      fail("Should've called RpcTokenExceptionHandler");
    }
  }
);
}
