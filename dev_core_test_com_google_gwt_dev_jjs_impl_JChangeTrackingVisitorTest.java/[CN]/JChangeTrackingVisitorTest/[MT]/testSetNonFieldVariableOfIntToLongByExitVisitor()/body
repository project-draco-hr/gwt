{
  addSnippetClassDecl("static class A {","public int field1;","public double field2;","public void fun(int a) { a++; }","}");
  JProgram program=compileSnippet("void","");
  SetNonFieldVariableOfIntToLongByExitVisitor setNonFieldVariableOfIntToLongByExitVisitor=new SetNonFieldVariableOfIntToLongByExitVisitor(new OptimizerContext(program));
  setNonFieldVariableOfIntToLongByExitVisitor.accept(program);
  assertEquals("int field1",findField(program.getFromTypeMap("test.EntryPoint$A"),"field1").toString());
  assertEquals("double field2",findField(program.getFromTypeMap("test.EntryPoint$A"),"field2").toString());
  assertEquals("public void fun(long a);\n",findMethod(program.getFromTypeMap("test.EntryPoint$A"),"fun").toString());
}
