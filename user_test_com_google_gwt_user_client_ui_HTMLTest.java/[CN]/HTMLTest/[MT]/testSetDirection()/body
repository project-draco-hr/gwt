{
  for (int i=0; i < 2; i++) {
    String id=i == 0 ? "div label: " : "span label: ";
    label=HTML.wrap(i == 0 ? createAttachedDivElement() : createAttachedSpanElement());
    label.setDirection(Direction.RTL);
    assertLabelDirection(id + "label's direction is incorrect after " + "setDirection",Direction.RTL);
    label.setText(EN_TEXT,Direction.LTR);
    assertLabelDirection(id + "label's direction is incorrect after " + "setText with a specific direction",Direction.LTR);
    label.setText(EN_TEXT);
    assertLabelDirection(id + "label's direction wasn't reverted to the " + "direction set by last setDirection when calling setText with no "+ "direction argument and without a directionEstimator",Direction.RTL);
    if (i == 1) {
      assertEquals(id + "element's direction does not match the direction " + "set by last setDirection when calling setText with no direction "+ "argument and without a directionEstimator",Direction.RTL,BidiUtils.getDirectionOnElement(label.getElement()));
    }
  }
}
