{
  String enContent=isHtml ? EN_HTML : EN_TEXT;
  String iwContent=isHtml ? IW_HTML : IW_TEXT;
  for (int i=0; i < 2; i++) {
    String id=i == 0 ? "div label: " : "span label: ";
    label=HTML.wrap(i == 0 ? createAttachedDivElement() : createAttachedSpanElement());
    setLabelTextOrHtml(enContent,isHtml);
    assertLabelDirection(id + "label's direction is not DEFAULT upon " + "standard initialization",Direction.DEFAULT);
    setLabelTextOrHtml(iwContent,Direction.RTL,isHtml);
    assertLabelDirection(id + "label's direction is not RTL after it was" + " explicitly set to RTL",Direction.RTL);
    setLabelTextOrHtml(enContent,isHtml);
    assertLabelDirection(id + "label's direction was not specified, and no" + " estimator specified, thus should return to initial value (DEFAULT)",Direction.DEFAULT);
    label.setDirectionEstimator(true);
    assertLabelDirection(id + "label's direction wasn't instantly updated" + " to LTR on switching direction estimation on",Direction.LTR);
    setLabelTextOrHtml(iwContent,isHtml);
    assertLabelDirection(id + "label's direction wasn't estimated as RTL",Direction.RTL);
    setLabelTextOrHtml(iwContent,Direction.LTR,isHtml);
    assertLabelDirection(id + "label's direction is not LTR after it was" + " explicitly set to LTR (direction estimation is on)",Direction.LTR);
    setLabelTextOrHtml(iwContent,Direction.DEFAULT,isHtml);
    assertLabelDirection(id + "label's direction is not DEFAULT after it" + " was explicitly set to DEFAULT (direction estimation is on)",Direction.DEFAULT);
    assertEquals(id + "retreived html is incorrect",iwContent,label.getHTML());
    assertEquals(id + "retreived text is incorrect",IW_TEXT,label.getText());
  }
}
