{
  final CommandExecutor ce=new NonRestartingCommandExecutor();
  final IncrementalCommand ic=new IncrementalCommand(){
    public boolean execute(){
      return false;
    }
  }
;
  ce.setExecuting(true);
  ce.submit(ic);
  ce.setLast(0);
  final UncaughtExceptionHandler originalUEH=GWT.getUncaughtExceptionHandler();
  UncaughtExceptionHandler ueh1=new UncaughtExceptionHandler(){
    public void onUncaughtException(    Throwable e){
      if (!(e instanceof CommandCanceledException || e instanceof IncrementalCommandCanceledException)) {
        originalUEH.onUncaughtException(e);
        return;
      }
      IncrementalCommandCanceledException icce=(IncrementalCommandCanceledException)e;
      if (icce.getCommand() != ic) {
        fail("IncrementalCommandCanceledException did not contain the correct failed command");
      }
    }
  }
;
  GWT.setUncaughtExceptionHandler(ueh1);
  ce.doCommandCanceled();
}
