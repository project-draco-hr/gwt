{
  if (type.canBeNull() && !qType.canBeNull()) {
    return false;
  }
  type=type.getUnderlyingType();
  qType=qType.getUnderlyingType();
  JClassType jlo=program.getTypeJavaLangObject();
  if (type == qType || qType == jlo) {
    return true;
  }
  if (type instanceof JArrayType) {
    JArrayType aType=(JArrayType)type;
    if (qType instanceof JArrayType) {
      JArrayType qaType=(JArrayType)qType;
      JType leafType=aType.getLeafType();
      JType qLeafType=qaType.getLeafType();
      int dims=aType.getDims();
      int qDims=qaType.getDims();
      if (dims > qDims && (qLeafType == jlo || qLeafType instanceof JNullType)) {
        return true;
      }
      if (dims == qDims) {
        if (leafType instanceof JReferenceType && qLeafType instanceof JReferenceType) {
          return canTriviallyCast((JReferenceType)leafType,(JReferenceType)qLeafType);
        }
      }
    }
    if (qType == javaIoSerializable || qType == javaLangCloneable || qType == baseArrayType) {
      return true;
    }
  }
 else   if (type instanceof JClassType) {
    JClassType cType=(JClassType)type;
    if (qType instanceof JClassType) {
      JClassType qcType=(JClassType)qType;
      if (isSuperClass(cType,qcType)) {
        return true;
      }
    }
 else     if (qType instanceof JInterfaceType) {
      return implementsInterface(cType,(JInterfaceType)qType);
    }
  }
 else   if (type instanceof JInterfaceType) {
    JInterfaceType iType=(JInterfaceType)type;
    if (qType instanceof JInterfaceType) {
      return extendsInterface(iType,(JInterfaceType)qType);
    }
  }
 else   if (type instanceof JNullType) {
    return true;
  }
  return false;
}
