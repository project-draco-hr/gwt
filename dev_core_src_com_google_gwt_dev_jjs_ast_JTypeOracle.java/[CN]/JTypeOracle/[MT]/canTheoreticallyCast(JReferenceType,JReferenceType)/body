{
  if (!type.canBeNull() && qType == program.getTypeNull()) {
    return false;
  }
  type=type.getUnderlyingType();
  qType=qType.getUnderlyingType();
  JClassType jlo=program.getTypeJavaLangObject();
  if (type == qType || type == jlo) {
    return true;
  }
  if (canCrossCastLikeJso(type) && canCrossCastLikeJso(qType)) {
    return true;
  }
  if (canTriviallyCast(type,qType)) {
    return true;
  }
  if (type instanceof JArrayType) {
    JArrayType aType=(JArrayType)type;
    if (qType instanceof JArrayType) {
      JArrayType qaType=(JArrayType)qType;
      JType leafType=aType.getLeafType();
      JType qLeafType=qaType.getLeafType();
      int dims=aType.getDims();
      int qDims=qaType.getDims();
      if (dims < qDims && leafType != program.getTypeJavaLangObject() && !(leafType instanceof JNullType)) {
        return false;
      }
      if (dims == qDims) {
        if (leafType instanceof JReferenceType && qLeafType instanceof JReferenceType) {
          return canTheoreticallyCast((JReferenceType)leafType,(JReferenceType)qLeafType);
        }
      }
    }
  }
 else   if (type instanceof JClassType) {
    JClassType cType=(JClassType)type;
    if (qType instanceof JClassType) {
      return isSubClass(cType,(JClassType)qType);
    }
 else     if (qType instanceof JInterfaceType) {
      return get(couldImplementMap,cType.getName()).contains(qType.getName());
    }
  }
 else   if (type instanceof JInterfaceType) {
    JInterfaceType iType=(JInterfaceType)type;
    if (qType instanceof JClassType) {
      return get(couldBeImplementedMap,iType.getName()).contains(qType.getName());
    }
  }
 else   if (type instanceof JNullType) {
  }
  return true;
}
