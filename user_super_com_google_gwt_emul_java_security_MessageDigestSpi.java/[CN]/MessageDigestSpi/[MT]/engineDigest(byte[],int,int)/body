{
  byte[] digest=engineDigest();
  if (buf.length < digest.length + offset) {
    throw new DigestException("Insufficient buffer space for digest");
  }
  if (len < digest.length) {
    throw new DigestException("Length not large enough to hold digest");
  }
  System.arraycopy(digest,0,buf,offset,digest.length);
  return digest.length;
}
