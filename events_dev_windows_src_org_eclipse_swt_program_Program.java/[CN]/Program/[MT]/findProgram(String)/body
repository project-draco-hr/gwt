{
  if (extension == null)   SWT.error(SWT.ERROR_NULL_ARGUMENT);
  if (extension.length() == 0)   return null;
  if (extension.charAt(0) != '.')   extension="." + extension;
  TCHAR key=new TCHAR(0,extension,true);
  int[] phkResult=new int[1];
  if (OS.RegOpenKeyEx(OS.HKEY_CLASSES_ROOT,key,0,OS.KEY_READ,phkResult) != 0) {
    return null;
  }
  Program program=null;
  int[] lpcbData=new int[1];
  int result=OS.RegQueryValueEx(phkResult[0],null,0,null,(TCHAR)null,lpcbData);
  if (result == 0) {
    TCHAR lpData=new TCHAR(0,lpcbData[0] / TCHAR.sizeof);
    result=OS.RegQueryValueEx(phkResult[0],null,0,null,lpData,lpcbData);
    if (result == 0)     program=getProgram(lpData.toString(0,lpData.strlen()));
  }
  OS.RegCloseKey(phkResult[0]);
  return program;
}
