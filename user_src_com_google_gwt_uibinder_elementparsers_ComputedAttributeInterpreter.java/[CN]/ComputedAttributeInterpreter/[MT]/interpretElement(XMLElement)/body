{
  Map<String,String> attNameToToken=new HashMap<String,String>();
  for (int i=elem.getAttributeCount() - 1; i >= 0; i--) {
    XMLAttribute att=elem.getAttribute(i);
    AttributeParser parser=writer.getBundleAttributeParser(att);
    if (parser != null) {
      String parsedValue=parser.parse(att.consumeRawValue());
      String attToken=writer.tokenForStringExpression(parsedValue);
      attNameToToken.put(att.getLocalName(),attToken);
      continue;
    }
    if (att.hasComputedValue()) {
      String attToken=delegate.getAttributeToken(att);
      attNameToToken.put(att.getName(),attToken);
    }
 else {
      String n=att.getName();
      String v=att.consumeRawValue().replace("{{","{");
      elem.setAttribute(n,v);
    }
  }
  for (  Map.Entry<String,String> attr : attNameToToken.entrySet()) {
    elem.setAttribute(attr.getKey(),attr.getValue());
  }
  return null;
}
