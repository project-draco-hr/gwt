{
  final ExpensesTreeViewModel model=new ExpensesTreeViewModel();
  selectionModel.addSelectionChangeHandler(new SelectionChangeEvent.Handler(){
    public void onSelectionChange(    SelectionChangeEvent event){
      Object selected=selectionModel.getSelectedObject();
      if (selected == null) {
        lastEmployee=null;
        lastDepartment="";
      }
 else       if (selected instanceof EmployeeProxy) {
        lastEmployee=(EmployeeProxy)selected;
        lastDepartment=lastEmployee.getDepartment();
      }
 else       if (selected instanceof String) {
        lastEmployee=null;
        if (model.isAllDepartment(selected)) {
          lastDepartment="";
        }
 else {
          lastDepartment=(String)selected;
        }
      }
      if (listener != null) {
        listener.onSelection(lastDepartment,lastEmployee == null ? null : lastEmployee.stableId());
      }
    }
  }
);
  tree=new CellTree(model,null);
  tree.setAnimationEnabled(true);
}
