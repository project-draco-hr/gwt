{
  final ExpensesTreeViewModel model=new ExpensesTreeViewModel();
  selectionModel.addSelectionChangeHandler(new SelectionChangeEvent.Handler(){
    public void onSelectionChange(    SelectionChangeEvent event){
      Object selected=selectionModel.getSelectedObject();
      if (selected == null) {
        lastEmployee=null;
        lastDepartment=null;
      }
 else       if (selected instanceof EmployeeProxy) {
        lastEmployee=(EmployeeProxy)selected;
      }
 else       if (selected instanceof String) {
        lastEmployee=null;
        if (model.isAllDepartment(selected)) {
          lastDepartment=null;
        }
 else {
          lastDepartment=(String)selected;
        }
      }
      if (listener != null) {
        listener.onSelection(lastDepartment,lastEmployee);
      }
    }
  }
);
  selectionModel.setKeyProvider(new ProvidesKey<Object>(){
    public Object getKey(    Object item){
      if (item instanceof EmployeeProxy) {
        return Expenses.EMPLOYEE_RECORD_KEY_PROVIDER.getKey((EmployeeProxy)item);
      }
      return item;
    }
  }
);
  tree=new CellTree(model,null);
  tree.setAnimationEnabled(true);
}
