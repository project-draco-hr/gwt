def _run_test(self, grammar, text, expected, strings_are_tokens=False, whitespace_rule=None):
    'Utility for running a parser test and comparing results.\n\n    Program exits (sys.exit) if expected does not match actual.\n\n    Args:\n      grammar -- the root rule to be used by the parser.\n      text -- the text to parse.\n      expected -- the expected abstract syntax tree. None means\n        failure is expected.\n      strings_are_tokens -- whether strings are treated as tokens.\n      whitespace_rule -- the rule used for matching whitespace.\n        Default is None, which means that no whitespace is tolerated.\n    '
    parser = PegParser(grammar, whitespace_rule, strings_are_tokens=strings_are_tokens)
    actual = None
    error = None
    try:
        actual = parser.parse(text)
    except SyntaxError as e:
        error = e
        pass
    if (actual != expected):
        msg = ('\nCONTENT:\n%s\nEXPECTED:\n%s\nACTUAL:\n%s\nERROR: %s' % (text, pprint.pformat(expected), pprint.pformat(actual), error))
        self.fail(msg)
