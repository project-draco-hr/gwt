{
switch (event.getTypeInt()) {
case Event.ONCHANGE:
    if (!allowEvent) {
      eventPending=true;
      return false;
    }
  break;
case Event.ONBLUR:
if (eventPending) {
  allowEvent=true;
  fileUpload.getElement().dispatchEvent(Document.get().createChangeEvent());
  allowEvent=false;
  eventPending=false;
}
break;
}
return true;
}
