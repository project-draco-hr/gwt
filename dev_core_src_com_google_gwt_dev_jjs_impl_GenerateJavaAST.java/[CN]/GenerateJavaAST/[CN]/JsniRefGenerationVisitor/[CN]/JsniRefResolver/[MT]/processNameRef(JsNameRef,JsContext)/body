{
  SourceInfo info=nativeMethodBody.getSourceInfo();
  String ident=nameRef.getIdent();
  JNode node=program.jsniMap.get(ident);
  if (node == null) {
    node=findJsniRefTarget(info,ident);
    if (node == null) {
      return;
    }
    if (node instanceof JType) {
      node=new JClassLiteral(info.makeChild(),(JType)node);
    }
    program.jsniMap.put(ident,node);
  }
  if (node instanceof JField) {
    processField(nameRef,info,(JField)node,ctx);
  }
 else   if (node instanceof JMethod) {
    processMethod(nameRef,info,(JMethod)node,ctx);
  }
 else   if (node instanceof JClassLiteral) {
    processClassLiteral((JClassLiteral)node,ctx);
  }
 else {
    throw new InternalCompilerException(node,"JSNI reference to something other than a class, field, or method?",null);
  }
}
