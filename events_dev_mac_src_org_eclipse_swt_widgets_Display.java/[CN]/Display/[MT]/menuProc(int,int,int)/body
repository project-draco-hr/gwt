{
  short menuID=0;
  if (userData != 0) {
    menuID=OS.GetMenuID(userData);
  }
 else {
    int[] theMenu=new int[1];
    OS.GetEventParameter(theEvent,OS.kEventParamDirectObject,OS.typeMenuRef,null,4,null,theMenu);
    menuID=OS.GetMenuID(theMenu[0]);
  }
  Menu menu=getMenu(menuID);
  if (menu != null)   return menu.menuProc(nextHandler,theEvent,userData);
  return OS.eventNotHandledErr;
}
