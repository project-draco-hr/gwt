{
  int eventClass=OS.GetEventClass(theEvent);
  int eventKind=OS.GetEventKind(theEvent);
switch (eventClass) {
case OS.kEventClassApplication:
switch (eventKind) {
case OS.kEventAppAvailableWindowBoundsChanged:
{
        if (dockImage != 0) {
          int[] reason=new int[1];
          OS.GetEventParameter(theEvent,OS.kEventParamReason,OS.typeUInt32,null,4,null,reason);
          if (reason[0] == OS.kAvailBoundsChangedForDock) {
            OS.SetApplicationDockTileImage(dockImage);
          }
        }
        break;
      }
  }
break;
case OS.kEventClassAppleEvent:
int[] aeEventID=new int[1];
if (OS.GetEventParameter(theEvent,OS.kEventParamAEEventID,OS.typeType,null,4,null,aeEventID) == OS.noErr) {
if (aeEventID[0] == OS.kAEQuitApplication) {
Event event=new Event();
sendEvent(SWT.Close,event);
if (event.doit) {
  dispose();
  System.exit(0);
}
return OS.userCanceledErr;
}
}
break;
}
return OS.eventNotHandledErr;
}
