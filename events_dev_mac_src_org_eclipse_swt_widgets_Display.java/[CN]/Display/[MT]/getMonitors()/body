{
  checkDevice();
  int count=0;
  Monitor[] monitors=new Monitor[1];
  Rect rect=new Rect();
  GDevice device=new GDevice();
  int gdevice=OS.GetDeviceList();
  while (gdevice != 0) {
    if (count >= monitors.length) {
      Monitor[] newMonitors=new Monitor[monitors.length + 4];
      System.arraycopy(monitors,0,newMonitors,0,monitors.length);
      monitors=newMonitors;
    }
    Monitor monitor=new Monitor();
    monitor.handle=gdevice;
    int[] ptr=new int[1];
    OS.memcpy(ptr,gdevice,4);
    OS.memcpy(device,ptr[0],GDevice.sizeof);
    monitor.x=device.left;
    monitor.y=device.top;
    monitor.width=device.right - device.left;
    monitor.height=device.bottom - device.top;
    OS.GetAvailableWindowPositioningBounds(gdevice,rect);
    monitor.clientX=rect.left;
    monitor.clientY=rect.top;
    monitor.clientWidth=rect.right - rect.left;
    monitor.clientHeight=rect.bottom - rect.top;
    monitors[count++]=monitor;
    gdevice=OS.GetNextDevice(gdevice);
  }
  if (count < monitors.length) {
    Monitor[] newMonitors=new Monitor[count];
    System.arraycopy(monitors,0,newMonitors,0,count);
    monitors=newMonitors;
  }
  return monitors;
}
