def Flush(self, writer=None):
    "Writes all pending files.\n\n    Arguments:\n      writer: a function called for each file and it's lines.\n    "
    if (not writer):
        writer = _WriteFile
    for file in sorted(self._filename_to_emitter.keys()):
        emitter = self._filename_to_emitter[file]
        writer(file, emitter.Fragments())
