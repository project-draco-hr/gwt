{
  CompilationUnitProvider cup=(CompilationUnitProvider)cupsByTypeName.get(typeName);
  if (cup != null) {
    return cup;
  }
  JClassType type=typeOracle.findType(typeName);
  if (type != null) {
    cup=type.getCompilationUnit();
    assert(cup != null);
  }
  if (cup != null) {
    try {
      CompilationUnitProvider specialCup=doFilterCompilationUnit(logger,typeName,cup);
      if (specialCup != null) {
        cup=specialCup;
      }
    }
 catch (    UnableToCompleteException e) {
      String location=cup.getLocation();
      char[] source=cup.getSource();
      Util.maybeDumpSource(logger,location,source,typeName);
      throw e;
    }
  }
  if (cup == null) {
    return null;
  }
  cupsByTypeName.put(typeName,cup);
  return cup;
}
