{
  final SimpleRequestFactory req=GWT.create(SimpleRequestFactory.class);
  HandlerManager hm=new HandlerManager(null);
  req.init(hm);
  delayTestFinish(5000);
  req.simpleFooRequest().findSimpleFooById(999L).fire(new Receiver<SimpleFooRecord>(){
    public void onSuccess(    SimpleFooRecord newFoo,    Set<SyncResult> syncResults){
      final RequestObject<Long> fooReq=req.simpleFooRequest().countSimpleFooWithUserNameSideEffect(newFoo);
      newFoo=fooReq.edit(newFoo);
      newFoo.setUserName("Ray");
      fooReq.fire(new Receiver<Long>(){
        public void onSuccess(        Long response,        Set<SyncResult> syncResults){
          assertEquals(new Long(1L),response);
          assertEquals(1,syncResults.size());
          SyncResult syncResultArray[]=syncResults.toArray(new SyncResult[0]);
          assertFalse(syncResultArray[0].hasViolations());
          assertNull(syncResultArray[0].getFutureId());
          Record record=syncResultArray[0].getRecord();
          assertEquals(new Long(999L),record.getId());
          req.simpleFooRequest().findSimpleFooById(999L).fire(new Receiver<SimpleFooRecord>(){
            public void onSuccess(            SimpleFooRecord finalFoo,            Set<SyncResult> syncResults){
              assertEquals("Ray",finalFoo.getUserName());
              finishTest();
            }
          }
);
        }
      }
);
    }
  }
);
}
