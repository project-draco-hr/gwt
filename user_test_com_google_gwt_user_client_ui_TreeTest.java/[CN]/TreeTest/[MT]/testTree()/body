{
  Tree t=new Tree();
  Label l=new Label("simple widget");
  TreeItem simple=new TreeItem(l);
  t.addItem(simple);
  Widget w=simple.getWidget();
  TreeItem.ContentPanel parent=(ContentPanel)w.getParent();
  assertEquals(simple,parent.getTreeItem());
  TreeItem item=new TreeItem();
  t.addItem(item);
  item.setWidget(new Label("now widget"));
  Element elem=item.getContentElem();
  assertEquals(1,DOM.getChildCount(elem));
  Label l2=new Label("next widget");
  simple.setWidget(l2);
  assertEquals(t,l2.getParent().getParent());
  simple.remove();
  assertEquals(l2,simple.getWidget());
  assertNull(l2.getParent().getParent());
  TreeItem a=new TreeItem("a");
  TreeItem b=new TreeItem("b");
  TreeItem c=new TreeItem("c");
  TreeItem d=new TreeItem();
  TreeItem e=new TreeItem();
  Label dLabel=new Label("d");
  Label eLabel=new Label("e");
  d.setWidget(dLabel);
  d.addItem(e);
  c.addItem(d);
  b.addItem(c);
  a.addItem(b);
  t.addItem(a);
  assertEquals(t,dLabel.getParent().getParent());
  e.setWidget(eLabel);
  assertEquals(t,eLabel.getParent().getParent());
  Tree childTree=new Tree();
  t.addItem(new TreeItem(childTree));
  childTree.addItem(c);
  assertEquals(childTree,dLabel.getParent().getParent());
  assertEquals(childTree,eLabel.getParent().getParent());
  assertTrue(childTree.getChildWidgets().contains(eLabel.getParent()));
  d.remove();
  assertNull(dLabel.getParent().getParent());
  assertNull(eLabel.getParent().getParent());
  assertFalse(childTree.getChildWidgets().contains(eLabel.getParent()));
  Panel p=new SimplePanel(DOM.createDiv());
  try {
    p.add(dLabel.getParent());
    fail("Should have thrown UnssupportedOperationException");
  }
 catch (  UnsupportedOperationException good) {
  }
}
