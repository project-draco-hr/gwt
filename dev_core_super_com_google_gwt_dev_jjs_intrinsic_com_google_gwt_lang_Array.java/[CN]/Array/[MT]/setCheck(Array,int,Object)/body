{
  if (value != null) {
    if (array.elementTypeClass == TYPE_JAVA_OBJECT && !Cast.canCast(value,array.elementTypeId)) {
      throw new ArrayStoreException();
    }
 else     if (array.elementTypeClass == TYPE_JSO && Cast.isJavaObject(value)) {
      throw new ArrayStoreException();
    }
 else     if (array.elementTypeClass == TYPE_JAVA_OBJECT_OR_JSO && !Cast.isJavaScriptObject(value) && !Cast.canCast(value,array.elementTypeId)) {
      throw new ArrayStoreException();
    }
  }
  return set(array,index,value);
}
