{
  String originalName=jsniRef.className();
  String importedClassName=originalName;
  if (importedClassName.contains(".")) {
    importedClassName=importedClassName.substring(0,importedClassName.indexOf("."));
  }
  ReferenceBinding declaringClass=method.binding.declaringClass;
  while (declaringClass != null) {
    String declaringClassName=JdtUtil.sourceNameFromNamesArray(declaringClass.compoundName);
    if (declaringClassName.equals(importedClassName) || declaringClassName.endsWith("." + importedClassName)) {
      jsniRef.setClassName(declaringClassName + originalName.substring(importedClassName.length()));
      return;
    }
    String fullClassName=declaringClassName + "." + originalName;
    if (typeResolver.resolveType(fullClassName) != null) {
      jsniRef.setClassName(fullClassName);
      return;
    }
    declaringClass=declaringClass.enclosingTypeAt(1);
  }
  for (  ImportReference importReference : cudImports) {
    String nameFromImport=JdtUtil.sourceNameFromNamesArray(importReference.getImportName());
    if (!importReference.isStatic() && importReference.trailingStarPosition == 0 && nameFromImport.endsWith("." + importedClassName)) {
      jsniRef.setClassName(nameFromImport + originalName.substring(importedClassName.length()));
      return;
    }
  }
  String currentPackageClassName=JdtUtil.sourceNameFromNamesArray(method.binding.declaringClass.getPackage().compoundName);
  currentPackageClassName+=(currentPackageClassName.isEmpty() ? "" : ".") + originalName;
  if (typeResolver.resolveType(currentPackageClassName) != null) {
    jsniRef.setClassName(currentPackageClassName);
    return;
  }
  for (  ImportReference importReference : cudImports) {
    if (importReference.isStatic() || importReference.trailingStarPosition == 0) {
      continue;
    }
    String fullClassName=JdtUtil.sourceNameFromNamesArray(importReference.getImportName()) + "." + originalName;
    if (typeResolver.resolveType(fullClassName) != null) {
      jsniRef.setClassName(fullClassName);
      return;
    }
  }
}
