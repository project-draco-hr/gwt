{
  if (test instanceof TestSuite) {
    TestSuite suite=(TestSuite)test;
    if (suite.countTestCases() == 0) {
      return getNonGWTTestSuite();
    }
 else {
      return getModuleSuiteFor(suite.testAt(0));
    }
  }
  if (test instanceof GWTTestCase) {
    GWTTestCase gwtTest=(GWTTestCase)test;
    String moduleName=gwtTest.getSyntheticModuleName();
    if (moduleName != null) {
      TestSuite suite=moduleSuites.get(moduleName);
      if (suite == null) {
        suite=new TestSuite(moduleName + ".gwt.xml");
        moduleSuites.put(moduleName,suite);
        super.addTest(suite);
      }
      return suite;
    }
 else {
    }
  }
  return getNonGWTTestSuite();
}
