{
  this.module=moduleDef;
  checkModule(logger);
  outDir=new File(outDir,module.getName());
  generatorResourcesDir=new File(outDir,GENERATOR_DIR);
  Util.recursiveDelete(generatorResourcesDir,true);
  generatorResourcesDir.mkdirs();
  rules=module.getRules();
  typeOracle=module.getTypeOracle(logger);
  sourceOracle=new StandardSourceOracle(typeOracle);
  if (jjsOptions.isValidateOnly()) {
    logger.log(TreeLogger.INFO,"Validating compilation " + module.getName(),null);
    CompilationUnitProvider[] compilationUnits=module.getCompilationUnits();
    declEntryPts=new String[compilationUnits.length];
    for (int i=0; i < compilationUnits.length; ++i) {
      CompilationUnitProvider cup=compilationUnits[i];
      declEntryPts[i]=makeTypeName(cup);
    }
  }
 else {
    logger.log(TreeLogger.INFO,"Compiling module " + module.getName(),null);
    declEntryPts=module.getEntryPointTypeNames();
  }
  rebindPermOracle=new DistillerRebindPermutationOracle();
  properties=module.getProperties();
  perms=new PropertyPermutations(properties);
  WebModeCompilerFrontEnd frontEnd=new WebModeCompilerFrontEnd(sourceOracle,rebindPermOracle);
  jjs=new JavaToJavaScriptCompiler(logger,frontEnd,declEntryPts,jjsOptions);
  if (!jjsOptions.isValidateOnly()) {
    if (targets != null) {
      boolean badTarget=false;
      for (      String target : targets) {
        if (module.getLinker(target) == null) {
          logger.log(TreeLogger.ERROR,"Unknown target " + target,null);
          badTarget=true;
        }
      }
      if (badTarget) {
        throw new UnableToCompleteException();
      }
    }
 else {
      targets=module.getActiveLinkerNames();
      if (targets == null || targets.length == 0) {
        logger.log(TreeLogger.ERROR,"At least one Linker must be specified in the " + "module or on the command line",null);
        throw new UnableToCompleteException();
      }
    }
  }
  StandardLinkerContext linkerContext=new StandardLinkerContext(logger,module,outDir,generatorResourcesDir,jjsOptions);
  compilePermutations(logger,linkerContext);
  if (jjsOptions.isValidateOnly()) {
    logger.log(TreeLogger.INFO,"Validation succeeded",null);
    return;
  }
  logger.log(TreeLogger.INFO,"Compilation succeeded",null);
  for (  String linkerName : targets) {
    Linker l=module.getLinker(linkerName);
    linkerContext.invokeLinker(logger,linkerName,l);
  }
}
