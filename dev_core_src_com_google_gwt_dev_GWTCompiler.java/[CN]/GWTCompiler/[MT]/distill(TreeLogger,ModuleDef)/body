{
  this.module=moduleDef;
  checkModule(logger);
  generatorResourcesDir=new File(outDir,GWT_COMPILER_DIR + File.separator + moduleDef.getName()+ File.separator+ "generated");
  outDir=new File(outDir,module.getName());
  Util.recursiveDelete(outDir,true);
  Util.recursiveDelete(generatorResourcesDir,true);
  generatorResourcesDir.mkdirs();
  rules=module.getRules();
  typeOracle=module.getTypeOracle(logger);
  sourceOracle=new StandardSourceOracle(typeOracle);
  if (jjsOptions.isValidateOnly()) {
    logger.log(TreeLogger.INFO,"Validating compilation " + module.getName(),null);
    CompilationUnitProvider[] compilationUnits=module.getCompilationUnits();
    declEntryPts=new String[compilationUnits.length];
    for (int i=0; i < compilationUnits.length; ++i) {
      CompilationUnitProvider cup=compilationUnits[i];
      declEntryPts[i]=makeTypeName(cup);
    }
  }
 else {
    logger.log(TreeLogger.INFO,"Compiling module " + module.getName(),null);
    declEntryPts=module.getEntryPointTypeNames();
  }
  ArtifactSet generatorArtifacts=new ArtifactSet();
  rebindPermOracle=new DistillerRebindPermutationOracle(generatorArtifacts);
  properties=module.getProperties();
  perms=new PropertyPermutations(properties);
  WebModeCompilerFrontEnd frontEnd=new WebModeCompilerFrontEnd(sourceOracle,rebindPermOracle);
  jjs=new JavaToJavaScriptCompiler(logger,frontEnd,declEntryPts,jjsOptions);
  StandardLinkerContext linkerContext=new StandardLinkerContext(logger,module,outDir,generatorResourcesDir,jjsOptions);
  compilePermutations(logger,linkerContext,generatorArtifacts);
  if (jjsOptions.isValidateOnly()) {
    logger.log(TreeLogger.INFO,"Validation succeeded",null);
    return;
  }
  logger.log(TreeLogger.INFO,"Compilation succeeded",null);
  linkerContext.addOrReplaceArtifacts(generatorArtifacts);
  linkerContext.link(logger,linkerContext,null);
}
