{
  Date viewData=getViewData(key);
  if (viewData != null && viewData.equals(value)) {
    clearViewData(key);
    viewData=null;
  }
  String s=null;
  if (viewData != null) {
    s=format.format(viewData);
  }
 else   if (value != null) {
    s=format.format(value);
  }
  if (s != null) {
    sb.append(renderer.render(s));
  }
}
