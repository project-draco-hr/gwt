{
  ModuleTabPanel tabPanel=null;
  ModulePanel tab=null;
  tabPanel=findModuleTab(userAgent,remoteSocket,url,tabKey,moduleName,agentIcon);
  tab=tabPanel.addModuleSession(logLevel,moduleName,sessionKey,options.getLogFile(String.format("%s-%s-%d.log",moduleName,agentTag,getNextSessionCounter(options.getLogDir()))));
  TreeLogger logger=tab.getLogger();
  TreeLogger branch=logger.branch(TreeLogger.INFO,"Loading module " + moduleName);
  if (url != null) {
    branch.log(TreeLogger.INFO,"Top URL: " + url);
  }
  branch.log(TreeLogger.INFO,"User agent: " + userAgent);
  branch.log(TreeLogger.TRACE,"Remote socket: " + remoteSocket);
  if (tabKey != null) {
    branch.log(TreeLogger.DEBUG,"Tab key: " + tabKey);
  }
  if (sessionKey != null) {
    branch.log(TreeLogger.DEBUG,"Session key: " + sessionKey);
  }
  return new SwingModuleHandle(logger,tab);
}
