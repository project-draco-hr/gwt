{
  if (limit <= 1) {
    return limit == 0 ? (pattern.equals(target) ? 0 : 1) : atMostOneError(pattern,target);
  }
  if ((patternLength > 64) && (limit < (target.length() / 10))) {
    if (berghel == null) {
      berghel=ModifiedBerghelRoachEditDistance.getInstance(pattern);
    }
    return berghel.getDistance(target,limit);
  }
  if (myers == null) {
    myers=MyersBitParallelEditDistance.getInstance(pattern);
  }
  return myers.getDistance(target,limit);
}
