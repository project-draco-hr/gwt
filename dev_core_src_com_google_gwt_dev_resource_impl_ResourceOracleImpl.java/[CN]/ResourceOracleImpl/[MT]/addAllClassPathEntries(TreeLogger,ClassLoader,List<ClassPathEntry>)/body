{
  Set<URI> seenEntries=new HashSet<URI>();
  for (; classLoader != null; classLoader=classLoader.getParent()) {
    if (classLoader instanceof URLClassLoader) {
      URLClassLoader urlClassLoader=(URLClassLoader)classLoader;
      URL[] urls=urlClassLoader.getURLs();
      for (      URL url : urls) {
        URI uri;
        try {
          uri=url.toURI();
        }
 catch (        URISyntaxException e) {
          logger.log(TreeLogger.WARN,"Error processing classpath URL '" + url + "'",e);
          continue;
        }
        if (seenEntries.contains(uri)) {
          continue;
        }
        seenEntries.add(uri);
        Throwable caught;
        try {
          ClassPathEntry entry=createEntryForUrl(logger,url);
          if (entry != null) {
            classPath.add(entry);
          }
          continue;
        }
 catch (        AccessControlException e) {
          if (logger.isLoggable(TreeLogger.DEBUG)) {
            logger.log(TreeLogger.DEBUG,"Skipping URL due to access restrictions: " + url);
          }
          continue;
        }
catch (        URISyntaxException e) {
          caught=e;
        }
catch (        IOException e) {
          caught=e;
        }
        logger.log(TreeLogger.WARN,"Error processing classpath URL '" + url + "'",caught);
      }
    }
  }
}
