{
  StringBuffer out=new StringBuffer();
  for (int i=0; i < raw.length(); i++) {
    char c=raw.charAt(i);
    if (Character.isLetterOrDigit(c) || c == '-' || c == '_') {
      out.append(c);
    }
 else     if (c == '\\') {
      out.append("[\\\\]");
    }
 else     if (c == ']') {
      out.append("[\\]]");
    }
 else     if (c == '^') {
      out.append("[\\^]");
    }
 else     if (c == '[') {
      out.append("[\\[]");
    }
 else {
      out.append("[");
      out.append(c);
      out.append("]");
    }
  }
  return out.toString();
}
