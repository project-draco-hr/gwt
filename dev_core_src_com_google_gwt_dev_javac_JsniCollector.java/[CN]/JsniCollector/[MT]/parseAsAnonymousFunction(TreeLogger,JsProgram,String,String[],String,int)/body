{
  StringReader r;
{
    StringBuilder sb=new StringBuilder();
    sb.append("function (");
    boolean first=true;
    for (    String paramName : paramNames) {
      if (first) {
        first=false;
      }
 else {
        sb.append(',');
      }
      sb.append(paramName);
    }
    sb.append(") {");
    sb.append(js);
    sb.append('}');
    r=new StringReader(sb.toString());
  }
  try {
    JsParser parser=new JsParser();
    parser.setSourceInfo(program.createSourceInfo(startLine,location));
    List<JsStatement> stmts=parser.parse(program.getScope(),r,startLine);
    return (JsFunction)((JsExprStmt)stmts.get(0)).getExpression();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  JsParserException e) {
    SourceDetail dtl=e.getSourceDetail();
    if (dtl != null) {
      StringBuilder sb=new StringBuilder();
      sb.append(location);
      sb.append("(");
      sb.append(dtl.getLine());
      sb.append(", ");
      sb.append(dtl.getLineOffset());
      sb.append("): ");
      sb.append(e.getMessage());
      logger.log(TreeLogger.ERROR,sb.toString(),e);
      return null;
    }
 else {
      logger.log(TreeLogger.ERROR,"Error parsing JSNI source",e);
      return null;
    }
  }
}
