{
  if (value == null) {
    return NullValueCommand.INSTANCE;
  }
  Accessor accessor;
  if ((accessor=CommandSerializationUtil.getAccessor(type)).canMakeValueCommand()) {
    return accessor.makeValueCommand(value);
  }
 else   if (identityMap.containsKey(value)) {
    return identityMap.get(value);
  }
 else   if (type.isArray()) {
    return makeArray(type,value);
  }
 else   if (Enum.class.isAssignableFrom(type)) {
    return makeEnum(value);
  }
 else {
    return makeObject(type,value);
  }
}
