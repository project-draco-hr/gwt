{
  if (dir == null && estimator != null) {
    dir=estimator.estimateDirection(text);
  }
  if (dir == null) {
    option.setText(text);
    option.removeAttribute(BIDI_ATTR_NAME);
  }
 else {
    String formattedText=BidiFormatter.getInstanceForCurrentLocale().unicodeWrapWithKnownDir(dir,text,false,false);
    option.setText(formattedText);
    if (formattedText.length() > text.length()) {
      option.setAttribute(BIDI_ATTR_NAME,"");
    }
 else {
      option.removeAttribute(BIDI_ATTR_NAME);
    }
  }
}
