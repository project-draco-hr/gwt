{
  SortedSet<String> symbols=new TreeSet<String>();
  boolean queryIsAlpha=true;
  for (int i=0; i < query.length(); i++) {
    char c=query.charAt(i);
    if ((c < 'a' || c > 'z') && (c < 'A' || c > 'Z')) {
      queryIsAlpha=false;
      break;
    }
  }
  query=query.toUpperCase(Locale.US);
  if (queryIsAlpha) {
    getTickersByPrefix(query,symbols);
  }
  Pattern pattern=compile("(?iu).*(" + query + ").*");
  if (pattern != null) {
    if (!queryIsAlpha) {
      getTickersBySymbolRegex(pattern,symbols);
    }
    if (query.length() > 2) {
      getTickersByNameRegex(pattern,symbols);
    }
  }
  return getQuotes(symbols,searchRange);
}
