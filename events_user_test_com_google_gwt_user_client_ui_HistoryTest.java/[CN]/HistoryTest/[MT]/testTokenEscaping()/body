{
  final String shouldBeEncoded="% ^[]|\"<>{}\\";
  final String shouldBeEncodedAs="%25%20%5E%5B%5D%7C%22%3C%3E%7B%7D%5C";
  delayTestFinish(5000);
  addHistoryListenerImpl(new HistoryListener(){
    public void onHistoryChanged(    String token){
      if (!isSafari2()) {
        assertEquals(shouldBeEncodedAs,getCurrentLocationHash());
      }
      assertEquals(shouldBeEncoded,token);
      finishTest();
    }
  }
);
  History.newItem(shouldBeEncoded);
}
