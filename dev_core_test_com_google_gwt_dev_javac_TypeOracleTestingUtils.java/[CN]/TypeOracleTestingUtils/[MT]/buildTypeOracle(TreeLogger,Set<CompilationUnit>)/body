{
  JdtCompiler.compile(units);
  Set<String> validBinaryTypeNames=new HashSet<String>();
  for (  CompilationUnit unit : units) {
    for (    CompiledClass compiledClass : unit.getCompiledClasses()) {
      validBinaryTypeNames.add(compiledClass.getBinaryName());
    }
  }
  CompilationUnitInvalidator.validateCompilationUnits(units,validBinaryTypeNames);
  if (CompilationUnitInvalidator.invalidateUnitsWithErrors(logger,units)) {
    CompilationUnitInvalidator.invalidateUnitsWithInvalidRefs(logger,units);
  }
  TypeOracleMediator mediator=new TypeOracleMediator();
  mediator.refresh(logger,units);
  return mediator.getTypeOracle();
}
