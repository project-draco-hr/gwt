{
  OleAutomation funcObj=null;
  Variant funcObjVar=null;
  try {
    int[] ids=window.getIDsOfNames(new String[]{name});
    if (ids == null) {
      throw new RuntimeException("Could not find a native method with the signature '" + name + "'");
    }
    int functionId=ids[0];
    funcObjVar=window.getProperty(functionId);
    funcObj=funcObjVar.getAutomation();
    int callDispId=funcObj.getIDsOfNames(new String[]{"call"})[0];
    return funcObj.invoke(callDispId,vArgs);
  }
  finally {
    if (funcObjVar != null) {
      funcObjVar.dispose();
    }
    if (funcObj != null) {
      funcObj.dispose();
    }
  }
}
