{
  String name;
synchronized (validator) {
    name=validator.getEntityProxyTypeName(domainClass.getName(),clientClass.getName());
  }
  if (name != null) {
    return forName(name).asSubclass(BaseProxy.class);
  }
  if (List.class.isAssignableFrom(domainClass)) {
    return List.class;
  }
  if (Set.class.isAssignableFrom(domainClass)) {
    return Set.class;
  }
  if (TypeUtils.isValueType(domainClass)) {
    return domainClass;
  }
  return die(null,"The domain type %s cannot be sent to the client",domainClass.getCanonicalName());
}
