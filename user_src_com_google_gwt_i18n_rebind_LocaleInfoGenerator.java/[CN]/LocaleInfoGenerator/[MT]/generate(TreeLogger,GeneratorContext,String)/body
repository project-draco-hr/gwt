{
  TypeOracle typeOracle=context.getTypeOracle();
  PropertyOracle propertyOracle=context.getPropertyOracle();
  String locale=null;
  String[] localeValues=null;
  try {
    locale=propertyOracle.getPropertyValue(logger,PROP_LOCALE);
    localeValues=propertyOracle.getPropertyValueSet(logger,PROP_LOCALE);
  }
 catch (  BadPropertyValueException e) {
    logger.log(TreeLogger.TRACE,"LocaleInfo used without I18N module, using defaults",e);
    return LocaleInfoImpl.class.getName();
  }
  JClassType targetClass;
  try {
    targetClass=typeOracle.getType(typeName);
  }
 catch (  NotFoundException e) {
    logger.log(TreeLogger.ERROR,"No such type",e);
    throw new UnableToCompleteException();
  }
  assert(LocaleInfoImpl.class.getName().equals(targetClass.getQualifiedSourceName()));
  String packageName=targetClass.getPackage().getName();
  String className=targetClass.getName().replace('.','_') + "_";
  if (!locale.equals("default")) {
    className+=locale;
  }
  PrintWriter pw=context.tryCreate(logger,packageName,className);
  if (pw != null) {
    ClassSourceFileComposerFactory factory=new ClassSourceFileComposerFactory(packageName,className);
    factory.setSuperclass(targetClass.getQualifiedSourceName());
    SourceWriter writer=factory.createSourceWriter(context,pw);
    writer.println("public String getLocaleName() {");
    writer.println("  return \"" + locale + "\";");
    writer.println("}");
    writer.println();
    writer.println("public String[] getAvailableLocaleNames() {");
    writer.println("  return new String[] {");
    for (    String propval : localeValues) {
      writer.println("    \"" + propval.replaceAll("\"","\\\"") + "\",");
    }
    writer.println("  };");
    writer.println("}");
    writer.commit(logger);
  }
  return packageName + "." + className;
}
