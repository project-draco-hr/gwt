{
  RecordVisitor recorder=new RecordVisitor();
  recorder.accept(program);
  boolean madeChanges=false;
  while (true) {
    TightenTypesVisitor tightener=new TightenTypesVisitor();
    tightener.accept(program);
    if (!tightener.didChange()) {
      break;
    }
    madeChanges=true;
    FixDanglingRefsVisitor fixer=new FixDanglingRefsVisitor();
    fixer.accept(program);
  }
  return madeChanges;
}
