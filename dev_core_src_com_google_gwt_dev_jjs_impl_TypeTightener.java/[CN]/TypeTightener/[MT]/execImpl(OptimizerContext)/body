{
  OptimizerStats stats=new OptimizerStats(NAME);
  RecordVisitor recorder=new RecordVisitor();
  recorder.record(program);
  while (true) {
    TightenTypesVisitor tightener=new TightenTypesVisitor(optimizerCtx);
    tightener.accept(program);
    stats.recordModified(tightener.getNumMods());
    if (!tightener.didChange()) {
      break;
    }
  }
  if (stats.didChange()) {
    FixDanglingRefsVisitor fixer=new FixDanglingRefsVisitor(optimizerCtx);
    fixer.accept(program);
  }
  return stats;
}
