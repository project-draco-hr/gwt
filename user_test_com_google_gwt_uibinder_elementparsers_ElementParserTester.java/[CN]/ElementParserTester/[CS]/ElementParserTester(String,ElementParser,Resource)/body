{
  this.parser=parser;
  String templatePath="TemplatePath.ui.xml";
  String implName="ImplClass";
  Set<Resource> uiResources=getUiResources();
  uiResources.addAll(Arrays.asList(moreJava));
  CompilationState state=CompilationStateBuilder.buildFrom(createLogger(),uiResources);
  types=state.getTypeOracle();
  com.google.gwt.uibinder.attributeparsers.BundleAttributeParsers bundleParsers=new com.google.gwt.uibinder.attributeparsers.BundleAttributeParsers(types,logger,null,templatePath,null);
  elemProvider=new XMLElementProviderImpl(new AttributeParsers(types,null,logger),bundleParsers,types,logger,DesignTimeUtilsStub.EMPTY);
  fieldManager=new FieldManager(types,logger);
  JClassType baseType=types.findType("my.Ui.BaseClass");
  MessagesWriter messages=new MessagesWriter(BINDER_URI,logger,templatePath,baseType.getPackage().getName(),implName);
  HtmlElementFactory elementFactory=new GwtDomHtmlElementFactory();
  writer=new MockUiBinderWriter(baseType,implName,templatePath,types,logger,fieldManager,messages,elementFactory);
  fieldManager.registerField(types.findType(parsedTypeName),FIELD_NAME);
  parsedType=types.findType(parsedTypeName);
}
