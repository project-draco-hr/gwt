{
  ReferenceBinding type=null;
  int p=typeName.indexOf('$');
  if (p > 0) {
    String cupName=typeName.substring(0,p);
    char[][] chars=CharOperation.splitOn('.',cupName.toCharArray());
    if (lookupEnvironment.getType(chars) != null) {
      chars=CharOperation.splitOn('.',typeName.toCharArray());
      type=lookupEnvironment.getCachedType(chars);
      if (type == null) {
        return null;
      }
    }
  }
 else {
    char[][] chars=CharOperation.splitOn('.',typeName.toCharArray());
    type=lookupEnvironment.getType(chars);
  }
  if (type != null) {
    return type;
  }
  p=typeName.lastIndexOf('.');
  if (p >= 0) {
    typeName=typeName.substring(0,p) + "$" + typeName.substring(p + 1);
    return resolvePossiblyNestedType(typeName);
  }
  return null;
}
