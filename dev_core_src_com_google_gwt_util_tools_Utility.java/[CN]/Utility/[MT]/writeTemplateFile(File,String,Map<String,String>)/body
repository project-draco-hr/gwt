{
  String replacedContents=contents;
  Set<Entry<String,String>> entries=replacements.entrySet();
  for (Iterator<Entry<String,String>> iter=entries.iterator(); iter.hasNext(); ) {
    Entry<String,String> entry=iter.next();
    String replaceThis=entry.getKey();
    String withThis=entry.getValue();
    withThis=withThis.replaceAll("\\\\","\\\\\\\\");
    withThis=withThis.replaceAll("\\$","\\\\\\$");
    replacedContents=replacedContents.replaceAll(replaceThis,withThis);
  }
  PrintWriter pw=new PrintWriter(file);
  LineNumberReader lnr=new LineNumberReader(new StringReader(replacedContents));
  for (String line=lnr.readLine(); line != null; line=lnr.readLine()) {
    pw.println(line);
  }
  close(pw);
}
