{
  checkDevice();
  for (int i=0; i < widgetTable.length; i++) {
    Widget widget=widgetTable[i];
    if (widget != null && widget instanceof Shell) {
      Shell shell=(Shell)widget;
      if (OS.IsWindowActive(shell.shellHandle))       return shell;
    }
  }
  return null;
}
