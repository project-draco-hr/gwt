{
  JMethod method=x.getTarget();
  JExpression instance=x.getInstance();
  if (!x.canBePolymorphic()) {
    return;
  }
  JType instanceType=instance.getType();
  JReferenceType enclosingType=method.getEnclosingType();
  if (instanceType == enclosingType || instanceType instanceof JInterfaceType) {
    return;
  }
  if (instanceType instanceof JArrayType) {
    return;
  }
  if (instanceType instanceof JNullType) {
    return;
  }
  assert(instanceType instanceof JClassType);
  JMethod foundMethod=null;
  JClassType type;
  outer:   for (type=(JClassType)instanceType; type != null && type != enclosingType; type=type.extnds) {
    for (int i=0; i < type.methods.size(); ++i) {
      JMethod methodIt=type.methods.get(i);
      if (methodOverrides(methodIt,method)) {
        foundMethod=methodIt;
        break outer;
      }
    }
  }
  if (foundMethod == null) {
    return;
  }
  JMethodCall call=new JMethodCall(program,x.getSourceInfo(),x.getInstance(),foundMethod);
  call.getArgs().addAll(x.getArgs());
  ctx.replaceMe(call);
}
