{
  final RuntimeException toThrow=new RuntimeException("Should be caught by the uncaught exception handler");
  final UncaughtExceptionHandler originalHandler=GWT.getUncaughtExceptionHandler();
  GWT.UncaughtExceptionHandler myHandler=new GWT.UncaughtExceptionHandler(){
    public void onUncaughtException(    Throwable e){
      GWT.setUncaughtExceptionHandler(originalHandler);
      if (e == toThrow) {
        finishTest();
      }
 else {
        throw new RuntimeException(e);
      }
    }
  }
;
  GWT.setUncaughtExceptionHandler(myHandler);
  delayTestFinish(RUNASYNC_TIMEOUT);
  try {
    GWT.runAsync(new RunAsyncCallback(){
      public void onFailure(      Throwable caught){
      }
      public void onSuccess(){
        throw toThrow;
      }
    }
);
  }
 catch (  Throwable e) {
    myHandler.onUncaughtException(e);
  }
}
