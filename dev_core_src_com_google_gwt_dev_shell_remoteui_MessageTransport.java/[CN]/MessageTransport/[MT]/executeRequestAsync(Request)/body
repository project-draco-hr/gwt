{
  Future<Response> responseFuture=serverRequestExecutor.submit(new Callable<Response>(){
    public Response call() throws Exception {
      Message.Builder messageBuilder=Message.newBuilder();
      int messageId=nextMessageId.getAndIncrement();
      messageBuilder.setMessageId(messageId);
      messageBuilder.setMessageType(Message.MessageType.REQUEST);
      messageBuilder.setRequest(requestMessage);
      Message message=messageBuilder.build();
      PendingRequest pendingRequest=new PendingRequest(message);
      sendQueue.put(pendingRequest);
      return pendingRequest.waitForResponse();
    }
  }
);
  return responseFuture;
}
