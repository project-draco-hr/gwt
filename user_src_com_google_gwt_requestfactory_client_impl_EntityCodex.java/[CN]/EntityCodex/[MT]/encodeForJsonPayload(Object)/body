{
  if (value == null) {
    return "null";
  }
  if (value instanceof Iterable<?>) {
    StringBuffer toReturn=new StringBuffer();
    toReturn.append('[');
    boolean first=true;
    for (    Object val : ((Iterable<?>)value)) {
      if (!first) {
        toReturn.append(',');
      }
 else {
        first=false;
      }
      toReturn.append(encodeForJsonPayload(val));
    }
    toReturn.append(']');
    return toReturn.toString();
  }
  if (value instanceof EntityProxy) {
    String historyToken=AbstractRequestFactory.getHistoryToken((EntityProxy)value);
    return "\"" + historyToken + "\"";
  }
  return ValueCodex.encodeForJsonPayload(value);
}
