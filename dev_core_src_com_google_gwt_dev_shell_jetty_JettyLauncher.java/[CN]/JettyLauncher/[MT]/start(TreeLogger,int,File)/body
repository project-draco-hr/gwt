{
  TreeLogger branch=logger.branch(TreeLogger.TRACE,"Starting Jetty on port " + port,null);
  checkStartParams(branch,port,appRootDir);
  Log.setLog(new JettyTreeLogger(branch));
  jreLeakPrevention(logger);
  System.setProperty("org.eclipse.jetty.xml.XmlParser.Validating","false");
  Server server=new Server();
  ServerConnector connector=getConnector(server,logger);
  setupConnector(connector,bindAddress,port);
  server.addConnector(connector);
  Configuration.ClassList cl=Configuration.ClassList.setServerDefault(server);
  try {
    Thread.currentThread().getContextClassLoader().loadClass("org.eclipse.jetty.plus.webapp.PlusConfiguration");
    cl.addAfter("org.eclipse.jetty.webapp.FragmentConfiguration","org.eclipse.jetty.plus.webapp.EnvConfiguration","org.eclipse.jetty.plus.webapp.PlusConfiguration");
  }
 catch (  ClassNotFoundException cnfe) {
    logger.log(TreeLogger.Type.DEBUG,"jetty-plus isn't on the classpath, JNDI won't work. This might also affect annotations scanning and JSP.");
  }
  try {
    Thread.currentThread().getContextClassLoader().loadClass("org.eclipse.jetty.annotations.AnnotationConfiguration");
    cl.addBefore("org.eclipse.jetty.webapp.JettyWebXmlConfiguration","org.eclipse.jetty.annotations.AnnotationConfiguration");
  }
 catch (  ClassNotFoundException cnfe) {
    logger.log(TreeLogger.Type.DEBUG,"jetty-annotations isn't on the classpath, annotation scanning won't work. This might also affect annotations scanning.");
  }
  WebAppContext wac=createWebAppContext(logger,appRootDir);
  RequestLogHandler logHandler=new RequestLogHandler();
  logHandler.setRequestLog(new JettyRequestLogger(logger,getBaseLogLevel()));
  logHandler.setHandler(wac);
  server.setHandler(logHandler);
  server.start();
  server.setStopAtShutdown(true);
  Log.setLog(new JettyTreeLogger(logger));
  int connectorPort=connector.getLocalPort();
  if (connector.getLocalPort() < 0) {
    branch.log(TreeLogger.ERROR,String.format("Failed to connect to open channel with port %d (return value %d)",port,connectorPort));
  }
  return createServletContainer(logger,appRootDir,server,wac,connectorPort);
}
