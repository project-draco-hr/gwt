{
  if (sessionCookieName == null) {
    throw new IllegalStateException(COOKIE_NAME_NOT_SET_ERROR_MSG);
  }
  Cookie sessionCookie=Util.getCookie(getThreadLocalRequest(),sessionCookieName,false);
  if (sessionCookie == null || sessionCookie.getValue() == null || sessionCookie.getValue().isEmpty()) {
    throw new RpcTokenException("Session cookie is not set or empty! " + "Unable to generate XSRF cookie");
  }
  byte[] cookieBytes=sessionCookie.getValue().getBytes();
  return Utility.toHexString(Utility.getMd5Digest(cookieBytes));
}
