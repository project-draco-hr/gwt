{
  Element target=DOM.eventGetTarget(event);
  boolean eventTargetsPopup=DOM.isOrHasChild(getElement(),target);
  int type=DOM.eventGetType(event);
switch (type) {
case Event.ONKEYDOWN:
{
      return onKeyDownPreview((char)DOM.eventGetKeyCode(event),KeyboardListenerCollection.getKeyboardModifiers(event));
    }
case Event.ONKEYUP:
{
    return onKeyUpPreview((char)DOM.eventGetKeyCode(event),KeyboardListenerCollection.getKeyboardModifiers(event));
  }
case Event.ONKEYPRESS:
{
  return onKeyPressPreview((char)DOM.eventGetKeyCode(event),KeyboardListenerCollection.getKeyboardModifiers(event));
}
case Event.ONMOUSEDOWN:
case Event.ONMOUSEUP:
case Event.ONMOUSEMOVE:
case Event.ONCLICK:
case Event.ONDBLCLICK:
{
if (DOM.getCaptureElement() != null) {
  return true;
}
if (!eventTargetsPopup && autoHide && (type == Event.ONCLICK)) {
  hide(true);
  return true;
}
break;
}
case Event.ONFOCUS:
{
if (modal && !eventTargetsPopup && (target != null)) {
blur(target);
return false;
}
}
}
return !modal || (modal && eventTargetsPopup);
}
