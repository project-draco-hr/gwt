{
  int numStyles=getDocumentStyleCount();
  if (numStyles < MAX_STYLE_SHEETS) {
    return createNewStyleSheet(contents);
  }
 else {
    int shortestLen=Integer.MAX_VALUE;
    int shortestIdx=-1;
    for (int i=0; i < numStyles; i++) {
      int len=styleSheetLengths[i];
      if (len == 0) {
        len=styleSheetLengths[i]=getDocumentStyleSheetLength(i);
      }
      if (len <= shortestLen) {
        shortestLen=len;
        shortestIdx=i;
      }
    }
    styleSheetLengths[shortestIdx]+=contents.length();
    return appendToStyleSheet(shortestIdx,contents,true);
  }
}
