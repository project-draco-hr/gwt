{
  if (outprop == null) {
    throw new BuildException("<svninfo> task requires an outputproperty attribute");
  }
  if (workdir == null) {
    workdir=getProject().getProperty("basedir");
  }
  File workDirFile=new File(workdir);
  if (!workDirFile.isDirectory()) {
    throw new BuildException(workdir + " is not a directory");
  }
  Info info;
  if (!looksLikeSvn(workDirFile)) {
    info=new Info("unknown","unknown");
  }
 else {
    info=parseInfo(getSvnInfo(workDirFile));
    info.revision=getSvnVersion(workDirFile);
  }
  getProject().setNewProperty(outprop,info.branch + "@" + info.revision);
  if (fileprop != null) {
    getProject().setNewProperty(fileprop,info.branch + "-" + info.revision.replaceAll(":","-"));
  }
}
