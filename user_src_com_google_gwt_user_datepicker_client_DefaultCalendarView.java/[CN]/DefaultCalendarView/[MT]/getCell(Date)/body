{
  int index=CalendarUtil.getDaysBetween(firstDisplayed,d);
  if (index < 0 || grid.getNumCells() <= index) {
    return null;
  }
  DateCell cell=(DateCell)grid.getCell(index);
  if (cell.getValue().getDate() != d.getDate()) {
    throw new IllegalStateException(d + " cannot be associated with cell " + cell+ " as it has date "+ cell.getValue());
  }
  return cell;
}
