{
  int index=CalendarUtil.getDaysBetween(firstDisplayed,d);
  assert(index >= 0);
  DateCell cell=(DateCell)grid.getCell(index);
  if (cell.getValue().getDate() != d.getDate()) {
    throw new IllegalStateException(d + " cannot be associated with cell " + cell+ " as it has date "+ cell.getValue());
  }
  return cell;
}
