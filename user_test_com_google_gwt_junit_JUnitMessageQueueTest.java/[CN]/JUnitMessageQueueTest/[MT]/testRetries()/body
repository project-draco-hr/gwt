{
  JUnitMessageQueue queue=createQueue(TWO_CLIENTS,ONE_BLOCK,ONE_TEST_PER_BLOCK);
  TestInfo testInfo=queue.getTestBlocks().get(0)[0];
  Map<TestInfo,JUnitResult> results=new HashMap<TestInfo,JUnitResult>();
  JUnitResult junitResult=new JUnitResult();
  junitResult.setException(new AssertionError());
  results.put(testInfo,junitResult);
  queue.reportResults(createClientInfo(0,"ff3"),results);
  assertTrue(queue.needsRerunning(testInfo));
  Map<ClientStatus,JUnitResult> queueResults=queue.getResults(testInfo);
  assertEquals(1,queueResults.size());
  for (  JUnitResult result : queueResults.values()) {
    assertNotNull(result.getException());
  }
  queue.removeResults(testInfo);
  queue.reportResults(createClientInfo(0,"ff3"),createTestResults(ONE_TEST_PER_BLOCK));
  queue.reportResults(createClientInfo(1,"ie6"),createTestResults(ONE_TEST_PER_BLOCK));
  assertFalse(queue.needsRerunning(testInfo));
  queueResults=queue.getResults(testInfo);
  assertEquals(2,queueResults.size());
  for (  JUnitResult result : queueResults.values()) {
    assertNull(result.getException());
  }
}
