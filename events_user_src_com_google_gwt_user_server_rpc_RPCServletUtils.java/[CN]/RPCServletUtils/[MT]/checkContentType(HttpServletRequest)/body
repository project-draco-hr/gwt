{
  String contentType=request.getContentType();
  boolean contentTypeIsOkay=false;
  if (contentType != null) {
    contentType=contentType.toLowerCase();
    if (contentType.startsWith(EXPECTED_CONTENT_TYPE)) {
      contentTypeIsOkay=true;
    }
  }
  if (!contentTypeIsOkay) {
    throw new ServletException("Content-Type was '" + (contentType == null ? "(null)" : contentType) + "'. Expected '"+ EXPECTED_CONTENT_TYPE+ "'.");
  }
}
