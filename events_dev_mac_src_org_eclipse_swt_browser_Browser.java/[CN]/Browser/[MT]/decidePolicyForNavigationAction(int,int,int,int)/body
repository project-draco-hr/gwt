{
  int url=WebKit.objc_msgSend(request,WebKit.S_URL);
  if (url == 0) {
    WebKit.objc_msgSend(listener,WebKit.S_ignore);
    return;
  }
  int s=WebKit.objc_msgSend(url,WebKit.S_absoluteString);
  int length=OS.CFStringGetLength(s);
  char[] buffer=new char[length];
  CFRange range=new CFRange();
  range.length=length;
  OS.CFStringGetCharacters(s,range,buffer);
  String url2=new String(buffer);
  LocationEvent newEvent=new LocationEvent(this);
  newEvent.display=getDisplay();
  newEvent.widget=this;
  newEvent.location=url2;
  newEvent.doit=true;
  if (locationListeners != null) {
    changingLocation=true;
    for (int i=0; i < locationListeners.length; i++)     locationListeners[i].changing(newEvent);
    changingLocation=false;
  }
  WebKit.objc_msgSend(listener,newEvent.doit ? WebKit.S_use : WebKit.S_ignore);
  if (html != null && !isDisposed()) {
    String html=this.html;
    this.html=null;
    _setText(html);
  }
}
