{
  boolean isFirstStatement=true;
  boolean hasEmployee=employeeId != null && employeeId >= 0;
  boolean hasStartsWith=startsWith != null && startsWith.length() > 0;
  String retValue=isCount ? "count(o)" : "o";
  String queryString="select " + retValue + " from Report o";
  if (hasEmployee) {
    queryString+=isFirstStatement ? " WHERE" : " AND";
    isFirstStatement=false;
    queryString+=" o.reporterKey =:reporterKey";
  }
  if (hasStartsWith) {
    queryString+=isFirstStatement ? " WHERE" : " AND";
    isFirstStatement=false;
    queryString+=" o.purposeLowerCase >=:startsWith";
    queryString+=" AND o.purposeLowerCase <=:startsWithZ";
  }
  if (!hasStartsWith && orderBy != null && orderBy.length() >= 0) {
    queryString+=" ORDER BY " + orderBy;
  }
  Query query=em.createQuery(queryString);
  if (hasEmployee) {
    query.setParameter("reporterKey",employeeId);
  }
  if (hasStartsWith) {
    query.setParameter("startsWith",startsWith);
    query.setParameter("startsWithZ",startsWith + "zzzzzz");
  }
  return query;
}
