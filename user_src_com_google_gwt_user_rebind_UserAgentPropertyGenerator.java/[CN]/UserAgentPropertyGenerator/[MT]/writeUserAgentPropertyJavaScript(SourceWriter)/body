{
  body.println("var ua = navigator.userAgent.toLowerCase();");
  body.println("var makeVersion = function(result) {");
  body.indent();
  body.println("return (parseInt(result[1]) * 1000) + parseInt(result[2]);");
  body.outdent();
  body.println("};");
  body.println("if (ua.indexOf('opera') != -1) {");
  body.indent();
  body.println("return 'opera';");
  body.outdent();
  body.println("} else if (ua.indexOf('webkit') != -1) {");
  body.indent();
  body.println("return 'safari';");
  body.outdent();
  body.println("} else if (ua.indexOf('msie') != -1) {");
  body.indent();
  body.println("if ($doc.documentMode >= 8) {");
  body.indent();
  body.println("return 'ie8';");
  body.outdent();
  body.println("} else {");
  body.indent();
  body.println("var result = /msie ([0-9]+)\\.([0-9]+)/.exec(ua);");
  body.println("if (result && result.length == 3) {");
  body.indent();
  body.println("var v = makeVersion(result);");
  body.println("if (v >= 6000) {");
  body.indent();
  body.println("return 'ie6';");
  body.outdent();
  body.println("}");
  body.outdent();
  body.println("}");
  body.outdent();
  body.println("}");
  body.outdent();
  body.println("} else if (ua.indexOf('gecko') != -1) {");
  body.indent();
  body.println("return 'gecko1_8';");
  body.outdent();
  body.println("}");
  body.println("return 'unknown';");
}
