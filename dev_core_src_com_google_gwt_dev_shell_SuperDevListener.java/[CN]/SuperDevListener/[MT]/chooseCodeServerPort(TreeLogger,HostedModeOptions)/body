{
  int port=options.getCodeServerPort();
  if (port == 0) {
    try {
      ServerSocket serverSocket=new ServerSocket(0);
      port=serverSocket.getLocalPort();
      serverSocket.close();
      return port;
    }
 catch (    IOException e) {
      logger.log(TreeLogger.ERROR,"Unable to get an unnused port.");
      throw new RuntimeException(e);
    }
  }
 else   if (port < 0 || port == 9997) {
    return 9876;
  }
 else {
    return port;
  }
}
