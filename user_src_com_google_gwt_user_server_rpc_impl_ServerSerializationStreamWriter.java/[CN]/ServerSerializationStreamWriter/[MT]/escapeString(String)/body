{
  char[] input=toEscape.toCharArray();
  char[] output=new char[input.length * 2 + 2];
  int j=0;
  output[j]=JS_QUOTE_CHAR;
  for (int i=0, n=input.length; i < n; ++i) {
    char c=input[i];
    if (c < NUMBER_OF_JS_ESCAPED_CHARS && JS_CHARS_ESCAPED[c] != 0) {
      output[++j]=JS_ESCAPE_CHAR;
      output[++j]=JS_CHARS_ESCAPED[c];
    }
 else {
      output[++j]=c;
    }
  }
  output[++j]=JS_QUOTE_CHAR;
  return String.valueOf(output,0,++j);
}
