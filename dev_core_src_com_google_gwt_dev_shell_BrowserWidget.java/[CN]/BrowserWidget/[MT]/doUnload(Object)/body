{
  if (key == null) {
    for (    Map.Entry<?,ModuleSpace> entry : loadedModules.entrySet()) {
      unloadModule(entry.getValue());
    }
    loadedModules.clear();
  }
 else {
    ModuleSpace moduleSpace=loadedModules.get(key);
    if (moduleSpace == null) {
      throw new HostedModeException("Can't find frame window for " + key);
    }
    unloadModule(moduleSpace);
    loadedModules.remove(key);
  }
  if (loadedModules.isEmpty()) {
    if (!toolbar.openWebModeButton.isDisposed()) {
      toolbar.openWebModeButton.setEnabled(false);
    }
  }
}
