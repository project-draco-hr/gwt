{
  HasData<String> listView=new MockHasData<String>();
  MockView<String> view=new MockView<String>();
  HasDataPresenter<String> presenter=new HasDataPresenter<String>(listView,view,10,null);
  presenter.setVisibleRange(new Range(5,10));
  presenter.flush();
  view.assertReplaceAllChildrenCalled(0);
  view.assertLoadingState(LoadingState.LOADING);
  List<String> expectedData=createData(5,10);
  presenter.setRowData(5,createData(5,10));
  assertPresenterRowData(expectedData,presenter);
  presenter.flush();
  view.assertReplaceAllChildrenCalled(10);
  assertEquals(10,view.getChildCount());
  view.assertLoadingState(LoadingState.LOADED);
  expectedData.set(2,"test 100");
  expectedData.set(3,"test 101");
  presenter.setRowData(7,createData(100,2));
  assertPresenterRowData(expectedData,presenter);
  presenter.flush();
  view.assertReplaceChildrenCalled(2,2);
  assertEquals(10,view.getChildCount());
  view.assertLoadingState(LoadingState.LOADED);
  expectedData.set(0,"test 202");
  expectedData.set(1,"test 203");
  presenter.setRowData(3,createData(200,4));
  assertPresenterRowData(expectedData,presenter);
  presenter.flush();
  view.assertReplaceChildrenCalled(0,2);
  assertEquals(10,view.getChildCount());
  view.assertLoadingState(LoadingState.LOADED);
  expectedData.set(8,"test 300");
  expectedData.set(9,"test 301");
  presenter.setRowData(13,createData(300,4));
  assertPresenterRowData(expectedData,presenter);
  presenter.flush();
  view.assertReplaceChildrenCalled(8,2);
  assertEquals(10,view.getChildCount());
  view.assertLoadingState(LoadingState.LOADED);
  expectedData=createData(400,20).subList(2,12);
  presenter.setRowData(3,createData(400,20));
  assertPresenterRowData(expectedData,presenter);
  presenter.flush();
  view.assertReplaceAllChildrenCalled(10);
  assertEquals(10,view.getChildCount());
  view.assertLoadingState(LoadingState.LOADED);
}
