{
  state.refresh(createTreeLogger());
  assertEquals(0,state.graveyardUnits.size());
  testCachingOverSingleRefresh(new HashSet<CompilationUnit>(initialSet),0,Collections.<String>emptySet(),0);
  testCachingOverSingleRefresh(new HashSet<CompilationUnit>(updatedSet),initialSet.size(),reusedTypes,numInvalidated);
  reusedTypes=new HashSet<String>();
  for (  CompilationUnit unit : updatedSet) {
    reusedTypes.add(unit.getTypeName());
  }
  testCachingOverSingleRefresh(new HashSet<CompilationUnit>(updatedSet),updatedSet.size(),reusedTypes,0);
}
