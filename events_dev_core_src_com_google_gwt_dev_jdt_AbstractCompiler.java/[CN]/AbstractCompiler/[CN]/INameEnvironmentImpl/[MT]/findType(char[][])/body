{
  String qname=CharOperation.toString(compoundTypeName);
  if (nameEnvironmentAnswerForTypeName.containsKey(qname)) {
    return (nameEnvironmentAnswerForTypeName.get(qname));
  }
  TreeLogger logger=threadLogger.branch(TreeLogger.SPAM,"Compiler is asking about '" + qname + "'",null);
  if (isPackage(qname)) {
    logger.log(TreeLogger.SPAM,"Found to be a package",null);
    return null;
  }
  String className=qname;
  int pos=qname.indexOf('$');
  if (pos >= 0) {
    qname=qname.substring(0,pos);
    if (nameEnvironmentAnswerForTypeName.containsKey(qname)) {
      return (nameEnvironmentAnswerForTypeName.get(qname));
    }
  }
  CompilationUnit unit=findCompilationUnit(qname);
  if (unit != null) {
    logger.log(TreeLogger.SPAM,"Found type in compilation unit: " + unit.getDisplayLocation());
    ICompilationUnit icu=new CompilationUnitAdapter(unit);
    NameEnvironmentAnswer out=new NameEnvironmentAnswer(icu,null);
    nameEnvironmentAnswerForTypeName.put(qname,out);
    return out;
  }
 else {
    ClassLoader classLoader=getClassLoader();
    URL resourceURL=classLoader.getResource(className.replace('.','/') + ".class");
    if (resourceURL != null) {
      if (isBinaryType(classLoader,className)) {
        byte[] classBytes=Util.readURLAsBytes(resourceURL);
        ClassFileReader cfr;
        try {
          cfr=new ClassFileReader(classBytes,null);
          NameEnvironmentAnswer out=new NameEnvironmentAnswer(cfr,null);
          nameEnvironmentAnswerForTypeName.put(qname,out);
          return out;
        }
 catch (        ClassFormatException e) {
        }
      }
    }
    logger.log(TreeLogger.SPAM,"Not a known type",null);
    return null;
  }
}
