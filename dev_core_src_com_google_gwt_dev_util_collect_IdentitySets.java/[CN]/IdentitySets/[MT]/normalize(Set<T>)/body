{
switch (set.size()) {
case 0:
    return Collections.emptySet();
case 1:
{
    if (set.getClass() != IdentitySingletonSet.class) {
      return new IdentitySingletonSet<T>(set.iterator().next());
    }
    return set;
  }
default :
return set;
}
}
