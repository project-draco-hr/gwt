{
  String[] bits=token.split(HISTORY_TOKEN_SEPARATOR);
  String schemaToken;
  if (bits.length == 1) {
    schemaToken=token;
  }
 else   if (bits.length == 2 || bits.length == 3) {
    schemaToken=bits[SCHEMA_INDEX];
  }
 else {
    return null;
  }
  ProxySchema<? extends EntityProxy> schema=recordToTypeMap.getType(schemaToken);
  if (schema == null) {
    return null;
  }
  return schema.getProxyClass();
}
