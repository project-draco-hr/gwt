{
  if (singletonWindowLogger != null) {
    return singletonWindowLogger;
  }
  final AbstractTreeLogger[] loggerHolder=new AbstractTreeLogger[1];
  Thread logWindowThread=new Thread(){
    public void run(){
      Shell shell=new Shell(Display.getCurrent());
      shell.setText(caption);
      FillLayout fillLayout=new FillLayout();
      fillLayout.marginWidth=0;
      fillLayout.marginHeight=0;
      shell.setLayout(fillLayout);
synchronized (loggerHolder) {
        final TreeLoggerWidget treeLoggerWidget=new TreeLoggerWidget(shell);
        treeLoggerWidget.setAutoScroll(autoScroll);
        loggerHolder[0]=treeLoggerWidget.getLogger();
      }
      shell.setImage(LowLevel.loadImage("gwt.ico"));
      shell.setSize(width,height);
      shell.open();
      Display display=Display.getCurrent();
      while (!shell.isDisposed()) {
        try {
          if (!display.readAndDispatch()) {
            display.sleep();
          }
        }
 catch (        Throwable e) {
        }
      }
    }
  }
;
  logWindowThread.setName("TreeLogger Window");
  logWindowThread.start();
  while (singletonWindowLogger == null) {
    Thread.yield();
    if (logWindowThread.isAlive()) {
synchronized (loggerHolder) {
        singletonWindowLogger=loggerHolder[0];
      }
    }
 else {
      throw new IllegalStateException("Log window thread died unexpectedly");
    }
  }
  return singletonWindowLogger;
}
