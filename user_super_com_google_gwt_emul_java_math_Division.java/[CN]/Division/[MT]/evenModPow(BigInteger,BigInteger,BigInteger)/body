{
  int j=modulus.getLowestSetBit();
  BigInteger q=modulus.shiftRight(j);
  BigInteger x1=oddModPow(base,exponent,q);
  BigInteger x2=pow2ModPow(base,exponent,j);
  BigInteger qInv=modPow2Inverse(q,j);
  BigInteger y=(x2.subtract(x1)).multiply(qInv);
  inplaceModPow2(y,j);
  if (y.sign < 0) {
    y=y.add(BigInteger.getPowerOfTwo(j));
  }
  return x1.add(q.multiply(y));
}
