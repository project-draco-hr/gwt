{
  Address oldAddress=person.address;
  driver.initialize(personEditor);
  assertEquals(0,addressEditor.setValueCalled);
  assertEquals(0,addressEditor.getValueCalled);
  driver.edit(person);
  assertEquals(1,addressEditor.setValueCalled);
  assertEquals(0,addressEditor.getValueCalled);
  assertEquals(UNINITIALIZED,addressEditor.city.getValue());
  driver.flush();
  assertEquals(1,addressEditor.setValueCalled);
  assertEquals(1,addressEditor.getValueCalled);
  if (declaredAsLeaf) {
    assertNotSame(oldAddress,person.address);
    assertSame(person.address,addressEditor.value);
  }
 else {
    assertSame(oldAddress,person.address);
    assertNotSame(person.address,addressEditor.value);
  }
}
