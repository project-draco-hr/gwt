{
  Set<String> tickers=new TreeSet<String>();
  if (query.length() > 0) {
    query=query.toUpperCase();
    int count=0;
    for (    String ticker : stockTickers) {
      if (ticker.startsWith(query) || (pattern != null && match(ticker,pattern))) {
        tickers.add(ticker);
        count++;
        if (count > MAX_RESULTS_TO_RETURN) {
          break;
        }
      }
    }
    if (pattern != null) {
      for (      Map.Entry<String,String> entry : companyNamesBySymbol.entrySet()) {
        if (match(entry.getValue(),pattern)) {
          tickers.add(entry.getKey());
          count++;
          if (count > MAX_RESULTS_TO_RETURN) {
            break;
          }
        }
      }
    }
  }
  return new ArrayList<String>(tickers);
}
