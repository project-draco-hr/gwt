{
  int policy=Browser.URLPOLICY_ALLOW;
  if (dwAction >= Browser.URLACTION_JAVA_MIN && dwAction <= Browser.URLACTION_JAVA_MAX) {
    policy=Browser.URLPOLICY_JAVA_LOW;
  }
  if (dwAction == Browser.URLACTION_ACTIVEX_RUN) {
    GUID guid=new GUID();
    COM.MoveMemory(guid,pContext,GUID.sizeof);
    if (COM.IsEqualGUID(guid,COM.IIDJavaBeansBridge) || COM.IsEqualGUID(guid,COM.IIDShockwaveActiveXControl)) {
      policy=Browser.URLPOLICY_DISALLOW;
    }
  }
  if (cbPolicy >= 4)   COM.MoveMemory(pPolicy,new int[]{policy},4);
  return COM.S_OK;
}
