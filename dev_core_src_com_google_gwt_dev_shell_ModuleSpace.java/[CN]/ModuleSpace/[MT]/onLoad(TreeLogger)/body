{
  host.onModuleReady(this);
  setJavaScriptHost();
  initializeStaticDispatcher();
  String entryPointTypeName=null;
  try {
    String[] entryPoints=host.getEntryPointTypeNames();
    if (entryPoints.length > 0) {
      for (int i=0; i < entryPoints.length; i++) {
        entryPointTypeName=entryPoints[i];
        Class clazz=loadClassFromSourceName(entryPointTypeName);
        Method onModuleLoad=null;
        try {
          onModuleLoad=clazz.getMethod("onModuleLoad",null);
          if (!Modifier.isStatic(onModuleLoad.getModifiers())) {
            onModuleLoad=null;
          }
        }
 catch (        NoSuchMethodException e) {
        }
        Object module=null;
        if (onModuleLoad == null) {
          module=rebindAndCreate(entryPointTypeName);
          onModuleLoad=module.getClass().getMethod("onModuleLoad",null);
        }
        onModuleLoad.setAccessible(true);
        onModuleLoad.invoke(module,null);
      }
    }
 else {
      logger.log(TreeLogger.WARN,"The module has no entry points defined, so onModuleLoad() will never be called",null);
    }
  }
 catch (  Throwable e) {
    Throwable caught=e;
    if (e instanceof InvocationTargetException) {
      caught=((InvocationTargetException)e).getTargetException();
    }
    if (caught instanceof ExceptionInInitializerError) {
      caught=((ExceptionInInitializerError)caught).getException();
    }
    final String unableToLoadMessage="Unable to load module entry point class " + entryPointTypeName;
    logger.log(TreeLogger.ERROR,unableToLoadMessage,caught);
    throw new UnableToCompleteException();
  }
}
