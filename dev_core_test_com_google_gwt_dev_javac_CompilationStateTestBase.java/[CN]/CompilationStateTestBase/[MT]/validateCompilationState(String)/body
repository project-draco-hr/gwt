{
  Map<String,CompilationUnit> unitMap=state.getCompilationUnitMap();
  Collection<CompilationUnit> units=state.getCompilationUnits();
  assertEquals(new HashSet<CompilationUnit>(unitMap.values()),new HashSet<CompilationUnit>(units));
  Map<String,Resource> sourceMap=new HashMap<String,Resource>(oracle.getResourceMap());
  Set<String> generatedTypes=new HashSet<String>(Arrays.asList(generatedTypeNames));
  assertEquals(sourceMap.size() + generatedTypes.size(),units.size());
  for (  Entry<String,CompilationUnit> entry : unitMap.entrySet()) {
    String className=entry.getKey();
    CompilationUnit unit=entry.getValue();
    assertEquals(className,unit.getTypeName());
    if (unit.isGenerated()) {
      assertTrue(generatedTypes.contains(className));
      assertNotNull(generatedTypes.remove(className));
    }
 else {
      String partialPath=className.replace('.','/') + ".java";
      assertTrue(sourceMap.containsKey(partialPath));
      assertNotNull(sourceMap.remove(partialPath));
    }
  }
  assertEquals(0,sourceMap.size());
  assertEquals(0,generatedTypes.size());
}
