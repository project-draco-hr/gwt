{
  evalBooleanContext.remove(x.getIfExpr());
  JsExpression expr=x.getIfExpr();
  JsStatement thenStmt=x.getThenStmt();
  JsStatement elseStmt=x.getElseStmt();
  SourceInfo sourceInfo;
  if (expr instanceof CanBooleanEval) {
    CanBooleanEval cond=(CanBooleanEval)expr;
    JsStatement onlyStmtToExecute;
    JsStatement removed;
    if (cond.isBooleanTrue()) {
      onlyStmtToExecute=thenStmt;
      removed=elseStmt;
      sourceInfo=x.getSourceInfo().makeChild(StaticEvalVisitor.class,"Simplified always-true condition");
    }
 else     if (cond.isBooleanFalse()) {
      onlyStmtToExecute=elseStmt;
      removed=thenStmt;
      sourceInfo=x.getSourceInfo().makeChild(StaticEvalVisitor.class,"Simplified always-false condition");
    }
 else {
      return;
    }
    JsBlock block=new JsBlock(sourceInfo);
    block.getStatements().add(expr.makeStmt());
    if (onlyStmtToExecute != null) {
      block.getStatements().add(onlyStmtToExecute);
    }
    JsStatement decls=ensureDeclarations(removed);
    if (decls != null) {
      block.getStatements().add(decls);
    }
    ctx.replaceMe(accept(block));
  }
 else {
    boolean thenIsEmpty=isEmpty(thenStmt);
    boolean elseIsEmpty=isEmpty(elseStmt);
    if (thenIsEmpty && elseIsEmpty) {
      ctx.replaceMe(expr.makeStmt());
    }
 else     if (thenIsEmpty && !elseIsEmpty) {
      sourceInfo=x.getSourceInfo().makeChild(StaticEvalVisitor.class,"Simplified if with empty then statement");
      JsUnaryOperation negatedOperation=new JsPrefixOperation(sourceInfo,JsUnaryOperator.NOT,x.getIfExpr());
      JsIf newIf=new JsIf(sourceInfo,negatedOperation,elseStmt,null);
      ctx.replaceMe(accept(newIf));
    }
 else     if (elseIsEmpty && elseStmt != null) {
      sourceInfo=x.getSourceInfo().makeChild(StaticEvalVisitor.class,"Pruned empty else statement");
      JsIf newIf=new JsIf(sourceInfo,x.getIfExpr(),thenStmt,null);
      ctx.replaceMe(accept(newIf));
    }
  }
}
