{
  UnitTestTreeLogger.Builder b=new UnitTestTreeLogger.Builder();
  b.setLowestLogLevel(logLevel);
  if (message != null) {
    b.expect(logLevel,logHeader + " in '/mock/Buggy'",null);
    final String fullMessage="Line " + line + ": "+ message;
    b.expect(logLevel,fullMessage,null);
  }
  UnitTestTreeLogger logger=b.createLogger();
  TypeOracle oracle=buildOracle(buggyCode,extraCode,logger);
  logger.assertCorrectLogEntries();
  if (message != null && logLevel == TreeLogger.ERROR) {
    assertNull("Buggy compilation unit not removed from type oracle",oracle.findType("Buggy"));
  }
 else {
    assertNotNull("Buggy compilation unit removed with only a warning",oracle.findType("Buggy"));
  }
}
