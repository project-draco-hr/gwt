{
  try {
    SelectionProperty localeProp=propertyOracle.getSelectionProperty(logger,PROP_LOCALE);
    String localeName=localeProp.getCurrentValue();
    SortedSet<String> localeValues=localeProp.getPossibleValues();
    GwtLocale newCompileLocale=factory.fromString(localeName);
    if (newCompileLocale.equals(compileLocale)) {
      return;
    }
    compileLocale=newCompileLocale;
    allLocales.clear();
    allCompileLocales.clear();
    runtimeLocales.clear();
    for (    String localeValue : localeValues) {
      allCompileLocales.add(factory.fromString(localeValue));
    }
    allLocales.addAll(allCompileLocales);
    ConfigurationProperty prop=propertyOracle.getConfigurationProperty(PROP_RUNTIME_LOCALES);
    List<String> rtLocaleNames=prop.getValues();
    if (rtLocaleNames != null) {
      for (      String rtLocale : rtLocaleNames) {
        GwtLocale locale=factory.fromString(rtLocale);
        existingLocales:         for (        GwtLocale existing : allCompileLocales) {
          for (          GwtLocale alias : existing.getAliases()) {
            if (!alias.isDefault() && locale.inheritsFrom(alias) && locale.usesSameScript(alias)) {
              allLocales.add(locale);
              break existingLocales;
            }
          }
        }
        if (!compileLocale.isDefault() && locale.inheritsFrom(compileLocale) && locale.usesSameScript(compileLocale)) {
          runtimeLocales.add(locale);
        }
      }
    }
  }
 catch (  BadPropertyValueException e) {
    logger.log(TreeLogger.TRACE,"Unable to get locale properties, using defaults",e);
    compileLocale=factory.fromString("default");
    allLocales.add(compileLocale);
    return;
  }
}
