{
  if (beforeIndex != getColumnCount()) {
    checkColumnBounds(beforeIndex);
  }
  headers.add(beforeIndex,header);
  footers.add(beforeIndex,footer);
  columns.add(beforeIndex,col);
  boolean wasinteractive=isInteractive;
  coalesceCellProperties();
  if (!wasinteractive && isInteractive) {
    keyboardSelectedColumn=beforeIndex;
  }
  Set<String> consumedEvents=new HashSet<String>();
{
    Set<String> cellEvents=col.getCell().getConsumedEvents();
    if (cellEvents != null) {
      consumedEvents.addAll(cellEvents);
    }
  }
  if (header != null) {
    Set<String> headerEvents=header.getCell().getConsumedEvents();
    if (headerEvents != null) {
      consumedEvents.addAll(headerEvents);
    }
  }
  if (footer != null) {
    Set<String> footerEvents=footer.getCell().getConsumedEvents();
    if (footerEvents != null) {
      consumedEvents.addAll(footerEvents);
    }
  }
  CellBasedWidgetImpl.get().sinkEvents(this,consumedEvents);
  redraw();
}
