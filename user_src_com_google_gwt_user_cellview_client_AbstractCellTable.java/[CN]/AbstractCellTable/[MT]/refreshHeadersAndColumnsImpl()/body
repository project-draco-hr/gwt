{
  if (columnWidthsDirty) {
    columnWidthsDirty=false;
    refreshColumnWidths();
  }
  boolean wereHeadersDirty=headersDirty;
  headersDirty=false;
  if (wereHeadersDirty || !headerRefreshDisabled) {
    createHeaders(false);
  }
  if (wereHeadersDirty || !footerRefreshDisabled) {
    createHeaders(true);
  }
}
