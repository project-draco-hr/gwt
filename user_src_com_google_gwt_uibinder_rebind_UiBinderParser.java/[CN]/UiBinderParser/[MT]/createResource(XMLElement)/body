{
  String resourceName=elem.consumeRequiredAttribute("field");
  JClassType resourceType=consumeTypeAttribute(elem);
  if (elem.getAttributeCount() > 0) {
    writer.die("In %s, should only find attributes \"field\" and \"type\"",elem);
  }
  FieldWriter fieldWriter=fieldManager.registerField(resourceType,resourceName);
  OwnerField ownerField=writer.getOwnerClass().getUiField(resourceName);
  if (ownerField != null) {
    if (!resourceType.equals(ownerField.getType().getRawType())) {
      writer.die("In %s, type must match %s",elem,ownerField);
    }
    if (ownerField.isProvided()) {
      fieldWriter.setInitializer("owner." + ownerField.getName());
      return;
    }
  }
  JMethod factoryMethod=writer.getOwnerClass().getUiFactoryMethod(resourceType);
  if (factoryMethod != null) {
    fieldWriter.setInitializer(String.format("owner.%s()",factoryMethod.getName()));
  }
}
