{
  String typeName=packageName + "." + simpleTypeName;
  JClassType existingType=getTypeOracle().findType(packageName,simpleTypeName);
  if (existingType != null) {
    logger.log(TreeLogger.DEBUG,"Type '" + typeName + "' already exists and will not be re-created ",null);
    return null;
  }
  if (newlyGeneratedTypeNames.contains(typeName)) {
    final String msg="A request to create type '" + typeName + "' was received while the type itself was being created; this might be a generator or configuration bug";
    logger.log(TreeLogger.WARN,msg,null);
    return null;
  }
  String qualifiedSourceName;
  if (packageName.length() == 0) {
    qualifiedSourceName=simpleTypeName;
  }
 else {
    qualifiedSourceName=packageName + '.' + simpleTypeName;
  }
  GeneratedUnitWithFile gcup=new GeneratedUnitWithFile(qualifiedSourceName);
  uncommittedGeneratedCupsByPrintWriter.put(gcup.pw,gcup);
  newlyGeneratedTypeNames.add(typeName);
  return gcup.pw;
}
