{
  if (genDir == null) {
    return cup;
  }
  if (Util.isCompilationUnitOnDisk(cup.getLocation())) {
    return cup;
  }
  String typeName=cup.getPackageName() + "." + simpleTypeName;
  String relativePath=typeName.replace('.','/') + ".java";
  File srcFile=new File(genDir,relativePath);
  Util.writeCharsAsFile(logger,srcFile,cup.getSource());
  Throwable caught=null;
  try {
    URL fileURL=srcFile.toURL();
    URLCompilationUnitProvider fileBaseCup=new GeneratedCUP(fileURL,cup.getPackageName());
    return fileBaseCup;
  }
 catch (  MalformedURLException e) {
    caught=e;
  }
  logger.log(TreeLogger.ERROR,"Internal error: cannot build URL from synthesized file name '" + srcFile.getAbsolutePath() + "'",caught);
  throw new UnableToCompleteException();
}
