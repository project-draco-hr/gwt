{
  PendingResource pendingResource=pendingResourcesByOutputStream.get(os);
  if (pendingResource != null) {
    pendingResource.commit(logger);
    cacheManager.addGeneratedResource(pendingResource.getPartialPath());
    GeneratedResource toReturn;
    try {
      toReturn=new StandardGeneratedResource(currentGenerator,pendingResource.getPartialPath(),pendingResource.getFile().toURL());
      commitArtifact(logger,toReturn);
      pendingResourcesByOutputStream.remove(os);
      return toReturn;
    }
 catch (    MalformedURLException e) {
      logger.log(TreeLogger.ERROR,"Unable to commit artifact",e);
      throw new UnableToCompleteException();
    }
  }
 else {
    logger.log(TreeLogger.WARN,"Generator attempted to commit an unknown OutputStream",null);
    throw new UnableToCompleteException();
  }
}
