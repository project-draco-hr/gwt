{
  String matchingPrefix=findMatchingPrefix(systemId);
  Resource resource=null;
  Map<String,Resource> map=resourceOracle.getResourceMap();
  if (matchingPrefix != null) {
    resource=map.get(RESOURCES + systemId.substring(matchingPrefix.length()));
  }
  if (resource == null) {
    resource=map.get(pathBase + systemId);
  }
  if (resource != null) {
    String content;
    try {
      InputStream resourceStream=resource.openContents();
      content=Util.readStreamAsString(resourceStream);
    }
 catch (    IOException ex) {
      logger.log(TreeLogger.ERROR,"Error reading resource: " + resource.getLocation());
      throw new RuntimeException(ex);
    }
    InputSource inputSource=new InputSource(new StringReader(content));
    inputSource.setPublicId(publicId);
    inputSource.setSystemId(resource.getPath());
    return inputSource;
  }
  return null;
}
