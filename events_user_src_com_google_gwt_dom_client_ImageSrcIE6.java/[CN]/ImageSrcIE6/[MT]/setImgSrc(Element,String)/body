{
  if (getImgSrc(img).equals(src)) {
    return;
  }
  if (srcImgMap == null) {
    srcImgMap=JavaScriptObject.createObject();
  }
  String oldSrc=getPendingSrc(img);
  if (oldSrc != null) {
    Element top=getTop(srcImgMap,oldSrc);
    assert(top != null);
    if (top.equals(img)) {
      removeTop(srcImgMap,top);
    }
 else {
      removeChild(top,img);
    }
  }
  Element top=getTop(srcImgMap,src);
  if (top == null) {
    addTop(srcImgMap,img,src);
  }
 else {
    addChild(top,img);
  }
}
