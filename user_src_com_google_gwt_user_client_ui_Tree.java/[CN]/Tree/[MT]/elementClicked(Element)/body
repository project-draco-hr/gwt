{
  ArrayList<Element> chain=new ArrayList<Element>();
  collectElementChain(chain,getElement(),hElem);
  TreeItem item=findItemByChain(chain,0,root);
  if (item != null && item != root) {
    if (item.getChildCount() > 0 && item.getImageElement().isOrHasChild(hElem)) {
      item.setState(!item.getState(),true);
      return true;
    }
 else     if (item.getElement().isOrHasChild(hElem)) {
      onSelection(item,true,!shouldTreeDelegateFocusToElement(hElem));
      return true;
    }
  }
  return false;
}
