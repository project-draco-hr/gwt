{
  TreeItem topClosedParent=getTopClosedParent(sel);
  if (topClosedParent != null) {
    onSelection(topClosedParent,true,true);
    return;
  }
  TreeItem parent=sel.getParentItem();
  if (parent == null) {
    parent=root;
  }
  int idx=parent.getChildIndex(sel);
  if (idx > 0) {
    TreeItem sibling=parent.getChild(idx - 1);
    onSelection(findDeepestOpenChild(sibling),true,true);
  }
 else {
    onSelection(parent,true,true);
  }
}
