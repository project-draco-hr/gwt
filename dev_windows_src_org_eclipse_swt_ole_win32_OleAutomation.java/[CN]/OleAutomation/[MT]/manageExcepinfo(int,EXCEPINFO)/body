{
  if (hResult >= COM.S_OK) {
    exceptionDescription="No Error";
    return;
  }
  if (hResult == COM.DISP_E_EXCEPTION) {
    if (excepInfo.bstrDescription != 0) {
      int size=COM.SysStringByteLen(excepInfo.bstrDescription);
      char[] buffer=new char[(size + 1) / 2];
      COM.MoveMemory(buffer,excepInfo.bstrDescription,size);
      exceptionDescription=new String(buffer);
    }
 else {
      exceptionDescription="OLE Automation Error Exception ";
      if (excepInfo.wCode != 0) {
        exceptionDescription+="code = " + excepInfo.wCode;
      }
 else       if (excepInfo.scode != 0) {
        exceptionDescription+="code = " + excepInfo.scode;
      }
    }
  }
 else {
    exceptionDescription="OLE Automation Error HResult : " + hResult;
  }
  if (excepInfo.bstrDescription != 0)   COM.SysFreeString(excepInfo.bstrDescription);
  if (excepInfo.bstrHelpFile != 0)   COM.SysFreeString(excepInfo.bstrHelpFile);
  if (excepInfo.bstrSource != 0)   COM.SysFreeString(excepInfo.bstrSource);
}
