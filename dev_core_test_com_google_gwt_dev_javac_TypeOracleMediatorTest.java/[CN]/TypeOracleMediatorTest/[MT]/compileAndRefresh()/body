{
  TreeLogger logger=createTreeLogger();
  CompilationUnitInvalidator.invalidateUnitsWithInvalidRefs(logger,units);
  JdtCompiler.compile(units);
  if (CompilationUnitInvalidator.invalidateUnitsWithErrors(logger,units)) {
    CompilationUnitInvalidator.invalidateUnitsWithInvalidRefs(logger,units);
  }
  mediator.refresh(logger,units);
  checkTypes(typeOracle.getTypes());
}
