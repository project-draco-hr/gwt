{
  String internalName=BinaryName.toInternalName(type.getName());
  Map<String,CompiledClass> compiledClassesByInternalName=rpo.getCompilationState().getClassFileMap();
  if (compiledClassesByInternalName.containsKey(internalName)) {
    CompiledClass compiledClass=compiledClassesByInternalName.get(internalName);
    return compiledClass.getUnit().getTypeByName(type.getName());
  }
  CompilationUnit compilationUnit=compilerContext.getLibraryGroup().getCompilationUnitByTypeBinaryName(type.getName());
  if (compilationUnit != null) {
    compilerContext.getUnitCache().add(compilationUnit);
    return compilationUnit.getTypeByName(type.getName());
  }
  return type;
}
