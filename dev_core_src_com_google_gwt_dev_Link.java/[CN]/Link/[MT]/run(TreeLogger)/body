{
  loop_modules:   for (  String moduleName : options.getModuleNames()) {
    ModuleDef module=ModuleDefLoader.loadFromClassPath(logger,moduleName,compilerContext);
    File compilerWorkDir=options.getCompilerWorkDir(moduleName);
    PrecompileTaskOptions precompileOptions=AnalyzeModule.readAnalyzeModuleOptionsFile(logger,compilerWorkDir);
    PrecompilationResult precompileResults=null;
    if (precompileOptions == null) {
      File precompilationFile=new File(compilerWorkDir,Precompile.PRECOMPILE_FILENAME);
      precompileResults=CompilePerms.readPrecompilationFile(logger,precompilationFile);
      if (precompileResults == null) {
        return false;
      }
      if (precompileResults instanceof PrecompileTaskOptions) {
        precompileOptions=(PrecompileTaskOptions)precompileResults;
      }
    }
    if (precompileOptions != null) {
      if (!doLinkFinal(logger,compilerWorkDir,module,precompileOptions)) {
        return false;
      }
      continue loop_modules;
    }
 else {
      Precompilation precomp=(Precompilation)precompileResults;
      Permutation[] perms=precomp.getPermutations();
      List<FileBackedObject<PermutationResult>> resultFiles=CompilePerms.makeResultFiles(compilerWorkDir,perms);
      for (      FileBackedObject<PermutationResult> file : resultFiles) {
        if (!file.getFile().exists()) {
          logger.log(TreeLogger.ERROR,"File not found '" + file.getFile().getAbsolutePath() + "'; please compile all permutations");
          return false;
        }
      }
      TreeLogger branch=logger.branch(TreeLogger.INFO,"Linking module " + module.getName());
      try {
        link(branch,module,precomp.getGeneratedArtifacts(),perms,resultFiles,precomp.getUnifiedAst().getOptions(),options);
      }
 catch (      IOException e) {
        logger.log(TreeLogger.ERROR,"Unexpected exception while producing output",e);
        throw new UnableToCompleteException();
      }
    }
  }
  return true;
}
