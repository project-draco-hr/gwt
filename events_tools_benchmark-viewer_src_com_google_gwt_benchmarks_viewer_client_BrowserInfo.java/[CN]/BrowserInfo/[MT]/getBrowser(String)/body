{
  userAgent=userAgent.toLowerCase();
  boolean isGecko=userAgent.indexOf("gecko") != -1 && userAgent.indexOf("safari") == -1;
  boolean isAppleWebKit=userAgent.indexOf("applewebkit") != -1;
  boolean isKonqueror=userAgent.indexOf("konqueror") != -1;
  boolean isSafari=userAgent.indexOf("safari") != -1;
  boolean isOmniweb=userAgent.indexOf("omniweb") != -1;
  boolean isOpera=userAgent.indexOf("opera") != -1;
  boolean isIcab=userAgent.indexOf("icab") != -1;
  boolean isAol=userAgent.indexOf("aol") != -1;
  boolean isIE=userAgent.indexOf("msie") != -1 && !isOpera && (userAgent.indexOf("webtv") == -1);
  boolean isMozilla=isGecko && userAgent.indexOf("gecko/") + 14 == userAgent.length();
  boolean isFirefox=userAgent.indexOf("firefox/") != -1 || userAgent.indexOf("firebird/") != -1;
  boolean isNS=isGecko ? userAgent.indexOf("netscape") != -1 : userAgent.indexOf("mozilla") != -1 && !isOpera && !isSafari && userAgent.indexOf("spoofer") == -1 && userAgent.indexOf("compatible") == -1 && userAgent.indexOf("webtv") == -1 && userAgent.indexOf("hotjava") == -1;
  boolean isIECompatible=userAgent.indexOf("msie") != -1 && !isIE;
  boolean isNSCompatible=userAgent.indexOf("mozilla") != -1 && !isNS && !isMozilla;
  String geckoVersion=isGecko ? userAgent.substring(userAgent.lastIndexOf("gecko/") + 6,userAgent.lastIndexOf("gecko/") + 14) : "-1";
  String equivalentMozilla=isGecko ? userAgent.substring(userAgent.indexOf("rv:") + 3) : "-1";
  String appleWebKitVersion=isAppleWebKit ? userAgent.substring(userAgent.indexOf("applewebkit/") + 12) : "-1";
  String versionMinor="";
  if (isGecko && !isMozilla) {
    versionMinor=userAgent.substring(userAgent.indexOf("/",userAgent.indexOf("gecko/") + 6) + 1);
  }
 else   if (isMozilla) {
    versionMinor=userAgent.substring(userAgent.indexOf("rv:") + 3);
  }
 else   if (isIE) {
    versionMinor=userAgent.substring(userAgent.indexOf("msie ") + 5);
  }
 else   if (isKonqueror) {
    versionMinor=userAgent.substring(userAgent.indexOf("konqueror/") + 10);
  }
 else   if (isSafari) {
    versionMinor=userAgent.substring(userAgent.lastIndexOf("safari/") + 7);
  }
 else   if (isOmniweb) {
    versionMinor=userAgent.substring(userAgent.lastIndexOf("omniweb/") + 8);
  }
 else   if (isOpera) {
    versionMinor=userAgent.substring(userAgent.indexOf("opera") + 6);
  }
 else   if (isIcab) {
    versionMinor=userAgent.substring(userAgent.indexOf("icab") + 5);
  }
  String version=getVersion(versionMinor);
  boolean isWin=userAgent.indexOf("win") != -1;
  boolean isWin32=isWin && userAgent.indexOf("95") != -1 || userAgent.indexOf("98") != -1 || userAgent.indexOf("nt") != -1 || userAgent.indexOf("win32") != -1 || userAgent.indexOf("32bit") != -1 || userAgent.indexOf("xp") != -1;
  boolean isMac=userAgent.indexOf("mac") != -1;
  boolean isUnix=userAgent.indexOf("unix") != -1 || userAgent.indexOf("sunos") != -1 || userAgent.indexOf("bsd") != -1 || userAgent.indexOf("x11") != -1;
  boolean isLinux=userAgent.indexOf("linux") != -1;
  String name=isGecko ? "Gecko" : isAppleWebKit ? "Apple WebKit" : isKonqueror ? "Konqueror" : isSafari ? "Safari" : isOpera ? "Opera" : isIE ? "IE" : isMozilla ? "Mozilla" : isFirefox ? "Firefox" : isNS ? "Netscape" : "";
  name+=" " + version + " on "+ (isWin ? "Windows" : isMac ? "Mac" : isUnix ? "Unix" : isLinux ? "Linux" : "Unknown");
  return name;
}
