{
  if (referencedCompilationUnit.isError()) {
    if (failedUnits.add(referencedCompilationUnit) && reportErrors) {
      CompilationProblemReporter.logErrorTrace(logger,TreeLogger.ERROR,compilerContext,referencedCompilationUnit.getTypeName(),true);
      errorsFound=true;
    }
    return;
  }
  compilerContext.getUnitCache().add(referencedCompilationUnit);
  compilationState.addReferencedCompilationUnits(logger,Lists.create(referencedCompilationUnit));
  List<JDeclaredType> types=referencedCompilationUnit.getTypes();
  for (  JDeclaredType referenceOnlyType : types) {
    program.addType(referenceOnlyType);
    program.addReferenceOnlyType(referenceOnlyType);
  }
  for (  JDeclaredType referenceOnlyType : types) {
    resolveType(referenceOnlyType);
  }
}
