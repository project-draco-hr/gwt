{
  for (  JDeclaredType type : program.getDeclaredTypes()) {
    for (int fieldIndex=0; fieldIndex < type.getFields().size(); ++fieldIndex) {
      JField field=type.getFields().get(fieldIndex);
      if (!liveFieldsAndMethods.contains(field)) {
        type.removeField(fieldIndex);
        --fieldIndex;
      }
    }
    JMethod clinit=type.getClinitMethod();
    if (!liveFieldsAndMethods.contains(clinit)) {
      clinit.setBody(new JMethodBody(SourceOrigin.UNKNOWN));
    }
    for (int methodIndex=1; methodIndex < type.getMethods().size(); ++methodIndex) {
      JMethod method=type.getMethods().get(methodIndex);
      if (!liveFieldsAndMethods.contains(method)) {
        type.removeMethod(methodIndex);
        --methodIndex;
      }
    }
  }
}
