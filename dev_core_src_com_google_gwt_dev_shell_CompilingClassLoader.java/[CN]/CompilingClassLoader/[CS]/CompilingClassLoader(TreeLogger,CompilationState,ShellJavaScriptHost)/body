{
  super(null);
  this.logger=logger;
  this.compilationState=compilationState;
  this.shellJavaScriptHost=javaScriptHost;
  this.typeOracle=compilationState.getTypeOracle();
  setDefaultAssertionStatus(true);
  ensureJavaScriptHostBytes(logger);
  JClassType jsoType=typeOracle.findType(JsValueGlue.JSO_CLASS);
  if (jsoType != null) {
    Set<JClassType> jsoTypes=new HashSet<JClassType>();
    JClassType[] jsoSubtypes=jsoType.getSubtypes();
    Collections.addAll(jsoTypes,jsoSubtypes);
    jsoTypes.add(jsoType);
    Set<String> jsoTypeNames=new HashSet<String>();
    Map<String,String> jsoSuperTypes=new HashMap<String,String>();
    for (    JClassType type : jsoTypes) {
      String binaryName=getBinaryName(type);
      jsoTypeNames.add(binaryName);
      jsoSuperTypes.put(binaryName,getBinaryName(type.getSuperclass()));
    }
    MyInstanceMethodOracle mapper=new MyInstanceMethodOracle(jsoTypes,typeOracle.getJavaLangObject());
    classRewriter=new HostedModeClassRewriter(jsoTypeNames,jsoSuperTypes,mapper);
  }
 else {
    classRewriter=null;
  }
}
