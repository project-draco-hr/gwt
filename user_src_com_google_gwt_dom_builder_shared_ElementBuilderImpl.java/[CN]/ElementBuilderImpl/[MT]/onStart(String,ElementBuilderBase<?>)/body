{
  if (isEmpty) {
    isEmpty=false;
  }
 else   if (stack.isEmpty()) {
    throw new IllegalStateException("You can only build one top level element.");
  }
 else {
    assertEndTagNotForbidden("child elements");
    if (!getCurrentBuilder().isChildElementSupported()) {
      throw new UnsupportedOperationException(getCurrentTagName() + " does not support child elements.");
    }
  }
  if (isHtmlOrTextAdded) {
    throw new IllegalStateException("Cannot append an element after setting text of html.");
  }
  assertValidTagName(tagName);
  maybeCloseStartTag();
  stack.push(builder,tagName);
  isStartTagOpen=true;
  isStyleOpen=false;
  isStyleClosed=false;
  isHtmlOrTextAdded=false;
}
