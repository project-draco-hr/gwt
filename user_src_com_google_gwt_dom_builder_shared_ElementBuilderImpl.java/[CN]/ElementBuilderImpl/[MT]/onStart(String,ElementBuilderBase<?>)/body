{
  if (isEmpty) {
    isEmpty=false;
  }
 else   if (stackTags.size() == 0) {
    throw new IllegalStateException("You can only build one top level element.");
  }
 else {
    assertEndTagNotForbidden(getCurrentTagName() + " does not support child elements.");
    if (!builder.isChildElementSupported()) {
      throw new UnsupportedOperationException(getCurrentTagName() + " does not support child elements.");
    }
  }
  if (isHtmlOrTextAdded) {
    throw new IllegalStateException("Cannot append an element after setting text of html.");
  }
  assertValidTagName(tagName);
  maybeCloseStartTag();
  stackTags.add(tagName);
  stackBuilders.add(builder);
  isStartTagOpen=true;
  isStyleOpen=false;
  isStyleClosed=false;
  isHtmlOrTextAdded=false;
}
