{
  RemoteServiceServletTestServiceAsync service=getAsyncService();
  ((ServiceDefTarget)service).setRpcRequestBuilder(new RpcRequestBuilder(){
    /** 
 * Copied from base class.
 */
    @Override protected void doFinish(    RequestBuilder rb){
      rb.setHeader(MODULE_BASE_HEADER,GWT.getModuleBaseURL());
    }
  }
);
  delayTestFinishForRpc();
  service.test(new AsyncCallback<Void>(){
    @Override public void onFailure(    Throwable caught){
      assertTrue(caught instanceof StatusCodeException);
      assertEquals(500,((StatusCodeException)caught).getStatusCode());
      finishTest();
    }
    @Override public void onSuccess(    Void result){
      fail();
    }
  }
);
}
