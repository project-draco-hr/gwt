{
  assertEquals(expectedException,error.getExceptionType());
  if (expectedException != null) {
    assertFalse(error.getStackTraceString().length() == 0);
    assertEquals("THIS EXCEPTION IS EXPECTED BY A TEST",error.getMessage());
  }
 else {
    assertEquals(null,error.getStackTraceString());
    assertEquals("Server Error: THIS EXCEPTION IS EXPECTED BY A TEST",error.getMessage());
  }
  mutableFoo.setPleaseCrash(24);
  persistRequest.fire(new Receiver<SimpleFooProxy>(){
    @Override public void onSuccess(    SimpleFooProxy response){
      response=checkSerialization(response);
      finishTestAndReset();
    }
  }
);
}
