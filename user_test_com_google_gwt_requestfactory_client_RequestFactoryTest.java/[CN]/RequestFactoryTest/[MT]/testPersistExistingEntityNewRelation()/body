{
  delayTestFinish(5000);
  SimpleBarProxy newBar=req.create(SimpleBarProxy.class);
  final RequestObject<Void> barReq=req.simpleBarRequest().persist(newBar);
  newBar=barReq.edit(newBar);
  newBar.setUserName("Amit");
  final SimpleBarProxy finalNewBar=newBar;
  req.simpleFooRequest().findSimpleFooById(999L).fire(new Receiver<SimpleFooProxy>(){
    @Override public void onSuccess(    SimpleFooProxy response){
      RequestObject<Void> fooReq=req.simpleFooRequest().persist(response);
      response=fooReq.edit(response);
      response.setBarField(finalNewBar);
      fooReq.fire(new Receiver<Void>(){
        @Override public void onSuccess(        Void response){
          req.simpleFooRequest().findSimpleFooById(999L).with("barField.userName").fire(new Receiver<SimpleFooProxy>(){
            @Override public void onSuccess(            SimpleFooProxy finalFooProxy){
              assertEquals("FOO",finalFooProxy.getBarField().getUserName());
              finishTestAndReset();
            }
          }
);
        }
      }
);
    }
  }
);
}
