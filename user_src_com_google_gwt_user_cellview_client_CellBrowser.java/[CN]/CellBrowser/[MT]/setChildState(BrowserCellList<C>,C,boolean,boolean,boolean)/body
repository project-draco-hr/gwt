{
  if (isLeaf(value)) {
    return null;
  }
  Object newKey=cellList.getValueKey(value);
  if (open) {
    if (newKey == null) {
      return null;
    }
 else     if (newKey.equals(cellList.openKey)) {
      return treeNodes.get(cellList.level + 1);
    }
    if (cellList.openKey != null) {
      setChildState(cellList,cellList.openValue,false,fireEvents,false);
    }
    NodeInfo<?> childNodeInfo=getNodeInfo(value);
    if (childNodeInfo == null) {
      return null;
    }
    cellList.openValue=value;
    cellList.openKey=cellList.getValueKey(value);
    appendTreeNode(childNodeInfo,value);
    if (redraw) {
      treeNodes.get(cellList.level).display.redraw();
    }
    if (fireEvents) {
      OpenEvent.fire(this,treeNodes.get(cellList.level + 1));
    }
    return treeNodes.get(cellList.level + 1);
  }
 else {
    if (cellList.openKey == null || !cellList.openKey.equals(newKey)) {
      return null;
    }
    TreeNode closedNode=treeNodes.get(cellList.level + 1);
    trimToLevel(cellList.level);
    cellList.openKey=null;
    cellList.openValue=null;
    if (redraw) {
      treeNodes.get(cellList.level).display.redraw();
    }
    if (fireEvents) {
      CloseEvent.fire(this,closedNode);
    }
  }
  return null;
}
