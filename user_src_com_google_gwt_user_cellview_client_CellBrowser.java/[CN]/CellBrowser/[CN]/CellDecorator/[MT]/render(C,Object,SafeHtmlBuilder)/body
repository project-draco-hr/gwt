{
  boolean isOpen=(openKey == null) ? false : openKey.equals(getValueKey(value));
  boolean isSelected=(selectionModel == null) ? false : selectionModel.isSelected(value);
  StringBuilder classesBuilder=new StringBuilder();
  classesBuilder.append(style.item());
  if (isOpen) {
    classesBuilder.append(" ").append(style.openItem());
  }
  if (isSelected) {
    classesBuilder.append(" ").append(style.selectedItem());
  }
  String classes=classesBuilder.toString();
  SafeHtml image;
  if (isOpen) {
    image=openImageHtml;
  }
 else   if (isLeaf(value)) {
    image=LEAF_IMAGE;
  }
 else {
    image=closedImageHtml;
  }
  SafeHtmlBuilder cellBuilder=new SafeHtmlBuilder();
  cell.render(value,viewData,cellBuilder);
  sb.append(template.div(imageWidth,classes,image,cellBuilder.toSafeHtml()));
}
