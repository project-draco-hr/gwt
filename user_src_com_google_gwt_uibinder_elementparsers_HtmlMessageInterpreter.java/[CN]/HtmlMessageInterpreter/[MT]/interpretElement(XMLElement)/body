{
  MessagesWriter messages=uiWriter.getMessages();
  if (messages.isMessage(elem)) {
    if (!elem.hasChildNodes()) {
      uiWriter.die(elem,"Empty message");
    }
    MessageWriter message=messages.newMessage(elem);
    message.setDefaultMessage(elem.consumeInnerHtml(phiProvider.get(message)));
    return uiWriter.tokenForSafeHtmlExpression(messages.declareMessage(message));
  }
  return null;
}
