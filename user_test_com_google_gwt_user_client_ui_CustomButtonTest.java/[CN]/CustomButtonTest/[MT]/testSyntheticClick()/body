{
  ToggleButton b=new ToggleButton();
  final ArrayList<String> events=new ArrayList<String>();
  Handler h=new Handler();
  b.addClickHandler(new ClickHandler(){
    @Override public void onClick(    ClickEvent event){
      events.add(event.getNativeEvent().getType());
    }
  }
);
  b.addValueChangeHandler(h);
  RootPanel.get().add(b);
  b.getElement().dispatchEvent(Document.get().createMouseOverEvent(1,0,0,0,0,false,false,false,false,Event.BUTTON_LEFT,null));
  b.getElement().dispatchEvent(Document.get().createMouseDownEvent(1,0,0,0,0,false,false,false,false,Event.BUTTON_LEFT));
  b.getElement().dispatchEvent(Document.get().createMouseUpEvent(1,0,0,0,0,false,false,false,false,Event.BUTTON_LEFT));
  assertEquals("Expecting one click event",1,events.size());
  assertEquals("Expecting one click event","click",events.get(0));
  assertNotNull("Expecting a value change event",h.received);
}
