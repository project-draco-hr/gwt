{
  File rootDirectory=Files.createTempDir();
  File subDirectory=createDirectoryIn("subdir",rootDirectory);
  File originalFile=createFileIn("SomeFile.java",subDirectory);
  ChangedFileAccumulator changedFileAccumulator=new ChangedFileAccumulator(rootDirectory.toPath());
  assertTrue(changedFileAccumulator.getAndClearChangedFiles().isEmpty());
  originalFile.delete();
  waitForFileEvents();
  List<File> modifiedFiles=changedFileAccumulator.getAndClearChangedFiles();
  assertEquals(1,modifiedFiles.size());
  assertTrue(modifiedFiles.get(0).getPath().endsWith("SomeFile.java"));
  changedFileAccumulator.shutdown();
}
