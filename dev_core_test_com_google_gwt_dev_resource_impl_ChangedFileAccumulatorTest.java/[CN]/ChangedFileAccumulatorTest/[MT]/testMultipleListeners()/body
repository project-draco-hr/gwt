{
  File rootDirectory=Files.createTempDir();
  File subDirectory=createDirectoryIn("subdir",rootDirectory);
  ChangedFileAccumulator changedFileAccumulator1=new ChangedFileAccumulator(rootDirectory.toPath());
  ChangedFileAccumulator changedFileAccumulator2=new ChangedFileAccumulator(rootDirectory.toPath());
  assertTrue(changedFileAccumulator1.getAndClearChangedFiles().isEmpty());
  assertTrue(changedFileAccumulator2.getAndClearChangedFiles().isEmpty());
  createFileIn("New.java",subDirectory);
  waitForFileEvents();
  List<File> modifiedFiles1=changedFileAccumulator1.getAndClearChangedFiles();
  assertEquals(1,modifiedFiles1.size());
  assertTrue(modifiedFiles1.get(0).getPath().endsWith("New.java"));
  List<File> modifiedFiles2=changedFileAccumulator2.getAndClearChangedFiles();
  assertEquals(1,modifiedFiles2.size());
  assertTrue(modifiedFiles2.get(0).getPath().endsWith("New.java"));
  changedFileAccumulator1.shutdown();
  changedFileAccumulator2.shutdown();
}
