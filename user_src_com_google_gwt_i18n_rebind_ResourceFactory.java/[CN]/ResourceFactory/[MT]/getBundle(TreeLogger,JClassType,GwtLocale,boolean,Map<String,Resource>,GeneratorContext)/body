{
  List<GwtLocale> locales=bundleLocale.getCompleteSearchList();
  List<JClassType> classes=new ArrayList<JClassType>();
  Set<JClassType> seenClasses=new IdentityHashSet<JClassType>();
  Map<ClassLocale,AnnotationsResource> annotations=new HashMap<ClassLocale,AnnotationsResource>();
  GwtLocaleFactory factory=LocaleUtils.getLocaleFactory();
  GwtLocale defaultLocale=factory.getDefault();
  walkInheritanceTree(logger,topClass,factory,defaultLocale,classes,annotations,seenClasses,isConstants);
  ResourceList allResources=new ResourceList();
  ResourceFactoryContext localizableCtx=getResourceFactoryContext(genCtx);
  for (  GwtLocale locale : locales) {
    for (    JClassType clazz : classes) {
      ClassLocale key=new ClassLocale(clazz,locale);
      ResourceList resources;
      resources=localizableCtx.getResourceList(key);
      if (resources == null) {
        resources=new ResourceList();
        addFileResources(logger,clazz,locale,resourceMap,resources);
        AnnotationsResource annotationsResource=annotations.get(key);
        if (annotationsResource != null) {
          resources.add(annotationsResource);
        }
        localizableCtx.putResourceList(key,resources);
      }
      allResources.addAll(resources);
    }
  }
  String className=topClass.getQualifiedSourceName();
  TreeLogger branch=logger.branch(TreeLogger.SPAM,"Resource search order for " + className + ", locale "+ bundleLocale);
  if (logger.isLoggable(TreeLogger.SPAM)) {
    for (    AbstractResource resource : allResources) {
      branch.log(TreeLogger.SPAM,resource.toString());
    }
  }
  return allResources;
}
