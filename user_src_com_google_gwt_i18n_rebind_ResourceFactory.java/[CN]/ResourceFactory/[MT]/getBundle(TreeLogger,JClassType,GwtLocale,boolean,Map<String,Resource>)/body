{
  List<GwtLocale> locales=bundleLocale.getCompleteSearchList();
  List<JClassType> classes=new ArrayList<JClassType>();
  Set<JClassType> seenClasses=new IdentityHashSet<JClassType>();
  Map<ClassLocale,AnnotationsResource> annotations=new HashMap<ClassLocale,AnnotationsResource>();
  GwtLocaleFactory factory=LocaleUtils.getLocaleFactory();
  GwtLocale defaultLocale=factory.getDefault();
  walkInheritanceTree(logger,topClass,factory,defaultLocale,classes,annotations,seenClasses,isConstants);
  ResourceList allResources=new ResourceList();
  for (  GwtLocale locale : locales) {
    for (    JClassType clazz : classes) {
      ClassLocale key=new ClassLocale(clazz,locale);
      ResourceList resources;
      if (cache.containsKey(key)) {
        resources=cache.get(key);
      }
 else {
        cache.put(key,null);
        resources=new ResourceList();
        addFileResources(clazz,locale,resourceMap,resources);
        AnnotationsResource annotationsResource=annotations.get(key);
        if (annotationsResource != null) {
          resources.add(annotationsResource);
        }
        cache.put(key,resources);
      }
      if (resources != null) {
        allResources.addAll(resources);
      }
    }
  }
  String className=topClass.getQualifiedSourceName();
  TreeLogger branch=logger.branch(TreeLogger.SPAM,"Resource search order for " + className + ", locale "+ bundleLocale);
  for (  AbstractResource resource : allResources) {
    branch.log(TreeLogger.SPAM,resource.toString());
  }
  return allResources;
}
