{
  if (type instanceof ParameterizedType) {
    ParameterizedType pType=(ParameterizedType)type;
    Class<?> rawType=(Class<?>)pType.getRawType();
    if (List.class.isAssignableFrom(rawType) || RequestObject.class.isAssignableFrom(rawType)) {
      Class<?> rType=getTypeArgument(pType);
      if (rType != null) {
        if (List.class.isAssignableFrom(rType)) {
          return getReturnTypeFromParameter(method,rType);
        }
        return rType;
      }
      throw new IllegalArgumentException("Bad or missing type arguments for " + "List return type on method " + method);
    }
 else     if (Set.class.isAssignableFrom(rawType) || RequestObject.class.isAssignableFrom(rawType)) {
      Class<?> rType=getTypeArgument(pType);
      if (rType != null) {
        if (Set.class.isAssignableFrom(rType)) {
          return getReturnTypeFromParameter(method,rType);
        }
        return rType;
      }
      throw new IllegalArgumentException("Bad or missing type arguments for " + "Set return type on method " + method);
    }
  }
 else {
    return (Class<?>)type;
  }
  return null;
}
