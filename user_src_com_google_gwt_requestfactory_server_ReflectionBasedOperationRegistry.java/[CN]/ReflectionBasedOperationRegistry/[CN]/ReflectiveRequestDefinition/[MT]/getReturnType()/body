{
  Class<?> domainReturnType=getReturnTypeFromParameter(domainMethod,domainMethod.getGenericReturnType());
  Class<?> requestReturnType=getReturnTypeFromParameter(requestMethod,requestMethod.getGenericReturnType());
  if (EntityProxy.class.isAssignableFrom(requestReturnType)) {
    ProxyFor annotation=requestReturnType.getAnnotation(ProxyFor.class);
    if (annotation != null) {
      Class<?> dtoClass=annotation.value();
      if (!dtoClass.equals(domainReturnType)) {
        throw new IllegalArgumentException("Type mismatch between " + domainMethod + " return type, and "+ requestReturnType+ "'s ProxyFor annotation "+ dtoClass);
      }
    }
 else {
      throw new IllegalArgumentException("Missing ProxyFor annotation on proxy type " + requestReturnType);
    }
    return requestReturnType;
  }
  return requestReturnType;
}
