{
class TestAttachHandler implements AttachEvent.Handler {
    int delegateAttachOrder;
    int delegateDetachOrder;
    public void onAttachOrDetach(    AttachEvent event){
      if (event.isAttached()) {
        delegateAttachOrder=++orderIndex;
      }
 else {
        delegateDetachOrder=++orderIndex;
      }
    }
  }
  TestPanel tp=new TestPanel();
  TestWidget tw=new TestWidget();
  TestAttachHandler ta=new TestAttachHandler();
  tw.addAttachHandler(ta);
  tp.add(tw);
  RootPanel.get().add(tp);
  RootPanel.get().remove(tp);
  assertTrue(tp.onAttachOrder < tp.onLoadOrder);
  assertTrue(tp.onDetachOrder < tp.onUnloadOrder);
  assertTrue(tw.onAttachOrder < tw.onLoadOrder);
  assertTrue(tw.onLoadOrder < ta.delegateAttachOrder);
  assertTrue(tw.onDetachOrder < tw.onUnloadOrder);
  assertTrue(tw.onUnloadOrder < ta.delegateDetachOrder);
  assertTrue(tp.onAttachOrder < tw.onAttachOrder);
  assertTrue(tp.onLoadOrder > tw.onLoadOrder);
  assertTrue(tp.onUnloadOrder < tw.onUnloadOrder);
  assertTrue(tp.domAttachedOnLoad);
  assertTrue(tp.domAttachedOnUnload);
  assertTrue(tw.domAttachedOnLoad);
  assertTrue(tw.domAttachedOnUnload);
}
