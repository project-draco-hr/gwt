{
  double speed=Math.abs(velocity);
  int numTimes=speed < 15 ? (speed < 3 ? 3 : 2) : 1;
  velocity*=Math.pow(DECELERATION_FACTOR,numTimes);
  double stretchDistance=0;
  if (offset < min) {
    stretchDistance=min - offset;
  }
 else   if (offset > max) {
    stretchDistance=max - offset;
  }
  if (stretchDistance != 0) {
    if (stretchDistance * velocity < 0) {
      bouncing=true;
      velocity+=stretchDistance * PRE_BOUNCE_COEFFICIENT;
    }
 else {
      bouncing=false;
      velocity=stretchDistance * POST_BOUNCE_COEFFICIENT;
    }
  }
  if (vertical) {
    this.velocity.y=velocity;
    bouncingY=bouncing;
  }
 else {
    this.velocity.x=velocity;
    bouncingX=bouncing;
  }
}
