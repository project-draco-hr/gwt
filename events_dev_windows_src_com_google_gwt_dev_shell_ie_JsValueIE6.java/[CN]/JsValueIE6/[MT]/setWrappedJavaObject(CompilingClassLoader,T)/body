{
  IDispatchImpl dispObj;
  if (val == null) {
    setNull();
    return;
  }
 else   if (val instanceof IDispatchImpl) {
    dispObj=(IDispatchImpl)val;
  }
 else {
    dispObj=(IDispatchImpl)cl.getWrapperForObject(val);
    if (dispObj == null || dispObj.refCount < 1) {
      dispObj=new IDispatchProxy(cl,val);
      cl.putWrapperForObject(val,dispObj);
    }
  }
  IDispatch disp=new IDispatch(dispObj.getAddress());
  disp.AddRef();
  setVariant(new Variant(disp));
}
