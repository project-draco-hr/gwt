{
  if (!enabled) {
    return dummyEvent;
  }
  if (data.length % 2 == 1) {
    throw new IllegalArgumentException("Unmatched data argument");
  }
  Stack<Event> threadPendingEvents=pendingEvents.get();
  Event parent=null;
  if (!threadPendingEvents.isEmpty()) {
    parent=threadPendingEvents.peek();
  }
 else {
    timeKeeper.resetTimeBase();
  }
  Event newEvent=new Event(parent,type,data);
  if (threadPendingEvents.size() == 0) {
    newEvent.addData("baseTime","" + timeKeeper.zeroTimeMillis());
  }
  threadPendingEvents.push(newEvent);
  return newEvent;
}
