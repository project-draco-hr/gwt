{
  fileLoggingEnabled=logFile != null;
  enabled=fileLoggingEnabled || DashboardNotifierFactory.areNotificationsEnabled();
  if (enabled) {
    if (fileLoggingEnabled) {
      Format format=Format.HTML;
      if (defaultFormatString != null) {
        for (        Format value : Format.values()) {
          if (value.name().equalsIgnoreCase(defaultFormatString)) {
            format=value;
            break;
          }
        }
      }
      outputFormat=format;
      eventsToWrite=openDefaultLogWriter();
      shutDownSentinel=new DummyEvent();
      flushSentinel=new DummyEvent();
      shutDownLatch=new CountDownLatch(1);
    }
    if (logGcTime) {
      gcMXBeans=ManagementFactory.getGarbageCollectorMXBeans();
      lastGcTimes=new ConcurrentHashMap<String,Long>();
    }
    pendingEvents=initPendingEvents();
  }
}
