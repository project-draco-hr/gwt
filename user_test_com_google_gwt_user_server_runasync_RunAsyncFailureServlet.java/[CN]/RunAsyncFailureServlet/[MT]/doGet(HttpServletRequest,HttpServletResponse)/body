{
  String originalUri=req.getRequestURI();
  debug("doGet Original: " + originalUri);
  String uri=originalUri.replace("/runAsyncFailure","");
  int response=getDesiredResponse(uri);
  RealContents rc=this.getRealContents(req,uri);
  String realContentsAsString=new String(rc.bytes);
  String fragment=uri.substring(uri.lastIndexOf('/') + 1);
  if (!realContentsAsString.contains("DOWNLOAD_FAILURE_TEST") || response == HttpServletResponse.SC_OK) {
    int bytes=0;
    if (!realContentsAsString.contains("INSTALL_FAILURE_TEST")) {
      OutputStream os=resp.getOutputStream();
      os.write(rc.bytes,0,rc.numBytes);
      bytes=rc.numBytes;
      os.close();
    }
    resp.setContentType("text/javascript");
    resp.setHeader("Cache-Control","no-cache");
    resp.setContentLength(bytes);
    resp.setStatus(HttpServletResponse.SC_OK);
    debug("doGet: served " + uri + " ("+ bytes+ " bytes)");
  }
 else {
    resp.setHeader("Cache-Control","no-cache");
    resp.sendError(response);
    debug("doGet: sent error " + response + " for "+ uri);
  }
}
