{
  if (!item.isEnabled()) {
    return;
  }
  selectItem(item);
  if (item != null) {
    if (fireCommand && item.getCommand() != null) {
      closeAllParents();
      final Command cmd=item.getCommand();
      Scheduler.get().scheduleFinally(new Scheduler.ScheduledCommand(){
        public void execute(){
          cmd.execute();
        }
      }
);
      if (shownChildMenu != null) {
        shownChildMenu.onHide(focus);
        popup.hide();
        shownChildMenu=null;
        selectItem(null);
      }
    }
 else     if (item.getSubMenu() != null) {
      if (shownChildMenu == null) {
        openPopup(item);
      }
 else       if (item.getSubMenu() != shownChildMenu) {
        shownChildMenu.onHide(focus);
        popup.hide();
        openPopup(item);
      }
 else       if (fireCommand && !autoOpen) {
        shownChildMenu.onHide(focus);
        popup.hide();
        shownChildMenu=null;
        selectItem(item);
      }
    }
 else     if (autoOpen && shownChildMenu != null) {
      shownChildMenu.onHide(focus);
      popup.hide();
      shownChildMenu=null;
    }
  }
}
