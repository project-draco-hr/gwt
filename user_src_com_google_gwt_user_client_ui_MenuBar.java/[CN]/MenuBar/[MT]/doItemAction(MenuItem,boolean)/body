{
  selectItem(item);
  if (item != null) {
    if (fireCommand && item.getCommand() != null) {
      closeAllParents();
      Command cmd=item.getCommand();
      DeferredCommand.addCommand(cmd);
      if (shownChildMenu != null) {
        shownChildMenu.onHide();
        popup.hide();
        shownChildMenu=null;
        selectItem(null);
      }
    }
 else     if (item.getSubMenu() != null) {
      if (shownChildMenu == null) {
        openPopup(item);
      }
 else       if (item.getSubMenu() != shownChildMenu) {
        shownChildMenu.onHide();
        popup.hide();
        openPopup(item);
      }
 else       if (fireCommand && !autoOpen) {
        shownChildMenu.onHide();
        popup.hide();
        shownChildMenu=null;
        selectItem(item);
      }
    }
 else     if (autoOpen && shownChildMenu != null) {
      shownChildMenu.onHide();
      popup.hide();
      shownChildMenu=null;
    }
  }
}
