{
  long now=System.currentTimeMillis();
  Date d=new Date(now);
  Timestamp t=new Timestamp(d.getTime());
  if (now % 1000 == 0) {
    t.setNanos(1000001);
  }
 else {
    t.setNanos(1);
  }
  Date d2=new Date(t.getTime());
  assertFalse("d.equals(t)",d.equals(t));
  assertEquals("d2, t",d2,t);
  assertEquals("hashcode",d2.hashCode(),t.hashCode());
  assertFalse("t.equals(d2)",t.equals(d2));
  assertEquals(1,t.compareTo(d2));
  Timestamp t2=new Timestamp(d.getTime());
  t2.setNanos(t.getNanos() + 1);
  assertFalse("t.equals(t2)",t.equals(t2));
  assertEquals("hashcode2",t.hashCode(),t2.hashCode());
}
