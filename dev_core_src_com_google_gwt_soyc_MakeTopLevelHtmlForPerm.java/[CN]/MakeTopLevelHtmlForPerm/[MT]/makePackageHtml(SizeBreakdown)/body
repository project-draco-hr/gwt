{
  String outFileName=breakdown.getId() + "-" + getPermutationId()+ "-"+ "packageBreakdown.html";
  Map<String,Integer> packageToPartialSize=breakdown.packageToSize;
  TreeMap<Integer,Set<String>> sortedPackages=new TreeMap<Integer,Set<String>>(Collections.reverseOrder());
  float sumSize=0f;
  for (  String packageName : packageToPartialSize.keySet()) {
    Integer curSize=packageToPartialSize.get(packageName);
    if (sortedPackages.containsKey(curSize)) {
      Set<String> existingSet=sortedPackages.get(curSize);
      existingSet.add(packageName);
      sortedPackages.put(curSize,existingSet);
    }
 else {
      Set<String> newSet=new TreeSet<String>();
      newSet.add(packageName);
      sortedPackages.put(curSize,newSet);
    }
    sumSize+=curSize;
  }
  final PrintWriter outFile=new PrintWriter(getOutFile(outFileName));
  addSmallHtmlProlog(outFile,"Package breakdown");
  outFile.println("<body class=\"soyc-breakdown\">");
  outFile.println("<div class=\"g-doc\">");
  outFile.println("<table class=\"soyc-table\">");
  outFile.println("<colgroup>");
  outFile.println("<col id=\"soyc-splitpoint-type-col\">");
  outFile.println("<col id=\"soyc-splitpoint-size-col\">");
  outFile.println("</colgroup>");
  outFile.println("<thead>");
  outFile.println("<th>Packages (Sorted by size)</th>");
  outFile.println("<th></th>");
  outFile.println("<th class=\"soyc-numerical-col-header\">");
  outFile.println("Size <span class=\"soyc-th-units\">(Bytes)</span>");
  outFile.println("</th>");
  outFile.println("<th class=\"soyc-numerical-col-header\">% of total</th>");
  outFile.println("</thead>");
  NumberFormat bytesFormatter=NumberFormat.getInstance();
  bytesFormatter.setGroupingUsed(true);
  NumberFormat percentFormatter=NumberFormat.getPercentInstance();
  percentFormatter.setMinimumFractionDigits(1);
  percentFormatter.setMaximumFractionDigits(1);
  for (  int size : sortedPackages.keySet()) {
    if (size == 0) {
      continue;
    }
    Set<String> packageNames=sortedPackages.get(size);
    for (    String packageName : packageNames) {
      String drillDownFileName=classesInPackageFileName(breakdown,getPermutationId()) + "#" + hashedFilenameFragment(packageName);
      float perc=size / sumSize;
      outFile.println("<tr>");
      outFile.println("<td><a href=\"" + drillDownFileName + "\" target=\"_top\">"+ packageName+ "</a></td>");
      outFile.println("<td class=\"soyc-bargraph-col\">");
      outFile.println("<div class=\"soyc-bar-graph goog-inline-block\">");
      outFile.println("<div style=\"width:" + perc + "%;\" class=\"soyc-bar-graph-fill goog-inline-block\"></div>");
      outFile.println("</div>");
      outFile.println("</td>");
      outFile.println("<td class=\"soyc-numerical-col\">");
      outFile.println(bytesFormatter.format(size));
      outFile.println("</td>");
      outFile.println("<td class=\"soyc-percent-col\">" + percentFormatter.format(perc) + "</td>");
      outFile.println("</tr>");
    }
  }
  outFile.println("</table>");
  addStandardHtmlEnding(outFile);
  outFile.close();
  return outFileName;
}
