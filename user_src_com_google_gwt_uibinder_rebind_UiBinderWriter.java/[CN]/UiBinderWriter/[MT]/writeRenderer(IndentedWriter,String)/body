{
  writePackage(w);
  writeImports(w);
  w.newline();
  writeClassOpen(w);
  writeStatics(w);
  w.newline();
  writeSafeHtmlTemplates(w);
  w.newline();
  w.write("public SafeHtml render(final %s owner) {",uiOwnerType.getParameterizedQualifiedSourceName());
  w.indent();
  w.newline();
  w.write("return new Widgets(owner).getSafeHtml();");
  w.outdent();
  w.write("}");
  w.newline();
  w.newline();
  w.write("/**");
  w.write(" * Encapsulates the access to all inner widgets");
  w.write(" */");
  w.write("class Widgets {");
  w.indent();
  String ownerClassType=uiOwnerType.getParameterizedQualifiedSourceName();
  w.write("private final %s owner;",ownerClassType);
  w.newline();
  w.write("public Widgets(final %s owner) {",ownerClassType);
  w.indent();
  w.write("this.owner = owner;");
  fieldManager.initializeWidgetsInnerClass(w,getOwnerClass());
  w.outdent();
  w.write("}");
  w.newline();
  w.write("public SafeHtml getSafeHtml() {");
  w.indent();
  String safeHtml=fieldManager.lookup(rootField.substring(4,rootField.length() - 2)).getSafeHtml();
  w.write("return %s;",safeHtml);
  w.outdent();
  w.write("}");
  fieldManager.writeFieldDefinitions(w,getOracle(),getOwnerClass(),getDesignTime());
  w.outdent();
  w.write("}");
  w.outdent();
  w.write("}");
}
