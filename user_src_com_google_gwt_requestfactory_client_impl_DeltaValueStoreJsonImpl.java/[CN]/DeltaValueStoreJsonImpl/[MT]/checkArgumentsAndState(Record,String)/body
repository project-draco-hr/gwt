{
  if (used) {
    throw new IllegalStateException(methodName + " can only be called on an un-used DeltaValueStore");
  }
  if (!(record instanceof RecordImpl)) {
    throw new IllegalArgumentException(record + " + must be an instance of " + RecordImpl.class);
  }
}
