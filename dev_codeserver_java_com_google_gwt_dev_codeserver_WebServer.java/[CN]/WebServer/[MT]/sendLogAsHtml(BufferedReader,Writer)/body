{
  try {
    String line=in.readLine();
    while (line != null) {
      line=escapeHtmlCharacters(line);
      Matcher m=ERROR_PATTERN.matcher(line);
      boolean error=m.find();
      if (error) {
        out.write(ERROR_STYLE_START);
      }
      out.write(line);
      if (error) {
        out.write(ERROR_STYLE_END);
      }
      out.write('\n');
      line=in.readLine();
    }
  }
  finally {
    in.close();
  }
}
