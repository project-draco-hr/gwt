{
  if (serviceMethod == null) {
    throw new NullPointerException("serviceMethod");
  }
  if (clientOracle == null) {
    throw new NullPointerException("clientOracle");
  }
  CommandSink sink;
  try {
    sink=clientOracle.createCommandSink(stream);
  }
 catch (  IOException e) {
    throw new SerializationException("Unable to initialize output",e);
  }
  try {
    Object result=serviceMethod.invoke(target,args);
    try {
      streamResponse(clientOracle,result,sink,false);
    }
 catch (    SerializationException e) {
      streamResponse(clientOracle,e,sink,true);
    }
  }
 catch (  IllegalAccessException e) {
    SecurityException securityException=new SecurityException(formatIllegalAccessErrorMessage(target,serviceMethod));
    securityException.initCause(e);
    throw securityException;
  }
catch (  IllegalArgumentException e) {
    SecurityException securityException=new SecurityException(formatIllegalArgumentErrorMessage(target,serviceMethod,args));
    securityException.initCause(e);
    throw securityException;
  }
catch (  InvocationTargetException e) {
    Throwable cause=e.getCause();
    if (cause instanceof RuntimeException) {
      throw new SerializationException("RuntimeException thrown by service method",cause);
    }
    streamResponse(clientOracle,cause,sink,true);
  }
  sink.finish();
}
