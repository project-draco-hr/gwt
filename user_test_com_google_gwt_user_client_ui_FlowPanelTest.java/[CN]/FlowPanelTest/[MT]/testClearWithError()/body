{
  BadWidget badWidget=new BadWidget();
  badWidget.setFailOnUnload(true);
  Label label0=new Label();
  Label label1=new Label();
  FlowPanel panel=createPanel();
  panel.add(label0);
  panel.add(badWidget);
  panel.add(label1);
  assertFalse(label0.isAttached());
  assertFalse(badWidget.isAttached());
  assertFalse(label1.isAttached());
  RootPanel.get().add(panel);
  assertTrue(label0.isAttached());
  assertTrue(badWidget.isAttached());
  assertTrue(label1.isAttached());
  try {
    panel.clear();
  }
 catch (  AttachDetachException e) {
    Set<Throwable> causes=e.getCauses();
    assertEquals(1,causes.size());
    Throwable[] throwables=causes.toArray(new Throwable[1]);
    assertTrue(throwables[0] instanceof IllegalArgumentException);
  }
  assertFalse(label0.isAttached());
  assertFalse(badWidget.isAttached());
  assertFalse(label1.isAttached());
  assertNull(badWidget.getParent());
  assertNull(badWidget.getElement().getParentElement());
}
