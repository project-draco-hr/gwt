{
  if (alreadyRan.contains(x)) {
    return;
  }
  alreadyRan.add(x);
  List jsFuncs=popList(x.methods.size());
  List jsFields=popList(x.fields.size());
  if (typeOracle.hasDirectClinit(x)) {
    JClassType superType=x.extnds;
    while (superType != null && !typeOracle.hasDirectClinit(superType)) {
      superType=superType.extnds;
    }
    handleClinit((JsFunction)jsFuncs.get(0),superType);
  }
 else {
    jsFuncs.set(0,null);
  }
  JsStatements globalStmts=jsProgram.getGlobalBlock().getStatements();
  for (int i=0; i < jsFuncs.size(); ++i) {
    JsFunction func=(JsFunction)jsFuncs.get(i);
    if (func != null) {
      globalStmts.add(func.makeStmt());
    }
  }
  if (typeOracle.isInstantiatedType(x)) {
    generateClassSetup(x,globalStmts);
  }
  JsVars vars=new JsVars();
  for (int i=0; i < jsFields.size(); ++i) {
    JsNode node=(JsNode)jsFields.get(i);
    if (node instanceof JsVar) {
      vars.add((JsVar)node);
    }
 else {
      assert(node instanceof JsStatement);
      JsStatement stmt=(JsStatement)jsFields.get(i);
      globalStmts.add(stmt);
    }
  }
  if (!vars.isEmpty()) {
    globalStmts.add(vars);
  }
}
