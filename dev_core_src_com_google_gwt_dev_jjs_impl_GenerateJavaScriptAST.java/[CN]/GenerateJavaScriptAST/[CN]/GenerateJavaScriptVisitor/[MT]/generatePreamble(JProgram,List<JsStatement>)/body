{
  List<JMethod> entryMethods=program.getEntryMethods();
  entryFunctions=new JsFunction[entryMethods.size()];
  entryMethodToIndex=Maps.newIdentityHashMap();
  for (int i=0; i < entryMethods.size(); i++) {
    entryMethodToIndex.put(entryMethods.get(i),i);
  }
  JsVars vars=new JsVars(jsProgram.getSourceInfo());
  vars.add(new JsVar(jsProgram.getSourceInfo(),globalTemp));
  globalStmts.add(vars);
  generateImmortalTypes(vars);
  Set<JDeclaredType> alreadyProcessed=Sets.<JDeclaredType>newLinkedHashSet(program.immortalCodeGenTypes);
  alreadyProcessed.add(program.getTypeClassLiteralHolder());
  List<JDeclaredType> classLiteralSupportClasses=computeClassLiteralsSupportClasses(program,alreadyProcessed);
  classLiteralSupportClasses.removeAll(alreadyProcessed);
  for (  JDeclaredType type : classLiteralSupportClasses) {
    accept(type);
  }
  generateClassLiterals(globalStmts,classLiteralSupportClasses);
  Set<JDeclaredType> preambleTypes=Sets.newLinkedHashSet(alreadyProcessed);
  preambleTypes.addAll(classLiteralSupportClasses);
  return preambleTypes;
}
