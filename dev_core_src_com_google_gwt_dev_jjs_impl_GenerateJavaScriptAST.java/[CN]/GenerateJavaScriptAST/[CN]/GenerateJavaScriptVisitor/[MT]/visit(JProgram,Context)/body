{
  List<JsStatement> globalStmts=jsProgram.getGlobalBlock().getStatements();
  Set<JDeclaredType> preambleTypes=generatePreamble(x,globalStmts);
  Set<JDeclaredType> topologicallySortedBodyTypes=Sets.newLinkedHashSet();
  for (  JDeclaredType type : x.getModuleDeclaredTypes()) {
    if (preambleTypes.contains(type)) {
      continue;
    }
    insertInTopologicalOrder(type,topologicallySortedBodyTypes);
  }
  topologicallySortedBodyTypes.removeAll(preambleTypes);
  for (  JDeclaredType type : topologicallySortedBodyTypes) {
    accept(type);
    JsVars classLiteralVars=new JsVars(jsProgram.getSourceInfo());
    maybeGenerateClassLiteral(type,classLiteralVars);
    if (!classLiteralVars.isEmpty()) {
      globalStmts.add(classLiteralVars);
    }
  }
  generateEpilogue(globalStmts);
  return false;
}
