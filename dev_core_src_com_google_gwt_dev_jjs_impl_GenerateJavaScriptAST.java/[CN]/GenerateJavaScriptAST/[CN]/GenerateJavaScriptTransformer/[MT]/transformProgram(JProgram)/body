{
  Set<JDeclaredType> preambleTypes=generatePreamble(program);
  if (incremental) {
    if (!minimalRebuildCache.hasPreambleTypeNames()) {
      Set<String> preambleTypeNames=Sets.newHashSet();
      for (      JDeclaredType preambleType : preambleTypes) {
        preambleTypeNames.add(preambleType.getName());
      }
      minimalRebuildCache.setPreambleTypeNames(logger,preambleTypeNames);
    }
  }
  Set<JDeclaredType> topologicallySortedBodyTypes=Sets.newLinkedHashSet();
  for (  JDeclaredType type : program.getModuleDeclaredTypes()) {
    insertInTopologicalOrder(type,topologicallySortedBodyTypes);
  }
  topologicallySortedBodyTypes.removeAll(preambleTypes);
  markPosition("Program",Type.PROGRAM_START);
  for (  JDeclaredType type : topologicallySortedBodyTypes) {
    markPosition(type.getName(),Type.CLASS_START);
    transform(type);
    maybeGenerateClassLiteral(type);
    installClassLiterals(Arrays.asList(type));
    markPosition(type.getName(),Type.CLASS_END);
  }
  markPosition("Program",Type.PROGRAM_END);
  generateEpilogue();
  return null;
}
