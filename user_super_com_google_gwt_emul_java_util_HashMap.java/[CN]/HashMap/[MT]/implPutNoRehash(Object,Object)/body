{
  int i=implFindSlot(key);
  if (entries[i] != null) {
    ImplMapEntry entry=entries[i];
    Object old=null;
    if (entry.inUse) {
      old=entry.value;
    }
 else {
      ++fullSlots;
    }
    entry.value=value;
    entry.inUse=true;
    return old;
  }
 else {
    ++fullSlots;
    --emptySlots;
    ImplMapEntry entry=new ImplMapEntry();
    entry.key=key;
    entry.value=value;
    entry.inUse=true;
    entries[i]=entry;
    return null;
  }
}
