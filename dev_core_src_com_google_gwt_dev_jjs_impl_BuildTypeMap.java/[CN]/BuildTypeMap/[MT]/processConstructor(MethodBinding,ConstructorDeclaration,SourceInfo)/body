{
  JClassType enclosingType=(JClassType)getType(b.declaringClass);
  JConstructor newCtor=program.createConstructor(info,enclosingType);
  if (enclosingType.isEnumOrSubclass() != null) {
    JProgram.createParameter(info,"enum$name",program.getTypeJavaLangString(),true,false,newCtor);
    JProgram.createParameter(info,"enum$ordinal",program.getTypePrimitiveInt(),true,false,newCtor);
  }
  ReferenceBinding declaringClass=b.declaringClass;
  Set<String> alreadyNamedVariables=new HashSet<String>();
  if (declaringClass.isNestedType() && !declaringClass.isStatic()) {
    NestedTypeBinding nestedBinding=(NestedTypeBinding)declaringClass;
    if (nestedBinding.enclosingInstances != null) {
      for (int i=0; i < nestedBinding.enclosingInstances.length; ++i) {
        SyntheticArgumentBinding arg=nestedBinding.enclosingInstances[i];
        String argName=String.valueOf(arg.name);
        if (alreadyNamedVariables.contains(argName)) {
          argName+="_" + i;
        }
        createParameter(arg,argName,newCtor);
        alreadyNamedVariables.add(argName);
      }
    }
  }
  if (decl == null) {
    mapParameters(newCtor,b,info);
  }
 else {
    mapParameters(newCtor,decl,info);
  }
  addThrownExceptions(b,newCtor);
  info.addCorrelation(info.getCorrelator().by(newCtor));
  if (declaringClass.isNestedType() && !declaringClass.isStatic()) {
    NestedTypeBinding nestedBinding=(NestedTypeBinding)declaringClass;
    if (nestedBinding.outerLocalVariables != null) {
      for (int i=0; i < nestedBinding.outerLocalVariables.length; ++i) {
        SyntheticArgumentBinding arg=nestedBinding.outerLocalVariables[i];
        String argName=String.valueOf(arg.name);
        if (alreadyNamedVariables.contains(argName)) {
          argName+="_" + i;
        }
        createParameter(arg,argName,newCtor);
        alreadyNamedVariables.add(argName);
      }
    }
  }
  if (enclosingType.isExternal()) {
    newCtor.setBody(null);
  }
  typeMap.put(b,newCtor);
  return newCtor;
}
