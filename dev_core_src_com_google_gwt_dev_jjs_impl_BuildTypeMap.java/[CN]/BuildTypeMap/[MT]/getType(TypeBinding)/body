{
  JType type=(JType)typeMap.tryGet(binding);
  if (type != null) {
    return type;
  }
  if (binding instanceof ArrayBinding) {
    binding=((ArrayBinding)binding).leafComponentType;
  }
  if (!(binding instanceof ReferenceBinding)) {
    throw new InternalCompilerException("Expected a ReferenceBinding but received a " + binding.getClass());
  }
  ReferenceBinding refBinding=(ReferenceBinding)binding;
  String name=dotify(refBinding.compoundName);
  if (!linker.isExternalType(name)) {
    return (JType)typeMap.get(binding);
  }
  type=createExternalType(name,refBinding);
  resolve((JDeclaredType)type,refBinding);
  return type;
}
