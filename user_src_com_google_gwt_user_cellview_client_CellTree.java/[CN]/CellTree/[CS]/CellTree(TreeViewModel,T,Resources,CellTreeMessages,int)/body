{
  super(viewModel);
  this.defaultNodeSize=defaultNodeSize;
  if (template == null) {
    template=GWT.create(Template.class);
  }
  this.style=resources.cellTreeStyle();
  this.style.ensureInjected();
  initWidget(new SimplePanel());
  setStyleName(this.style.cellTreeWidget());
  ImageResource treeOpen=resources.cellTreeOpenItem();
  ImageResource treeClosed=resources.cellTreeClosedItem();
  ImageResource treeLoading=resources.cellTreeLoading();
  openImageHtml=getImageHtml(treeOpen,false);
  closedImageHtml=getImageHtml(treeClosed,false);
  openImageTopHtml=getImageHtml(treeOpen,true);
  closedImageTopHtml=getImageHtml(treeClosed,true);
  loadingImageHtml=getImageHtml(treeLoading,false);
  imageWidth=Math.max(Math.max(treeOpen.getWidth(),treeClosed.getWidth()),treeLoading.getWidth());
  setAnimation(SlideAnimation.create());
  Set<String> eventTypes=new HashSet<String>();
  eventTypes.add(BrowserEvents.FOCUS);
  eventTypes.add(BrowserEvents.BLUR);
  eventTypes.add(BrowserEvents.KEYDOWN);
  eventTypes.add(BrowserEvents.KEYUP);
  eventTypes.add(BrowserEvents.MOUSEDOWN);
  eventTypes.add(BrowserEvents.CLICK);
  CellBasedWidgetImpl.get().sinkEvents(this,eventTypes);
  CellTreeNodeView<T> root=new CellTreeNodeView<T>(this,null,null,getElement(),rootValue,messages);
  keyboardSelectedNode=rootNode=root;
  root.setOpen(true,false);
  Roles.getTreeRole().set(getElement());
}
