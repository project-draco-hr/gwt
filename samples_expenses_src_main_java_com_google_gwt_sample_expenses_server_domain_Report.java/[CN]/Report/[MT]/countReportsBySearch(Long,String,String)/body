{
  EntityManager em=entityManager();
  try {
    Query query=queryReportsBySearch(em,employeeId,department,startsWith,null,true);
    if (query == null) {
      return REPORT_COUNT;
    }
    long count=((Number)query.getSingleResult()).longValue();
    if (count == 0) {
      new DataGenerationServiceImpl().generate(200);
      count=((Number)query.getSingleResult()).longValue();
    }
    return count;
  }
  finally {
    em.close();
  }
}
