{
  TreeLogger logger=createTestTreeLogger();
  MOCK_CPE0 cpe0=new MOCK_CPE0();
  MOCK_CPE3 cpe3=new MOCK_CPE3();
  ResourceOracleImpl oracle=createResourceOracle(cpe0,cpe1,cpe2,cpe3);
{
    ResourceOracleSnapshot s=refreshAndSnapshot(logger,oracle);
    s.assertPathIncluded("com/google/gwt/user/client/Command.java",cpe1);
    s.assertPathIncluded("com/google/gwt/user/client/Timer.java",cpe1);
  }
  cpe0.addResource("com/google/gwt/user/client/Command.java");
  cpe3.addResource("com/google/gwt/user/client/Timer.java");
{
    ResourceOracleSnapshot s=refreshAndSnapshot(logger,oracle);
    s.assertPathIncluded("com/google/gwt/user/client/Command.java",cpe0);
    s.assertPathIncluded("com/google/gwt/user/client/Timer.java",cpe1);
  }
{
    ResourceOracleSnapshot before=new ResourceOracleSnapshot(oracle);
    before.assertCollectionsConsistent(10);
    cpe3.updateResource("com/google/gwt/user/client/Timer.java");
    ResourceOracleSnapshot after=refreshAndSnapshot(logger,oracle);
    after.assertSameCollections(before);
  }
{
    ResourceOracleSnapshot before=new ResourceOracleSnapshot(oracle);
    before.assertCollectionsConsistent(10);
    cpe0.updateResource("com/google/gwt/user/client/Command.java");
    ResourceOracleSnapshot after=refreshAndSnapshot(logger,oracle);
    after.assertNotSameCollections(before);
  }
}
