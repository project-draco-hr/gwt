{
  TreeItem[] selected=tree.getSelection();
  StringWriter sw=new StringWriter();
  PrintWriter pw=new PrintWriter(sw,false);
  if (selected != null) {
    appendTreeItemText(pw,selected,0);
  }
  pw.close();
  Clipboard cb=new Clipboard(tree.getDisplay());
  final Object[] cbText=new Object[]{sw.toString()};
  final Transfer[] cbFormat=new Transfer[]{TextTransfer.getInstance()};
  cb.setContents(cbText,cbFormat);
}
