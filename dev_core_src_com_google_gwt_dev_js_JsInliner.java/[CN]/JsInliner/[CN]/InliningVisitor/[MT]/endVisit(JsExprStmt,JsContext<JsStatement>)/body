{
  JsExpression e=x.getExpression();
  if (ctx.canRemove() && !hasSideEffects(x)) {
    ctx.removeMe();
    return;
  }
  List<JsExprStmt> statements=new ArrayList<JsExprStmt>();
  while (e instanceof JsBinaryOperation) {
    JsBinaryOperation op=(JsBinaryOperation)e;
    if (!op.getOperator().equals(JsBinaryOperator.COMMA)) {
      break;
    }
    if (hasSideEffects(op.getArg2())) {
      statements.add(0,new JsExprStmt(op.getArg2()));
    }
    e=op.getArg1();
  }
  if (hasSideEffects(e)) {
    statements.add(0,new JsExprStmt(e));
  }
  if (statements.size() == 0) {
    if (ctx.canRemove()) {
      ctx.removeMe();
    }
 else {
      ctx.replaceMe(program.getEmptyStmt());
    }
  }
 else   if (x.getExpression() != statements.get(0).getExpression()) {
    if (!ctx.canInsert()) {
      JsBlock b=new JsBlock();
      b.getStatements().addAll(statements);
      ctx.replaceMe(b);
      return;
    }
 else {
      for (      JsStatement s : statements) {
        ctx.insertBefore(s);
      }
      ctx.removeMe();
    }
  }
}
