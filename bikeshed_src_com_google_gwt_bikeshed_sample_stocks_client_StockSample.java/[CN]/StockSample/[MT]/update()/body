{
  if (queryWidget == null) {
    return;
  }
  updateTimer.cancel();
  Range[] searchRanges=searchListModel.getRanges();
  Range[] favoritesRanges=favoritesListModel.getRanges();
  String sectorName=getSectorName();
  SectorListModel sectorListModel=sectorName != null ? treeModel.getSectorListModel(sectorName) : null;
  Range[] sectorRanges=sectorListModel == null ? null : sectorListModel.getRanges();
  if (searchRanges == null || searchRanges.length == 0 || favoritesRanges == null || favoritesRanges.length == 0) {
    return;
  }
  String searchQuery=queryWidget.getSearchQuery();
  StockRequest request=new StockRequest(searchQuery,sectorListModel != null ? sectorListModel.getSector() : null,searchRanges[0],favoritesRanges[0],sectorRanges != null && sectorRanges.length > 0 ? sectorRanges[0] : null);
  dataService.getStockQuotes(request,new AsyncCallback<StockResponse>(){
    public void onFailure(    Throwable caught){
      String message=caught.getMessage();
      if (message.contains("Not logged in")) {
        Window.Location.reload();
      }
 else {
        Window.alert("ERROR: " + caught.getMessage());
        updateTimer.schedule(UPDATE_DELAY);
      }
    }
    public void onSuccess(    StockResponse result){
      processStockResponse(result);
    }
  }
);
}
