{
  T result=null;
  Throwable caught=null;
  try {
    String encodedResponse=response.getText();
    if (RemoteServiceProxy.isReturnValue(encodedResponse)) {
      result=(T)responseReader.read(streamFactory.createStreamReader(encodedResponse));
    }
 else     if (RemoteServiceProxy.isThrownException(encodedResponse)) {
      caught=(Throwable)streamFactory.createStreamReader(encodedResponse).readObject();
    }
 else {
      caught=new InvocationException(encodedResponse);
    }
  }
 catch (  com.google.gwt.user.client.rpc.SerializationException e) {
    caught=new IncompatibleRemoteServiceException();
  }
catch (  Throwable e) {
    caught=e;
  }
  if (caught == null) {
    callback.onSuccess(result);
  }
 else {
    callback.onFailure(caught);
  }
}
