{
  CountingEventBus eventBus=new CountingEventBus(new SimpleEventBus());
  eventBus.addHandler(MouseDownEvent.getType(),mouse1);
  eventBus.addHandler(MouseDownEvent.getType(),mouse2);
  HandlerRegistration reg1=eventBus.addHandler(MouseDownEvent.getType(),adaptor1);
  eventBus.fireEvent(new MouseDownEvent(){
  }
);
  assertEquals(3,eventBus.getCount(MouseDownEvent.getType()));
  assertFired(mouse1,mouse2,adaptor1);
  eventBus.addHandler(MouseDownEvent.getType(),mouse3);
  assertEquals(4,eventBus.getCount(MouseDownEvent.getType()));
  eventBus.addHandler(MouseDownEvent.getType(),mouse1);
  eventBus.addHandler(MouseDownEvent.getType(),mouse2);
  HandlerRegistration reg2=eventBus.addHandler(MouseDownEvent.getType(),adaptor1);
  assertEquals(7,eventBus.getCount(MouseDownEvent.getType()));
  eventBus.addHandler(ClickEvent.getType(),adaptor1);
  eventBus.addHandler(ClickEvent.getType(),click1);
  eventBus.addHandler(ClickEvent.getType(),click2);
  assertEquals(7,eventBus.getCount(MouseDownEvent.getType()));
  assertEquals(3,eventBus.getCount(ClickEvent.getType()));
  reset();
  eventBus.fireEvent(new MouseDownEvent(){
  }
);
  assertFired(mouse1,mouse2,mouse3,adaptor1);
  assertNotFired(click1,click2);
  reg1.removeHandler();
  eventBus.fireEvent(new MouseDownEvent(){
  }
);
  assertFired(mouse1,mouse2,mouse3,adaptor1);
  assertNotFired(click1,click2);
  reg2.removeHandler();
  reset();
  eventBus.fireEvent(new MouseDownEvent(){
  }
);
  assertFired(mouse1,mouse2,mouse3);
  assertNotFired(adaptor1,click1,click2);
  reset();
  eventBus.fireEvent(new ClickEvent(){
  }
);
  assertNotFired(mouse1,mouse2,mouse3);
  assertFired(click1,click2,adaptor1);
}
