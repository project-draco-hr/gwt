{
  List<CompilationUnitBuilder> builders=new ArrayList<CompilationUnitBuilder>();
  Map<CompilationUnitBuilder,CompilationUnit> cachedUnits=new IdentityHashMap<CompilationUnitBuilder,CompilationUnit>();
  for (  GeneratedUnit generatedUnit : generatedUnits) {
    GeneratedCompilationUnitBuilder builder=new GeneratedCompilationUnitBuilder(generatedUnit);
    ContentId contentId=new ContentId(generatedUnit.getTypeName(),generatedUnit.getStrongHash());
    CompilationUnit existingUnit=unitCache.get(contentId);
    if (existingUnit != null) {
      cachedUnits.put(builder,existingUnit);
      compileMoreLater.addValidUnit(existingUnit);
    }
 else {
      builders.add(builder);
    }
  }
  return compileMoreLater.compile(logger,builders,cachedUnits,CompilerEventType.JDT_COMPILER_CSB_GENERATED);
}
