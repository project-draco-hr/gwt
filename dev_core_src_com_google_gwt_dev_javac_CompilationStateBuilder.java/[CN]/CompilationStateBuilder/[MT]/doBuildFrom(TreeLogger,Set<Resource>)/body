{
  final Map<String,Resource> resourceMap=new HashMap<String,Resource>();
  for (  Resource resource : resources) {
    resourceMap.put(resource.getPath(),resource);
  }
  final Set<Resource> finalResources=Collections.unmodifiableSet(resources);
  final Map<String,Resource> finalMap=Collections.unmodifiableMap(resourceMap);
  ResourceOracle oracle=new ResourceOracle(){
    public void clear(){
      throw new UnsupportedOperationException();
    }
    public Set<String> getPathNames(){
      return finalMap.keySet();
    }
    public Map<String,Resource> getResourceMap(){
      return finalMap;
    }
    public Set<Resource> getResources(){
      return finalResources;
    }
  }
;
  return new CompilationState(logger,oracle);
}
