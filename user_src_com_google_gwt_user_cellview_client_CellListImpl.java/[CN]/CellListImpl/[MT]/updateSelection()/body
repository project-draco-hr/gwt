{
  boolean dependsOnSelection=dependsOnSelection();
  boolean refreshRequired=false;
  Element cellElem=childContainer.getFirstChildElement();
  int row=pageStart;
  for (  T value : data) {
    boolean selected=selectionModel == null ? false : selectionModel.isSelected(value);
    if (selected != selectedRows.contains(row)) {
      refreshRequired=true;
      if (selected) {
        selectedRows.add(row);
      }
 else {
        selectedRows.remove(row);
      }
      if (!dependsOnSelection) {
        if (cellElem != null) {
          setSelected(cellElem,selected);
        }
      }
    }
    if (cellElem == null) {
      break;
    }
    cellElem=cellElem.getNextSiblingElement();
    row++;
  }
  if (refreshRequired && dependsOnSelection) {
    setData(data,pageStart);
  }
}
