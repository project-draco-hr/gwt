{
  int valuesLength=values.size();
  int valuesEnd=valuesStart + valuesLength;
  int pageEnd=pageStart + pageSize;
  int boundedStart=Math.max(valuesStart,pageStart);
  int boundedEnd=Math.min(valuesEnd,pageEnd);
  if (boundedStart >= boundedEnd) {
    return;
  }
  if (valuesEnd > dataSize) {
    dataSize=valuesEnd;
    onSizeChanged();
  }
  int lastCacheIndex=pageStart + data.size();
  while (lastCacheIndex < boundedStart) {
    data.add(null);
    lastCacheIndex++;
  }
  for (int i=boundedStart; i < boundedEnd; i++) {
    T value=values.get(i - valuesStart);
    int dataIndex=i - pageStart;
    if (dataIndex < data.size()) {
      data.set(dataIndex,value);
    }
 else {
      data.add(value);
    }
    if (selectionModel != null) {
      if (value != null && selectionModel.isSelected(value)) {
        selectedRows.add(i);
      }
 else {
        selectedRows.remove(i);
      }
    }
  }
  boundedStart=pageStartChanged ? pageStart : boundedStart;
  List<T> boundedValues=data.subList(boundedStart - pageStart,boundedEnd - pageStart);
  int boundedSize=boundedValues.size();
  StringBuilder sb=new StringBuilder();
  emitHtml(sb,boundedValues,boundedStart,selectionModel);
  int childCount=childContainer.getChildCount();
  if (boundedStart == pageStart && (boundedSize >= childCount || boundedSize >= getDisplayedItemCount())) {
    String newContents=sb.toString();
    if (!newContents.equals(lastContents)) {
      lastContents=newContents;
      childContainer=renderChildContents(newContents);
    }
  }
 else {
    lastContents=null;
    Element container=convertToElements(sb.toString());
    Element toReplace=null;
    int realStart=boundedStart - pageStart;
    if (realStart < childCount) {
      toReplace=childContainer.getChild(realStart).cast();
    }
    for (int i=boundedStart; i < boundedEnd; i++) {
      if (toReplace == null) {
        childContainer.appendChild(container.getChild(0));
      }
 else {
        Element nextSibling=toReplace.getNextSiblingElement();
        childContainer.replaceChild(container.getChild(0),toReplace);
        toReplace=nextSibling;
      }
    }
  }
  pageStartChanged=false;
}
