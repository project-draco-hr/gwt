{
  Style style=dataGrid.getResources().style();
  rowStyle=style.evenRow();
  selectedRowStyle=" " + style.selectedRow();
  cellStyle=style.cell() + " " + style.evenRowCell();
  selectedCellStyle=" " + style.selectedRowCell();
  Date today=new Date();
  todayMonth=today.getMonth();
  Column<ContactInfo,Boolean> checkboxColumn=new Column<ContactInfo,Boolean>(new CheckboxCell(true,false)){
    @Override public Boolean getValue(    ContactInfo object){
      return dataGrid.getSelectionModel().isSelected(object);
    }
  }
;
  dataGrid.addColumn(checkboxColumn,SafeHtmlUtils.fromSafeConstant("<br/>"));
  dataGrid.setColumnWidth(0,40,Unit.PX);
  SafeHtmlRenderer<String> anchorRenderer=new AbstractSafeHtmlRenderer<String>(){
    @Override public SafeHtml render(    String object){
      SafeHtmlBuilder sb=new SafeHtmlBuilder();
      sb.appendHtmlConstant("(<a href=\"javascript:;\">").appendEscaped(object).appendHtmlConstant("</a>)");
      return sb.toSafeHtml();
    }
  }
;
  Column<ContactInfo,String> viewFriendsColumn=new Column<ContactInfo,String>(new ClickableTextCell(anchorRenderer)){
    @Override public String getValue(    ContactInfo object){
      if (showingFriends.contains(object.getId())) {
        return "hide friends";
      }
 else {
        return "show friends";
      }
    }
  }
;
  dataGrid.addColumn(viewFriendsColumn,SafeHtmlUtils.fromSafeConstant("<br/>"));
  viewFriendsColumn.setFieldUpdater(new FieldUpdater<ContactInfo,String>(){
    @Override public void update(    int index,    ContactInfo object,    String value){
      if (showingFriends.contains(object.getId())) {
        showingFriends.remove(object.getId());
      }
 else {
        showingFriends.add(object.getId());
      }
      dataGrid.redrawRow(index);
    }
  }
);
  dataGrid.setColumnWidth(1,10,Unit.EM);
  Column<ContactInfo,String> firstNameColumn=new Column<ContactInfo,String>(new EditTextCell()){
    @Override public String getValue(    ContactInfo object){
      return object.getFirstName();
    }
  }
;
  firstNameColumn.setSortable(true);
  sortHandler.setComparator(firstNameColumn,new Comparator<ContactInfo>(){
    @Override public int compare(    ContactInfo o1,    ContactInfo o2){
      return o1.getFirstName().compareTo(o2.getFirstName());
    }
  }
);
  dataGrid.addColumn(firstNameColumn,constants.cwCustomDataGridColumnFirstName());
  firstNameColumn.setFieldUpdater(new FieldUpdater<ContactInfo,String>(){
    @Override public void update(    int index,    ContactInfo object,    String value){
      object.setFirstName(value);
      ContactDatabase.get().refreshDisplays();
    }
  }
);
  dataGrid.setColumnWidth(2,20,Unit.PCT);
  Column<ContactInfo,String> lastNameColumn=new Column<ContactInfo,String>(new EditTextCell()){
    @Override public String getValue(    ContactInfo object){
      return object.getLastName();
    }
  }
;
  lastNameColumn.setSortable(true);
  sortHandler.setComparator(lastNameColumn,new Comparator<ContactInfo>(){
    @Override public int compare(    ContactInfo o1,    ContactInfo o2){
      return o1.getLastName().compareTo(o2.getLastName());
    }
  }
);
  dataGrid.addColumn(lastNameColumn,constants.cwCustomDataGridColumnLastName());
  lastNameColumn.setFieldUpdater(new FieldUpdater<ContactInfo,String>(){
    @Override public void update(    int index,    ContactInfo object,    String value){
      object.setLastName(value);
      ContactDatabase.get().refreshDisplays();
    }
  }
);
  dataGrid.setColumnWidth(3,20,Unit.PCT);
  Column<ContactInfo,Number> ageColumn=new Column<ContactInfo,Number>(new NumberCell()){
    @Override public Number getValue(    ContactInfo object){
      return object.getAge();
    }
  }
;
  ageColumn.setSortable(true);
  sortHandler.setComparator(ageColumn,new Comparator<ContactInfo>(){
    @Override public int compare(    ContactInfo o1,    ContactInfo o2){
      return o1.getAge() - o2.getAge();
    }
  }
);
  Header<String> ageFooter=new Header<String>(new TextCell()){
    @Override public String getValue(){
      List<ContactInfo> items=dataGrid.getVisibleItems();
      if (items.size() == 0) {
        return "";
      }
 else {
        int totalAge=0;
        for (        ContactInfo item : items) {
          totalAge+=item.getAge();
        }
        return "Avg: " + totalAge / items.size();
      }
    }
  }
;
  dataGrid.addColumn(ageColumn,new SafeHtmlHeader(SafeHtmlUtils.fromSafeConstant(constants.cwCustomDataGridColumnAge())),ageFooter);
  dataGrid.setColumnWidth(4,7,Unit.EM);
  final Category[] categories=ContactDatabase.get().queryCategories();
  List<String> categoryNames=new ArrayList<String>();
  for (  Category category : categories) {
    categoryNames.add(category.getDisplayName());
  }
  SelectionCell categoryCell=new SelectionCell(categoryNames);
  Column<ContactInfo,String> categoryColumn=new Column<ContactInfo,String>(categoryCell){
    @Override public String getValue(    ContactInfo object){
      return object.getCategory().getDisplayName();
    }
  }
;
  dataGrid.addColumn(categoryColumn,constants.cwCustomDataGridColumnCategory());
  categoryColumn.setFieldUpdater(new FieldUpdater<ContactInfo,String>(){
    @Override public void update(    int index,    ContactInfo object,    String value){
      for (      Category category : categories) {
        if (category.getDisplayName().equals(value)) {
          object.setCategory(category);
        }
      }
      ContactDatabase.get().refreshDisplays();
    }
  }
);
  dataGrid.setColumnWidth(5,130,Unit.PX);
  Column<ContactInfo,String> addressColumn=new Column<ContactInfo,String>(new TextCell()){
    @Override public String getValue(    ContactInfo object){
      return object.getAddress();
    }
  }
;
  addressColumn.setSortable(true);
  sortHandler.setComparator(addressColumn,new Comparator<ContactInfo>(){
    @Override public int compare(    ContactInfo o1,    ContactInfo o2){
      return o1.getAddress().compareTo(o2.getAddress());
    }
  }
);
  dataGrid.addColumn(addressColumn,constants.cwCustomDataGridColumnAddress());
  dataGrid.setColumnWidth(6,60,Unit.PCT);
}
