{
  checkWidget();
  if (html == null)   SWT.error(SWT.ERROR_NULL_ARGUMENT);
  if (this != getDisplay().getFocusControl())   Deactivate();
  byte[] data=null;
  try {
    data=html.getBytes("UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    return false;
  }
  int[] result=new int[1];
  int rc=XPCOM.NS_GetServiceManager(result);
  if (rc != XPCOM.NS_OK)   error(rc);
  if (result[0] == 0)   error(XPCOM.NS_NOINTERFACE);
  nsIServiceManager serviceManager=new nsIServiceManager(result[0]);
  result[0]=0;
  rc=serviceManager.GetService(XPCOM.NS_IOSERVICE_CID,nsIIOService.NS_IIOSERVICE_IID,result);
  if (rc != XPCOM.NS_OK)   error(rc);
  if (result[0] == 0)   error(XPCOM.NS_NOINTERFACE);
  serviceManager.Release();
  nsIIOService ioService=new nsIIOService(result[0]);
  result[0]=0;
  byte[] aString=URI_FROMMEMORY.getBytes();
  int aSpec=XPCOM.nsEmbedCString_new(aString,aString.length);
  rc=ioService.NewURI(aSpec,null,0,result);
  XPCOM.nsEmbedCString_delete(aSpec);
  if (rc != XPCOM.NS_OK)   error(rc);
  if (result[0] == 0)   error(XPCOM.NS_NOINTERFACE);
  ioService.Release();
  nsIURI uri=new nsIURI(result[0]);
  result[0]=0;
  byte[] buffer="text/html".getBytes();
  byte[] contentTypeBuffer=new byte[buffer.length + 1];
  System.arraycopy(buffer,0,contentTypeBuffer,0,buffer.length);
  int aContentType=XPCOM.nsEmbedCString_new(contentTypeBuffer,contentTypeBuffer.length);
  result[0]=0;
  rc=webBrowser.QueryInterface(nsIWebBrowserStream.NS_IWEBBROWSERSTREAM_IID,result);
  if (rc == XPCOM.NS_OK) {
    if (result[0] == 0)     error(XPCOM.NS_ERROR_NO_INTERFACE);
    nsIWebBrowserStream stream=new nsIWebBrowserStream(result[0]);
    rc=stream.OpenStream(uri.getAddress(),aContentType);
    if (rc != XPCOM.NS_OK)     error(rc);
    int ptr=XPCOM.PR_Malloc(data.length);
    XPCOM.memmove(ptr,data,data.length);
    rc=stream.AppendToStream(ptr,data.length);
    if (rc != XPCOM.NS_OK)     error(rc);
    rc=stream.CloseStream();
    if (rc != XPCOM.NS_OK)     error(rc);
    XPCOM.PR_Free(ptr);
    stream.Release();
  }
 else {
    rc=webBrowser.QueryInterface(nsIInterfaceRequestor.NS_IINTERFACEREQUESTOR_IID,result);
    if (rc != XPCOM.NS_OK)     error(rc);
    if (result[0] == 0)     error(XPCOM.NS_ERROR_NO_INTERFACE);
    nsIInterfaceRequestor interfaceRequestor=new nsIInterfaceRequestor(result[0]);
    result[0]=0;
    rc=interfaceRequestor.GetInterface(nsIDocShell.NS_IDOCSHELL_IID,result);
    interfaceRequestor.Release();
    nsIDocShell docShell=new nsIDocShell(result[0]);
    result[0]=0;
    buffer="UTF-8".getBytes();
    byte[] contentCharsetBuffer=new byte[buffer.length + 1];
    System.arraycopy(buffer,0,contentCharsetBuffer,0,buffer.length);
    int aContentCharset=XPCOM.nsEmbedCString_new(contentCharsetBuffer,contentCharsetBuffer.length);
    InputStream inputStream=new InputStream(data);
    inputStream.AddRef();
    rc=docShell.LoadStream(inputStream.getAddress(),uri.getAddress(),aContentType,aContentCharset,0);
    if (rc != XPCOM.NS_OK)     error(rc);
    XPCOM.nsEmbedCString_delete(aContentCharset);
    inputStream.Release();
    docShell.Release();
  }
  XPCOM.nsEmbedCString_delete(aContentType);
  uri.Release();
  return true;
}
