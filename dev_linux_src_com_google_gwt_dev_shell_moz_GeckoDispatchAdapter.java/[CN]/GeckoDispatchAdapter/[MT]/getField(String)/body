{
  int dispId=classLoader.getDispId(name);
  if (dispId < 0) {
    return LowLevelMoz.JSVAL_VOID;
  }
  if (javaDispatch.isField(dispId)) {
    Field field=javaDispatch.getField(dispId);
    return SwtGeckoGlue.convertObjectToJSVal(scriptObject,classLoader,field.getType(),javaDispatch.getFieldValue(dispId));
  }
 else {
    Method method=javaDispatch.getMethod(dispId);
    DispatchMethod dispMethod;
    dispMethod=(DispatchMethod)classLoader.getMethodDispatch(method);
    if (dispMethod == null) {
      dispMethod=new MethodDispatch(classLoader,method,scriptObject);
      classLoader.putMethodDispatch(method,dispMethod);
    }
    return LowLevelMoz.wrapFunction(scriptObject,method.toString(),dispMethod);
  }
}
