{
  ensureFileReady();
  try {
    writeLibraryName();
    writeVersionNumber();
    writeDependencyLibraryNames();
    writeClassFilePaths();
    writeCompilationUnitTypeSourceNames();
    writeNestedNamesByCompilationUnitName();
    writeCompilationErrorsIndex();
    writeBuildResources();
    writeBuildResourcePaths();
    writePublicResources();
    writePublicResourcePaths();
    writeReboundTypeSourceNames();
    writeProcessedReboundTypeSourceNamesForGenerators();
    writeGeneratedArtifactPaths();
    writeGeneratedArtifacts();
  }
  finally {
    try {
      zipOutputStream.close();
    }
 catch (    IOException e) {
      throw new CompilerIoException("Failed to close new library file " + zipFile.getPath() + ".",e);
    }
  }
}
