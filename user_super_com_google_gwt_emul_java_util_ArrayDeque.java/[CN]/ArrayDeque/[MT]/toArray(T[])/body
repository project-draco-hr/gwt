{
  int size=size();
  if (out.length < size) {
    out=ArrayHelper.createFrom(out,size);
  }
  Object[] dest=out;
  final int mask=size - 1;
  for (int i=head, dstIdx=0; dstIdx < size; i=(i + 1) & mask, ++dstIdx) {
    dest[dstIdx]=array[i];
  }
  if (out.length > size) {
    out[size]=null;
  }
  return out;
}
