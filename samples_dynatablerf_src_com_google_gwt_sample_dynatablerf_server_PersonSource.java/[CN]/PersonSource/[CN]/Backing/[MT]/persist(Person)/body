{
  if (person.getId() == null) {
    person.setId(++serial);
  }
  person.setVersion(person.getVersion() + 1);
  Person existing=people.get(person.getId());
  if (existing != null) {
    existing.copyFrom(person);
  }
 else {
    people.put(person.getId(),person);
  }
}
