{
  this.format=format;
  this.datePicker=new DatePicker();
  this.panel=new PopupPanel(true,true){
    @Override public boolean onKeyUpPreview(    char key,    int modifiers){
      if (key == ESCAPE) {
        panel.hide();
      }
      return true;
    }
  }
;
  panel.add(datePicker);
  datePicker.addValueChangeHandler(new ValueChangeHandler<Date>(){
    public void onValueChange(    ValueChangeEvent<Date> event){
      panel.hide();
      valueUpdater.update(event.getValue(),viewData);
    }
  }
);
}
