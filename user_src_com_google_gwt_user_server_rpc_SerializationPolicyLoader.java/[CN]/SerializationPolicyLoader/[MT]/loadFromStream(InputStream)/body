{
  if (inputStream == null) {
    throw new NullPointerException("inputStream");
  }
  Map whitelist=new HashMap();
  InputStreamReader isr=new InputStreamReader(inputStream,SERIALIZATION_POLICY_FILE_ENCODING);
  BufferedReader br=new BufferedReader(isr);
  String line=br.readLine();
  int lineNum=1;
  while (line != null) {
    line=line.trim();
    if (line.length() > 0) {
      String[] components=line.split(",");
      if (components.length != 2) {
        throw new ParseException(FORMAT_ERROR_MESSAGE,lineNum);
      }
      String binaryTypeName=components[0].trim();
      String instantiable=components[1].trim();
      if (binaryTypeName.length() == 0 || instantiable.length() == 0) {
        throw new ParseException(FORMAT_ERROR_MESSAGE,lineNum);
      }
      ClassLoader contextClassLoader=Thread.currentThread().getContextClassLoader();
      Class clazz=Class.forName(binaryTypeName,false,contextClassLoader);
      whitelist.put(clazz,Boolean.valueOf(instantiable));
    }
    line=br.readLine();
    lineNum++;
  }
  return new StandardSerializationPolicy(whitelist);
}
