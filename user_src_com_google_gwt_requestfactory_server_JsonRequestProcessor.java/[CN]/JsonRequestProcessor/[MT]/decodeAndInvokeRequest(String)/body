{
  try {
    Logger.getLogger(this.getClass().getName()).finest("Incoming request " + encodedRequest);
    String response=processJsonRequest(encodedRequest).toString();
    Logger.getLogger(this.getClass().getName()).finest("Outgoing response " + response);
    return response;
  }
 catch (  Exception e) {
    JSONObject exceptionResponse=new JSONObject();
    try {
      exceptionResponse.put("exception","Server error");
    }
 catch (    JSONException jsonException) {
      throw new IllegalStateException(jsonException);
    }
    throw new RequestProcessingException("Unexpected exception",e,exceptionResponse.toString());
  }
}
