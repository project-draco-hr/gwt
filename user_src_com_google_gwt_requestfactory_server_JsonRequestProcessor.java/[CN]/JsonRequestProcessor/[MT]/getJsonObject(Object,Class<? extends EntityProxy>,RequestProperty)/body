{
  if (entityElement == null || !EntityProxy.class.isAssignableFrom(entityKeyClass)) {
    return JSONObject.NULL;
  }
  JSONObject jsonObject=getJsonObjectWithIdAndVersion(isEntityReference(entityElement,entityKeyClass),entityElement,propertyContext);
  for (  Property<?> p : allProperties(entityKeyClass)) {
    if (requestedProperty(p,propertyContext)) {
      String propertyName=p.getName();
      jsonObject.put(propertyName,encodePropertyValueFromDataStore(entityElement,p,propertyName,propertyContext));
    }
  }
  return jsonObject;
}
