{
  JSONObject jsonObject=new JSONObject();
  if (entityElement == null || !EntityProxy.class.isAssignableFrom(entityKeyClass)) {
    return JSONObject.NULL;
  }
  jsonObject.put(Constants.ENCODED_ID_PROPERTY,isEntityReference(entityElement,entityKeyClass));
  jsonObject.put(Constants.ENCODED_VERSION_PROPERTY,encodePropertyValueFromDataStore(entityElement,Constants.ENTITY_VERSION_PROPERTY,Constants.ENTITY_VERSION_PROPERTY.getName(),propertyContext));
  for (  Property<?> p : allProperties(entityKeyClass)) {
    if (requestedProperty(p,propertyContext)) {
      String propertyName=p.getName();
      jsonObject.put(propertyName,encodePropertyValueFromDataStore(entityElement,p,propertyName,propertyContext));
    }
  }
  return jsonObject;
}
