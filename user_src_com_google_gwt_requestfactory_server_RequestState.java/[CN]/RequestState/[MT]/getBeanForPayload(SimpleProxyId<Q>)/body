{
  @SuppressWarnings("unchecked") AutoBean<Q> toReturn=(AutoBean<Q>)beans.get(id);
  if (toReturn == null) {
    Class<?> domainClass=service.resolveDomainClass(id.getProxyClass());
    Object domain;
    if (id.isEphemeral() || id.isSynthetic()) {
      domain=service.createDomainObject(domainClass);
      if (domain == null) {
        throw new UnexpectedException("Could not create instance of " + domainClass.getCanonicalName(),null);
      }
    }
 else {
      Splittable address=StringQuoter.split(id.getServerId());
      Class<?> param=service.getIdType(domainClass);
      Object domainParam;
      if (ValueCodex.canDecode(param)) {
        domainParam=ValueCodex.decode(param,address);
      }
 else {
        domainParam=new SimpleRequestProcessor(service).decodeOobMessage(param,address).get(0);
      }
      domain=service.loadDomainObject(domainClass,domainParam);
    }
    domainObjectsToId.put(domain,id);
    toReturn=createEntityProxyBean(id,domain);
  }
  return toReturn;
}
