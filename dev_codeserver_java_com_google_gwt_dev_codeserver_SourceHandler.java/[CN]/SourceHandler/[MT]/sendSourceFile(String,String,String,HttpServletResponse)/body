{
  ModuleState moduleState=modules.get(moduleName);
  InputStream pageBytes=moduleState.openSourceFile(sourcePath);
  if (pageBytes == null) {
    response.sendError(HttpServletResponse.SC_NOT_FOUND);
    logger.log(TreeLogger.WARN,"unknown source file: " + sourcePath);
    return;
  }
  if (query != null && query.equals("html")) {
    BufferedReader reader=new BufferedReader(new InputStreamReader(pageBytes));
    sendSourceFileAsHtml(moduleName,sourcePath,reader,response);
  }
 else {
    PageUtil.sendStream("text/plain",pageBytes,response);
  }
}
