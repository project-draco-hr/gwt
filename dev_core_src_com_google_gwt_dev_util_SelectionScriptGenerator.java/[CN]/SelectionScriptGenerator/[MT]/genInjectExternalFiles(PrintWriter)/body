{
  pw.println();
  pw.println("function injectExternalFiles() {");
  pw.println("  var mcb = $wnd.__gwt_tryGetModuleControlBlock(location.search);");
  pw.println("  if (!mcb) return;");
  pw.println("  var base = mcb.getBaseURL();");
  pw.println("  mcb.addStyles([");
  boolean needComma=false;
  for (Iterator iter=styles.iterator(); iter.hasNext(); ) {
    String src=(String)iter.next();
    if (needComma) {
      pw.println(",");
    }
    needComma=true;
    pw.print("    ");
    if (isRelativeURL(src)) {
      pw.print("base+");
    }
    pw.print("'");
    pw.print(src);
    pw.print("'");
  }
  pw.println();
  pw.println("    ]);");
  pw.println("  mcb.addScripts([");
  needComma=false;
  for (Iterator iter=scripts.iterator(); iter.hasNext(); ) {
    Script script=(Script)iter.next();
    if (needComma) {
      pw.println(",");
    }
    needComma=true;
    String src=script.getSrc();
    pw.print("    ");
    if (isRelativeURL(src)) {
      pw.print("base+");
    }
    pw.print("'");
    pw.print(src);
    pw.print("', \"");
    String readyFnJs=Jsni.generateEscapedJavaScript(script.getJsReadyFunction());
    pw.print(readyFnJs);
    pw.print("\"");
  }
  pw.println();
  pw.println("    ]);");
  pw.println("}");
}
