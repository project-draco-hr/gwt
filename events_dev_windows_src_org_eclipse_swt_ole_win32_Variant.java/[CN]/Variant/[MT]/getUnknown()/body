{
  if (type == COM.VT_EMPTY) {
    OLE.error(OLE.ERROR_CANNOT_CHANGE_VARIANT_TYPE,-1);
  }
  if (type == COM.VT_UNKNOWN) {
    return unknownData;
  }
  int oldPtr=OS.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT,sizeof);
  int newPtr=OS.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT,sizeof);
  Variant unknownVar=null;
  try {
    getData(oldPtr);
    int result=COM.VariantChangeType(newPtr,oldPtr,(short)0,COM.VT_UNKNOWN);
    if (result != COM.S_OK)     OLE.error(OLE.ERROR_CANNOT_CHANGE_VARIANT_TYPE,result);
    unknownVar=new Variant();
    unknownVar.setData(newPtr);
    return unknownVar.getUnknown();
  }
  finally {
    COM.VariantClear(oldPtr);
    OS.GlobalFree(oldPtr);
    COM.VariantClear(newPtr);
    OS.GlobalFree(newPtr);
    if (unknownVar != null)     unknownVar.dispose();
  }
}
