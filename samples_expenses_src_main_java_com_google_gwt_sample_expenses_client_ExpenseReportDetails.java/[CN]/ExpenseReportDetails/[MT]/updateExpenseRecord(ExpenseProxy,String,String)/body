{
  if (Approval.APPROVED.is(approval) && !Approval.APPROVED.is(record.getApproval())) {
    double amount=record.getAmount();
    if (amount + totalApproved > MAX_COST) {
      syncCommit(record,"The total approved amount for an expense report cannot exceed $" + MAX_COST + ".");
      return;
    }
  }
  ExpenseRequest editRequest=expensesRequestFactory.expenseRequest();
  ExpenseProxy editableRecord=editRequest.edit(record);
  editableRecord.setApproval(approval);
  editableRecord.setReasonDenied(reasonDenied);
  editRequest.persist().using(editableRecord).fire(new Receiver<Void>(){
    @Override public void onSuccess(    Void ignore){
    }
  }
);
}
