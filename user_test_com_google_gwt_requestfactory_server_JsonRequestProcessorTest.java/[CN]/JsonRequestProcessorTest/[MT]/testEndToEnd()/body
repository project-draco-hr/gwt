{
  com.google.gwt.valuestore.server.SimpleFoo.reset();
  try {
    JSONObject foo=(JSONObject)requestProcessor.processJsonRequest("{ \"" + JsonRequestDataUtil.OPERATION_TOKEN + "\": \""+ com.google.gwt.valuestore.shared.SimpleFooRequest.class.getName()+ ReflectionBasedOperationRegistry.SCOPE_SEPARATOR+ "findSimpleFooById\", "+ "\""+ JsonRequestDataUtil.PARAM_TOKEN+ "0\": \"999\" }");
    assertEquals(foo.getInt("id"),999);
    assertEquals(foo.getInt("intId"),42);
    assertEquals(foo.getString("userName"),"GWT");
    assertEquals(foo.getLong("longField"),8L);
    assertEquals(foo.getInt("enumField"),0);
    assertEquals(foo.getInt("version"),1);
    assertEquals(foo.getBoolean("boolField"),true);
    assertTrue(foo.has("created"));
    foo.put("intId",45);
    foo.put("userName","JSC");
    foo.put("longField","" + 9L);
    foo.put("enumField",SimpleEnum.BAR.ordinal());
    foo.put("boolField",false);
    Date now=new Date();
    foo.put("created","" + now.getTime());
    JSONObject recordWithSchema=new JSONObject();
    recordWithSchema.put(SimpleFooRecord.class.getName(),foo);
    JSONArray arr=new JSONArray();
    arr.put(recordWithSchema);
    JSONObject operation=new JSONObject();
    operation.put(WriteOperation.UPDATE.toString(),arr);
    JSONObject sync=new JSONObject();
    sync.put(JsonRequestDataUtil.OPERATION_TOKEN,RequestFactory.SYNC);
    sync.put(JsonRequestDataUtil.CONTENT_TOKEN,operation.toString());
    JSONObject result=(JSONObject)requestProcessor.processJsonRequest(sync.toString());
    SimpleFoo fooResult=SimpleFoo.getSingleton();
    assertFalse(result.getJSONArray("UPDATE").getJSONObject(0).has("violations"));
    assertEquals((int)45,(int)fooResult.getIntId());
    assertEquals("JSC",fooResult.getUserName());
    assertEquals(now,fooResult.getCreated());
    assertEquals(9L,(long)fooResult.getLongField());
    assertEquals(com.google.gwt.valuestore.shared.SimpleEnum.BAR,fooResult.getEnumField());
    assertEquals(false,(boolean)fooResult.getBoolField());
  }
 catch (  Exception e) {
    fail(e.toString());
  }
}
