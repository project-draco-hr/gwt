{
  if (list instanceof RandomAccess) {
    for (int i=list.size() - 1; i >= 1; i--) {
      swapImpl(list,i,rnd.nextInt(i + 1));
    }
  }
 else {
    Object arr[]=list.toArray();
    for (int i=arr.length - 1; i >= 1; i--) {
      swapImpl(arr,i,rnd.nextInt(i + 1));
    }
    ListIterator<T> it=list.listIterator();
    for (    Object e : arr) {
      it.next();
      it.set((T)e);
    }
  }
}
