{
  EntityManager em=entityManager();
  try {
    Query query=em.createQuery("select o from Task o where o.userId=:userId");
    query.setParameter("userId",UserServiceWrapper.get().getCurrentUserId());
    List<Task> list=query.getResultList();
    if (list.size() == 0) {
      populateDatastore();
      list=query.getResultList();
      list.size();
    }
    return list;
  }
  finally {
    em.close();
  }
}
