{
  if (person.getId() == null) {
    person.setId(Long.toString(++serial));
  }
  person.setVersion(person.getVersion() + 1);
  if (person.getClassSchedule() != null) {
    scheduleStore.persist(person.getClassSchedule());
  }
  Person existing=people.get(person.getId());
  if (existing != null) {
    existing.copyFrom(person);
  }
 else {
    people.put(person.getId(),person);
  }
}
