{
  StringBuilder sb=new StringBuilder();
  sb.append(type.name());
  sb.append(' ');
  if (type == Type.SENDER || type == Type.SUBJECT) {
    sb.append(search);
    sb.append(' ');
  }
  TreeMap<Message,Boolean> exceptions=new TreeMap<Message,Boolean>();
  getExceptions(exceptions);
  appendExceptions(sb,exceptions,true);
  appendExceptions(sb,exceptions,false);
  return sb.toString();
}
