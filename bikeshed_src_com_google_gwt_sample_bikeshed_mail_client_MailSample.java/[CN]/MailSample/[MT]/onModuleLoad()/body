{
  TextCell textCell=new TextCell();
  ListListModel<Message> listModel=new ListListModel<Message>();
  List<Message> messages=listModel.getList();
  Random rand=new Random();
  for (int i=0; i < 1000; i++) {
    Message message=new Message(10000 + i,senders[rand.nextInt(senders.length)],subjects[rand.nextInt(subjects.length)]);
    message.isRead=rand.nextBoolean();
    messages.add(message);
  }
  final MailSelectionModel selectionModel=new MailSelectionModel();
  final PagingTableListView<Message> table=new PagingTableListView<Message>(listModel,10);
  Column<Message,Boolean,Void> selectedColumn=new Column<Message,Boolean,Void>(new CheckboxCell()){
    @Override public Boolean getValue(    Message object){
      return selectionModel.isSelected(object);
    }
  }
;
  selectedColumn.setFieldUpdater(new FieldUpdater<Message,Boolean,Void>(){
    public void update(    int index,    Message object,    Boolean value,    Void viewData){
      selectionModel.setSelected(object,value);
    }
  }
);
  Header<String> selectedHeader=new Header<String>(textCell);
  selectedHeader.setValue("Selected");
  table.addColumn(selectedColumn,selectedHeader);
  Column<Message,String,Void> isReadColumn=new Column<Message,String,Void>(textCell){
    @Override public String getValue(    Message object){
      return object.isRead ? "read" : "unread";
    }
  }
;
  Header<String> isReadHeader=new Header<String>(textCell);
  isReadHeader.setValue("Read");
  table.addColumn(isReadColumn,isReadHeader);
  Column<Message,String,Void> senderColumn=new Column<Message,String,Void>(new TextCell()){
    @Override public String getValue(    Message object){
      return object.getSender();
    }
  }
;
  Header<String> senderHeader=new Header<String>(textCell);
  senderHeader.setValue("Sender");
  table.addColumn(senderColumn,senderHeader);
  Column<Message,String,Void> subjectColumn=new Column<Message,String,Void>(textCell){
    @Override public String getValue(    Message object){
      return object.getSubject();
    }
  }
;
  Header<String> subjectHeader=new Header<String>(textCell);
  subjectHeader.setValue("Subject");
  table.addColumn(subjectColumn,subjectHeader);
  table.setSelectionModel(selectionModel);
  Label searchLabel=new Label("Search Sender or Subject:");
  final TextBox searchBox=new TextBox();
  searchBox.addKeyUpHandler(new KeyUpHandler(){
    public void onKeyUp(    KeyUpEvent event){
      selectionModel.setSearch(searchBox.getText());
    }
  }
);
  Button noneButton=new Button("Select None");
  Button allOnPageButton=new Button("Select All On This Page");
  Button allButton=new Button("Select All");
  Button readButton=new Button("Select Read");
  Button unreadButton=new Button("Select Unread");
  Button senderButton=new Button("Search Senders");
  Button subjectButton=new Button("Search Subject");
  noneButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setType(MailSelectionModel.NONE);
    }
  }
);
  allOnPageButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setSelected(table.getDisplayedItems(),true);
    }
  }
);
  allButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setType(MailSelectionModel.ALL);
    }
  }
);
  readButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setType(MailSelectionModel.READ);
    }
  }
);
  unreadButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setType(MailSelectionModel.UNREAD);
    }
  }
);
  senderButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setType(MailSelectionModel.SENDER);
    }
  }
);
  subjectButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      selectionModel.setType(MailSelectionModel.SUBJECT);
    }
  }
);
  HorizontalPanel panel=new HorizontalPanel();
  panel.add(searchLabel);
  panel.add(searchBox);
  RootPanel.get().add(panel);
  RootPanel.get().add(new HTML("<br>"));
  RootPanel.get().add(table);
  RootPanel.get().add(new HTML("<br>"));
  RootPanel.get().add(noneButton);
  RootPanel.get().add(allOnPageButton);
  RootPanel.get().add(allButton);
  RootPanel.get().add(readButton);
  RootPanel.get().add(unreadButton);
  RootPanel.get().add(subjectButton);
  RootPanel.get().add(senderButton);
  RootPanel.get().add(selectionLabel);
}
