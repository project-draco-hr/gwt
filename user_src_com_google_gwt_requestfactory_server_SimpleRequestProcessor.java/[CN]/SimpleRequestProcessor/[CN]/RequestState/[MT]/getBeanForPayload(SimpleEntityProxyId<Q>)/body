{
  @SuppressWarnings("unchecked") AutoBean<Q> toReturn=(AutoBean<Q>)beans.get(id);
  if (toReturn == null) {
    toReturn=AutoBeanFactoryMagic.createBean(id.getProxyClass(),CONFIGURATION);
    toReturn.setTag(STABLE_ID,id);
    Class<?> domainClass=service.getDomainClass(id.getProxyClass());
    Object domain;
    if (id.isEphemeral()) {
      domain=service.createDomainObject(domainClass);
      domainObjectsToClientId.put(domain,id.getClientId());
    }
 else {
      domain=service.loadDomainObject(this,domainClass,fromBase64(id.getServerId()));
    }
    toReturn.setTag(DOMAIN_OBJECT,domain);
    beans.put(id,toReturn);
  }
  return toReturn;
}
