{
  Property existingProperty=moduleDef.getProperties().find(name.token);
  if (existingProperty == null) {
    existingProperty=moduleDef.getProperties().createConfiguration(name.token,false);
    if (!propertySettings.containsKey(name.token)) {
      propertySettings.put(name.token,moduleName);
    }
    Messages.UNDEFINED_CONFIGURATION_PROPERTY.log(logger,getLineNumber(),name.token,moduleName,null);
  }
 else   if (!(existingProperty instanceof ConfigurationProperty)) {
    if (existingProperty instanceof BindingProperty) {
      Messages.CONFIGURATION_PROPERTY_REDEFINES_BINDING_PROPERTY.log(logger,getLineNumber(),name.token,null);
    }
 else {
      Messages.CANNOT_REPLACE_PROPERTY.log(logger,getLineNumber(),name.token,existingProperty.getName(),existingProperty.getClass().getName(),null);
    }
    throw new UnableToCompleteException();
  }
  moduleDef.setConfigurationPropertyValue((ConfigurationProperty)existingProperty,value);
  return null;
}
