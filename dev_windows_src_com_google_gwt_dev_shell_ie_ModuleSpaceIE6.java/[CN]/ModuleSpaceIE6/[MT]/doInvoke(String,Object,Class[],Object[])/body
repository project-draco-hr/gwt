{
  OleAutomation funcObj=null;
  Variant funcObjVar=null;
  Variant[] vArgs=null;
  try {
    int len=args.length;
    vArgs=new Variant[len + 1];
    JsValueIE6 jsValue=new JsValueIE6();
    jsValue.setWrappedJavaObject(getIsolatedClassLoader(),jthis);
    vArgs[0]=jsValue.getVariant();
    for (int i=0; i < len; ++i) {
      vArgs[i + 1]=SwtOleGlue.convertObjectToVariant(getIsolatedClassLoader(),types[i],args[i]);
    }
    int[] ids=window.getIDsOfNames(new String[]{name});
    if (ids == null) {
      throw new RuntimeException("Could not find a native method with the signature '" + name + "'");
    }
    int functionId=ids[0];
    funcObjVar=window.getProperty(functionId);
    funcObj=funcObjVar.getAutomation();
    int callDispId=funcObj.getIDsOfNames(new String[]{"call"})[0];
    Variant result=funcObj.invoke(callDispId,vArgs);
    try {
      if (!isExceptionActive()) {
        return new JsValueIE6(result);
      }
    }
  finally {
      result.dispose();
    }
    RuntimeException thrown=takeJavaException();
    thrown.fillInStackTrace();
    throw thrown;
  }
  finally {
    for (int i=0; i < vArgs.length; ++i) {
      if (vArgs[i] != null) {
        vArgs[i].dispose();
      }
    }
    if (funcObjVar != null) {
      funcObjVar.dispose();
    }
    if (funcObj != null) {
      funcObj.dispose();
    }
  }
}
