{
  for (  JsScope child : scope.getChildren()) {
    visit(child);
  }
  for (  JsName name : scope.getAllNames()) {
    if (!referenced.contains(name)) {
      continue;
    }
    if (!name.isObfuscatable()) {
      name.setShortIdent(name.getIdent());
      continue;
    }
    String fullIdent=name.getIdent();
    fullIdent=fullIdent.replace("-","_");
    if (!isLegal(fullIdent)) {
      String checkIdent;
      for (int i=0; true; ++i) {
        checkIdent=fullIdent + "_" + i;
        if (isLegal(checkIdent)) {
          break;
        }
      }
      name.setShortIdent(checkIdent);
    }
 else {
      name.setShortIdent(fullIdent);
    }
  }
}
